{"version":3,"file":"main.js","sources":["../../node_modules/isexe/windows.js","../../node_modules/isexe/mode.js","../../node_modules/isexe/index.js","../../node_modules/fluent-ffmpeg/node_modules/which/which.js","../../node_modules/fluent-ffmpeg/lib/utils.js","../../node_modules/fluent-ffmpeg/lib/options/inputs.js","../../node_modules/fluent-ffmpeg/lib/options/audio.js","../../node_modules/fluent-ffmpeg/lib/options/video.js","../../node_modules/fluent-ffmpeg/lib/options/videosize.js","../../node_modules/fluent-ffmpeg/lib/options/output.js","../../node_modules/fluent-ffmpeg/lib/options/custom.js","../../node_modules/fluent-ffmpeg/lib/options/misc.js","../../node_modules/fluent-ffmpeg/node_modules/async/lib/async.js","../../node_modules/fluent-ffmpeg/lib/processor.js","../../node_modules/fluent-ffmpeg/lib/capabilities.js","../../node_modules/fluent-ffmpeg/lib/ffprobe.js","../../node_modules/fluent-ffmpeg/lib/recipes.js","../../node_modules/fluent-ffmpeg/lib/fluent-ffmpeg.js","../../node_modules/fluent-ffmpeg/index.js","../../src/main/cleanup.ts","../../node_modules/picomatch/lib/constants.js","../../node_modules/picomatch/lib/utils.js","../../node_modules/picomatch/lib/scan.js","../../node_modules/picomatch/lib/parse.js","../../node_modules/picomatch/lib/picomatch.js","../../node_modules/picomatch/index.js","../../node_modules/readdirp/index.js","../../node_modules/normalize-path/index.js","../../node_modules/anymatch/index.js","../../node_modules/is-extglob/index.js","../../node_modules/is-glob/index.js","../../node_modules/chokidar/node_modules/glob-parent/index.js","../../node_modules/braces/lib/utils.js","../../node_modules/braces/lib/stringify.js","../../node_modules/is-number/index.js","../../node_modules/to-regex-range/index.js","../../node_modules/fill-range/index.js","../../node_modules/braces/lib/compile.js","../../node_modules/braces/lib/expand.js","../../node_modules/braces/lib/constants.js","../../node_modules/braces/lib/parse.js","../../node_modules/braces/index.js","../../node_modules/binary-extensions/index.js","../../node_modules/is-binary-path/index.js","../../node_modules/chokidar/lib/constants.js","../../node_modules/chokidar/lib/nodefs-handler.js","../../node_modules/chokidar/lib/fsevents-handler.js","../../node_modules/chokidar/index.js","../../src/main/main.ts"],"sourcesContent":["module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction checkPathExt (path, options) {\n  var pathext = options.pathExt !== undefined ?\n    options.pathExt : process.env.PATHEXT\n\n  if (!pathext) {\n    return true\n  }\n\n  pathext = pathext.split(';')\n  if (pathext.indexOf('') !== -1) {\n    return true\n  }\n  for (var i = 0; i < pathext.length; i++) {\n    var p = pathext[i].toLowerCase()\n    if (p && path.substr(-p.length).toLowerCase() === p) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction checkStat (stat, path, options) {\n  if (!stat.isSymbolicLink() && !stat.isFile()) {\n    return false\n  }\n  return checkPathExt(path, options)\n}\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, path, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), path, options)\n}\n","module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), options)\n}\n\nfunction checkStat (stat, options) {\n  return stat.isFile() && checkMode(stat, options)\n}\n\nfunction checkMode (stat, options) {\n  var mod = stat.mode\n  var uid = stat.uid\n  var gid = stat.gid\n\n  var myUid = options.uid !== undefined ?\n    options.uid : process.getuid && process.getuid()\n  var myGid = options.gid !== undefined ?\n    options.gid : process.getgid && process.getgid()\n\n  var u = parseInt('100', 8)\n  var g = parseInt('010', 8)\n  var o = parseInt('001', 8)\n  var ug = u | g\n\n  var ret = (mod & o) ||\n    (mod & g) && gid === myGid ||\n    (mod & u) && uid === myUid ||\n    (mod & ug) && myUid === 0\n\n  return ret\n}\n","var fs = require('fs')\nvar core\nif (process.platform === 'win32' || global.TESTING_WINDOWS) {\n  core = require('./windows.js')\n} else {\n  core = require('./mode.js')\n}\n\nmodule.exports = isexe\nisexe.sync = sync\n\nfunction isexe (path, options, cb) {\n  if (typeof options === 'function') {\n    cb = options\n    options = {}\n  }\n\n  if (!cb) {\n    if (typeof Promise !== 'function') {\n      throw new TypeError('callback not provided')\n    }\n\n    return new Promise(function (resolve, reject) {\n      isexe(path, options || {}, function (er, is) {\n        if (er) {\n          reject(er)\n        } else {\n          resolve(is)\n        }\n      })\n    })\n  }\n\n  core(path, options || {}, function (er, is) {\n    // ignore EACCES because that just means we aren't allowed to run it\n    if (er) {\n      if (er.code === 'EACCES' || options && options.ignoreErrors) {\n        er = null\n        is = false\n      }\n    }\n    cb(er, is)\n  })\n}\n\nfunction sync (path, options) {\n  // my kingdom for a filtered catch\n  try {\n    return core.sync(path, options || {})\n  } catch (er) {\n    if (options && options.ignoreErrors || er.code === 'EACCES') {\n      return false\n    } else {\n      throw er\n    }\n  }\n}\n","module.exports = which\nwhich.sync = whichSync\n\nvar isWindows = process.platform === 'win32' ||\n    process.env.OSTYPE === 'cygwin' ||\n    process.env.OSTYPE === 'msys'\n\nvar path = require('path')\nvar COLON = isWindows ? ';' : ':'\nvar isexe = require('isexe')\n\nfunction getNotFoundError (cmd) {\n  var er = new Error('not found: ' + cmd)\n  er.code = 'ENOENT'\n\n  return er\n}\n\nfunction getPathInfo (cmd, opt) {\n  var colon = opt.colon || COLON\n  var pathEnv = opt.path || process.env.PATH || ''\n  var pathExt = ['']\n\n  pathEnv = pathEnv.split(colon)\n\n  var pathExtExe = ''\n  if (isWindows) {\n    pathEnv.unshift(process.cwd())\n    pathExtExe = (opt.pathExt || process.env.PATHEXT || '.EXE;.CMD;.BAT;.COM')\n    pathExt = pathExtExe.split(colon)\n\n\n    // Always test the cmd itself first.  isexe will check to make sure\n    // it's found in the pathExt set.\n    if (cmd.indexOf('.') !== -1 && pathExt[0] !== '')\n      pathExt.unshift('')\n  }\n\n  // If it has a slash, then we don't bother searching the pathenv.\n  // just check the file itself, and that's it.\n  if (cmd.match(/\\//) || isWindows && cmd.match(/\\\\/))\n    pathEnv = ['']\n\n  return {\n    env: pathEnv,\n    ext: pathExt,\n    extExe: pathExtExe\n  }\n}\n\nfunction which (cmd, opt, cb) {\n  if (typeof opt === 'function') {\n    cb = opt\n    opt = {}\n  }\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  ;(function F (i, l) {\n    if (i === l) {\n      if (opt.all && found.length)\n        return cb(null, found)\n      else\n        return cb(getNotFoundError(cmd))\n    }\n\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && (/^\\.[\\\\\\/]/).test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    ;(function E (ii, ll) {\n      if (ii === ll) return F(i + 1, l)\n      var ext = pathExt[ii]\n      isexe(p + ext, { pathExt: pathExtExe }, function (er, is) {\n        if (!er && is) {\n          if (opt.all)\n            found.push(p + ext)\n          else\n            return cb(null, p + ext)\n        }\n        return E(ii + 1, ll)\n      })\n    })(0, pathExt.length)\n  })(0, pathEnv.length)\n}\n\nfunction whichSync (cmd, opt) {\n  opt = opt || {}\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  for (var i = 0, l = pathEnv.length; i < l; i ++) {\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && /^\\.[\\\\\\/]/.test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    for (var j = 0, ll = pathExt.length; j < ll; j ++) {\n      var cur = p + pathExt[j]\n      var is\n      try {\n        is = isexe.sync(cur, { pathExt: pathExtExe })\n        if (is) {\n          if (opt.all)\n            found.push(cur)\n          else\n            return cur\n        }\n      } catch (ex) {}\n    }\n  }\n\n  if (opt.all && found.length)\n    return found\n\n  if (opt.nothrow)\n    return null\n\n  throw getNotFoundError(cmd)\n}\n","/*jshint node:true*/\n'use strict';\n\nvar exec = require('child_process').exec;\nvar isWindows = require('os').platform().match(/win(32|64)/);\nvar which = require('which');\n\nvar nlRegexp = /\\r\\n|\\r|\\n/g;\nvar streamRegexp = /^\\[?(.*?)\\]?$/;\nvar filterEscapeRegexp = /[,]/;\nvar whichCache = {};\n\n/**\n * Parse progress line from ffmpeg stderr\n *\n * @param {String} line progress line\n * @return progress object\n * @private\n */\nfunction parseProgressLine(line) {\n  var progress = {};\n\n  // Remove all spaces after = and trim\n  line  = line.replace(/=\\s+/g, '=').trim();\n  var progressParts = line.split(' ');\n\n  // Split every progress part by \"=\" to get key and value\n  for(var i = 0; i < progressParts.length; i++) {\n    var progressSplit = progressParts[i].split('=', 2);\n    var key = progressSplit[0];\n    var value = progressSplit[1];\n\n    // This is not a progress line\n    if(typeof value === 'undefined')\n      return null;\n\n    progress[key] = value;\n  }\n\n  return progress;\n}\n\n\nvar utils = module.exports = {\n  isWindows: isWindows,\n  streamRegexp: streamRegexp,\n\n\n  /**\n   * Copy an object keys into another one\n   *\n   * @param {Object} source source object\n   * @param {Object} dest destination object\n   * @private\n   */\n  copy: function(source, dest) {\n    Object.keys(source).forEach(function(key) {\n      dest[key] = source[key];\n    });\n  },\n\n\n  /**\n   * Create an argument list\n   *\n   * Returns a function that adds new arguments to the list.\n   * It also has the following methods:\n   * - clear() empties the argument list\n   * - get() returns the argument list\n   * - find(arg, count) finds 'arg' in the list and return the following 'count' items, or undefined if not found\n   * - remove(arg, count) remove 'arg' in the list as well as the following 'count' items\n   *\n   * @private\n   */\n  args: function() {\n    var list = [];\n\n    // Append argument(s) to the list\n    var argfunc = function() {\n      if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        list = list.concat(arguments[0]);\n      } else {\n        list = list.concat([].slice.call(arguments));\n      }\n    };\n\n    // Clear argument list\n    argfunc.clear = function() {\n      list = [];\n    };\n\n    // Return argument list\n    argfunc.get = function() {\n      return list;\n    };\n\n    // Find argument 'arg' in list, and if found, return an array of the 'count' items that follow it\n    argfunc.find = function(arg, count) {\n      var index = list.indexOf(arg);\n      if (index !== -1) {\n        return list.slice(index + 1, index + 1 + (count || 0));\n      }\n    };\n\n    // Find argument 'arg' in list, and if found, remove it as well as the 'count' items that follow it\n    argfunc.remove = function(arg, count) {\n      var index = list.indexOf(arg);\n      if (index !== -1) {\n        list.splice(index, (count || 0) + 1);\n      }\n    };\n\n    // Clone argument list\n    argfunc.clone = function() {\n      var cloned = utils.args();\n      cloned(list);\n      return cloned;\n    };\n\n    return argfunc;\n  },\n\n\n  /**\n   * Generate filter strings\n   *\n   * @param {String[]|Object[]} filters filter specifications. When using objects,\n   *   each must have the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|Array} [filters.inputs] (array of) input stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically choosing the first unused matching streams\n   * @param {String|Array} [filters.outputs] (array of) output stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically assigning the output to the output file\n   * @param {Object|String|Array} [filters.options] filter options, can be omitted to not set any options\n   * @return String[]\n   * @private\n   */\n  makeFilterStrings: function(filters) {\n    return filters.map(function(filterSpec) {\n      if (typeof filterSpec === 'string') {\n        return filterSpec;\n      }\n\n      var filterString = '';\n\n      // Filter string format is:\n      // [input1][input2]...filter[output1][output2]...\n      // The 'filter' part can optionaly have arguments:\n      //   filter=arg1:arg2:arg3\n      //   filter=arg1=v1:arg2=v2:arg3=v3\n\n      // Add inputs\n      if (Array.isArray(filterSpec.inputs)) {\n        filterString += filterSpec.inputs.map(function(streamSpec) {\n          return streamSpec.replace(streamRegexp, '[$1]');\n        }).join('');\n      } else if (typeof filterSpec.inputs === 'string') {\n        filterString += filterSpec.inputs.replace(streamRegexp, '[$1]');\n      }\n\n      // Add filter\n      filterString += filterSpec.filter;\n\n      // Add options\n      if (filterSpec.options) {\n        if (typeof filterSpec.options === 'string' || typeof filterSpec.options === 'number') {\n          // Option string\n          filterString += '=' + filterSpec.options;\n        } else if (Array.isArray(filterSpec.options)) {\n          // Option array (unnamed options)\n          filterString += '=' + filterSpec.options.map(function(option) {\n            if (typeof option === 'string' && option.match(filterEscapeRegexp)) {\n              return '\\'' + option + '\\'';\n            } else {\n              return option;\n            }\n          }).join(':');\n        } else if (Object.keys(filterSpec.options).length) {\n          // Option object (named options)\n          filterString += '=' + Object.keys(filterSpec.options).map(function(option) {\n            var value = filterSpec.options[option];\n\n            if (typeof value === 'string' && value.match(filterEscapeRegexp)) {\n              value = '\\'' + value + '\\'';\n            }\n\n            return option + '=' + value;\n          }).join(':');\n        }\n      }\n\n      // Add outputs\n      if (Array.isArray(filterSpec.outputs)) {\n        filterString += filterSpec.outputs.map(function(streamSpec) {\n          return streamSpec.replace(streamRegexp, '[$1]');\n        }).join('');\n      } else if (typeof filterSpec.outputs === 'string') {\n        filterString += filterSpec.outputs.replace(streamRegexp, '[$1]');\n      }\n\n      return filterString;\n    });\n  },\n\n\n  /**\n   * Search for an executable\n   *\n   * Uses 'which' or 'where' depending on platform\n   *\n   * @param {String} name executable name\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  which: function(name, callback) {\n    if (name in whichCache) {\n      return callback(null, whichCache[name]);\n    }\n\n    which(name, function(err, result){\n      if (err) {\n        // Treat errors as not found\n        return callback(null, whichCache[name] = '');\n      }\n      callback(null, whichCache[name] = result);\n    });\n  },\n\n\n  /**\n   * Convert a [[hh:]mm:]ss[.xxx] timemark into seconds\n   *\n   * @param {String} timemark timemark string\n   * @return Number\n   * @private\n   */\n  timemarkToSeconds: function(timemark) {\n    if (typeof timemark === 'number') {\n      return timemark;\n    }\n\n    if (timemark.indexOf(':') === -1 && timemark.indexOf('.') >= 0) {\n      return Number(timemark);\n    }\n\n    var parts = timemark.split(':');\n\n    // add seconds\n    var secs = Number(parts.pop());\n\n    if (parts.length) {\n      // add minutes\n      secs += Number(parts.pop()) * 60;\n    }\n\n    if (parts.length) {\n      // add hours\n      secs += Number(parts.pop()) * 3600;\n    }\n\n    return secs;\n  },\n\n\n  /**\n   * Extract codec data from ffmpeg stderr and emit 'codecData' event if appropriate\n   * Call it with an initially empty codec object once with each line of stderr output until it returns true\n   *\n   * @param {FfmpegCommand} command event emitter\n   * @param {String} stderrLine ffmpeg stderr output line\n   * @param {Object} codecObject object used to accumulate codec data between calls\n   * @return {Boolean} true if codec data is complete (and event was emitted), false otherwise\n   * @private\n   */\n  extractCodecData: function(command, stderrLine, codecsObject) {\n    var inputPattern = /Input #[0-9]+, ([^ ]+),/;\n    var durPattern = /Duration\\: ([^,]+)/;\n    var audioPattern = /Audio\\: (.*)/;\n    var videoPattern = /Video\\: (.*)/;\n\n    if (!('inputStack' in codecsObject)) {\n      codecsObject.inputStack = [];\n      codecsObject.inputIndex = -1;\n      codecsObject.inInput = false;\n    }\n\n    var inputStack = codecsObject.inputStack;\n    var inputIndex = codecsObject.inputIndex;\n    var inInput = codecsObject.inInput;\n\n    var format, dur, audio, video;\n\n    if (format = stderrLine.match(inputPattern)) {\n      inInput = codecsObject.inInput = true;\n      inputIndex = codecsObject.inputIndex = codecsObject.inputIndex + 1;\n\n      inputStack[inputIndex] = { format: format[1], audio: '', video: '', duration: '' };\n    } else if (inInput && (dur = stderrLine.match(durPattern))) {\n      inputStack[inputIndex].duration = dur[1];\n    } else if (inInput && (audio = stderrLine.match(audioPattern))) {\n      audio = audio[1].split(', ');\n      inputStack[inputIndex].audio = audio[0];\n      inputStack[inputIndex].audio_details = audio;\n    } else if (inInput && (video = stderrLine.match(videoPattern))) {\n      video = video[1].split(', ');\n      inputStack[inputIndex].video = video[0];\n      inputStack[inputIndex].video_details = video;\n    } else if (/Output #\\d+/.test(stderrLine)) {\n      inInput = codecsObject.inInput = false;\n    } else if (/Stream mapping:|Press (\\[q\\]|ctrl-c) to stop/.test(stderrLine)) {\n      command.emit.apply(command, ['codecData'].concat(inputStack));\n      return true;\n    }\n\n    return false;\n  },\n\n\n  /**\n   * Extract progress data from ffmpeg stderr and emit 'progress' event if appropriate\n   *\n   * @param {FfmpegCommand} command event emitter\n   * @param {String} stderrLine ffmpeg stderr data\n   * @private\n   */\n  extractProgress: function(command, stderrLine) {\n    var progress = parseProgressLine(stderrLine);\n\n    if (progress) {\n      // build progress report object\n      var ret = {\n        frames: parseInt(progress.frame, 10),\n        currentFps: parseInt(progress.fps, 10),\n        currentKbps: progress.bitrate ? parseFloat(progress.bitrate.replace('kbits/s', '')) : 0,\n        targetSize: parseInt(progress.size || progress.Lsize, 10),\n        timemark: progress.time\n      };\n\n      // calculate percent progress using duration\n      if (command._ffprobeData && command._ffprobeData.format && command._ffprobeData.format.duration) {\n        var duration = Number(command._ffprobeData.format.duration);\n        if (!isNaN(duration))\n          ret.percent = (utils.timemarkToSeconds(ret.timemark) / duration) * 100;\n      }\n      command.emit('progress', ret);\n    }\n  },\n\n\n  /**\n   * Extract error message(s) from ffmpeg stderr\n   *\n   * @param {String} stderr ffmpeg stderr data\n   * @return {String}\n   * @private\n   */\n  extractError: function(stderr) {\n    // Only return the last stderr lines that don't start with a space or a square bracket\n    return stderr.split(nlRegexp).reduce(function(messages, message) {\n      if (message.charAt(0) === ' ' || message.charAt(0) === '[') {\n        return [];\n      } else {\n        messages.push(message);\n        return messages;\n      }\n    }, []).join('\\n');\n  },\n\n\n  /**\n   * Creates a line ring buffer object with the following methods:\n   * - append(str) : appends a string or buffer\n   * - get() : returns the whole string\n   * - close() : prevents further append() calls and does a last call to callbacks\n   * - callback(cb) : calls cb for each line (incl. those already in the ring)\n   *\n   * @param {Number} maxLines maximum number of lines to store (<= 0 for unlimited)\n   */\n  linesRing: function(maxLines) {\n    var cbs = [];\n    var lines = [];\n    var current = null;\n    var closed = false\n    var max = maxLines - 1;\n\n    function emit(line) {\n      cbs.forEach(function(cb) { cb(line); });\n    }\n\n    return {\n      callback: function(cb) {\n        lines.forEach(function(l) { cb(l); });\n        cbs.push(cb);\n      },\n\n      append: function(str) {\n        if (closed) return;\n        if (str instanceof Buffer) str = '' + str;\n        if (!str || str.length === 0) return;\n\n        var newLines = str.split(nlRegexp);\n\n        if (newLines.length === 1) {\n          if (current !== null) {\n            current = current + newLines.shift();\n          } else {\n            current = newLines.shift();\n          }\n        } else {\n          if (current !== null) {\n            current = current + newLines.shift();\n            emit(current);\n            lines.push(current);\n          }\n\n          current = newLines.pop();\n\n          newLines.forEach(function(l) {\n            emit(l);\n            lines.push(l);\n          });\n\n          if (max > -1 && lines.length > max) {\n            lines.splice(0, lines.length - max);\n          }\n        }\n      },\n\n      get: function() {\n        if (current !== null) {\n          return lines.concat([current]).join('\\n');\n        } else {\n          return lines.join('\\n');\n        }\n      },\n\n      close: function() {\n        if (closed) return;\n\n        if (current !== null) {\n          emit(current);\n          lines.push(current);\n\n          if (max > -1 && lines.length > max) {\n            lines.shift();\n          }\n\n          current = null;\n        }\n\n        closed = true;\n      }\n    };\n  }\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n/*\n *! Input-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add an input to command\n   *\n   * Also switches \"current input\", that is the input that will be affected\n   * by subsequent input-related methods.\n   *\n   * Note: only one stream input is supported for now.\n   *\n   * @method FfmpegCommand#input\n   * @category Input\n   * @aliases mergeAdd,addInput\n   *\n   * @param {String|Readable} source input file path or readable stream\n   * @return FfmpegCommand\n   */\n  proto.mergeAdd =\n  proto.addInput =\n  proto.input = function(source) {\n    var isFile = false;\n    var isStream = false;\n\n    if (typeof source !== 'string') {\n      if (!('readable' in source) || !(source.readable)) {\n        throw new Error('Invalid input');\n      }\n\n      var hasInputStream = this._inputs.some(function(input) {\n        return input.isStream;\n      });\n\n      if (hasInputStream) {\n        throw new Error('Only one input stream is supported');\n      }\n\n      isStream = true;\n      source.pause();\n    } else {\n      var protocol = source.match(/^([a-z]{2,}):/i);\n      isFile = !protocol || protocol[0] === 'file';\n    }\n\n    this._inputs.push(this._currentInput = {\n      source: source,\n      isFile: isFile,\n      isStream: isStream,\n      options: utils.args()\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Specify input format for the last specified input\n   *\n   * @method FfmpegCommand#inputFormat\n   * @category Input\n   * @aliases withInputFormat,fromFormat\n   *\n   * @param {String} format input format\n   * @return FfmpegCommand\n   */\n  proto.withInputFormat =\n  proto.inputFormat =\n  proto.fromFormat = function(format) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-f', format);\n    return this;\n  };\n\n\n  /**\n   * Specify input FPS for the last specified input\n   * (only valid for raw video formats)\n   *\n   * @method FfmpegCommand#inputFps\n   * @category Input\n   * @aliases withInputFps,withInputFPS,withFpsInput,withFPSInput,inputFPS,inputFps,fpsInput\n   *\n   * @param {Number} fps input FPS\n   * @return FfmpegCommand\n   */\n  proto.withInputFps =\n  proto.withInputFPS =\n  proto.withFpsInput =\n  proto.withFPSInput =\n  proto.inputFPS =\n  proto.inputFps =\n  proto.fpsInput =\n  proto.FPSInput = function(fps) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-r', fps);\n    return this;\n  };\n\n\n  /**\n   * Use native framerate for the last specified input\n   *\n   * @method FfmpegCommand#native\n   * @category Input\n   * @aliases nativeFramerate,withNativeFramerate\n   *\n   * @return FfmmegCommand\n   */\n  proto.nativeFramerate =\n  proto.withNativeFramerate =\n  proto.native = function() {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-re');\n    return this;\n  };\n\n\n  /**\n   * Specify input seek time for the last specified input\n   *\n   * @method FfmpegCommand#seekInput\n   * @category Input\n   * @aliases setStartTime,seekTo\n   *\n   * @param {String|Number} seek seek time in seconds or as a '[hh:[mm:]]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.setStartTime =\n  proto.seekInput = function(seek) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-ss', seek);\n\n    return this;\n  };\n\n\n  /**\n   * Loop over the last specified input\n   *\n   * @method FfmpegCommand#loop\n   * @category Input\n   *\n   * @param {String|Number} [duration] loop duration in seconds or as a '[[hh:]mm:]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.loop = function(duration) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-loop', '1');\n\n    if (typeof duration !== 'undefined') {\n      this.duration(duration);\n    }\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Audio-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Disable audio in the output\n   *\n   * @method FfmpegCommand#noAudio\n   * @category Audio\n   * @aliases withNoAudio\n   * @return FfmpegCommand\n   */\n  proto.withNoAudio =\n  proto.noAudio = function() {\n    this._currentOutput.audio.clear();\n    this._currentOutput.audioFilters.clear();\n    this._currentOutput.audio('-an');\n\n    return this;\n  };\n\n\n  /**\n   * Specify audio codec\n   *\n   * @method FfmpegCommand#audioCodec\n   * @category Audio\n   * @aliases withAudioCodec\n   *\n   * @param {String} codec audio codec name\n   * @return FfmpegCommand\n   */\n  proto.withAudioCodec =\n  proto.audioCodec = function(codec) {\n    this._currentOutput.audio('-acodec', codec);\n\n    return this;\n  };\n\n\n  /**\n   * Specify audio bitrate\n   *\n   * @method FfmpegCommand#audioBitrate\n   * @category Audio\n   * @aliases withAudioBitrate\n   *\n   * @param {String|Number} bitrate audio bitrate in kbps (with an optional 'k' suffix)\n   * @return FfmpegCommand\n   */\n  proto.withAudioBitrate =\n  proto.audioBitrate = function(bitrate) {\n    this._currentOutput.audio('-b:a', ('' + bitrate).replace(/k?$/, 'k'));\n    return this;\n  };\n\n\n  /**\n   * Specify audio channel count\n   *\n   * @method FfmpegCommand#audioChannels\n   * @category Audio\n   * @aliases withAudioChannels\n   *\n   * @param {Number} channels channel count\n   * @return FfmpegCommand\n   */\n  proto.withAudioChannels =\n  proto.audioChannels = function(channels) {\n    this._currentOutput.audio('-ac', channels);\n    return this;\n  };\n\n\n  /**\n   * Specify audio frequency\n   *\n   * @method FfmpegCommand#audioFrequency\n   * @category Audio\n   * @aliases withAudioFrequency\n   *\n   * @param {Number} freq audio frequency in Hz\n   * @return FfmpegCommand\n   */\n  proto.withAudioFrequency =\n  proto.audioFrequency = function(freq) {\n    this._currentOutput.audio('-ar', freq);\n    return this;\n  };\n\n\n  /**\n   * Specify audio quality\n   *\n   * @method FfmpegCommand#audioQuality\n   * @category Audio\n   * @aliases withAudioQuality\n   *\n   * @param {Number} quality audio quality factor\n   * @return FfmpegCommand\n   */\n  proto.withAudioQuality =\n  proto.audioQuality = function(quality) {\n    this._currentOutput.audio('-aq', quality);\n    return this;\n  };\n\n\n  /**\n   * Specify custom audio filter(s)\n   *\n   * Can be called both with one or many filters, or a filter array.\n   *\n   * @example\n   * command.audioFilters('filter1');\n   *\n   * @example\n   * command.audioFilters('filter1', 'filter2=param1=value1:param2=value2');\n   *\n   * @example\n   * command.audioFilters(['filter1', 'filter2']);\n   *\n   * @example\n   * command.audioFilters([\n   *   {\n   *     filter: 'filter1'\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: 'param=value:param=value'\n   *   }\n   * ]);\n   *\n   * @example\n   * command.audioFilters(\n   *   {\n   *     filter: 'filter1',\n   *     options: ['value1', 'value2']\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: { param1: 'value1', param2: 'value2' }\n   *   }\n   * );\n   *\n   * @method FfmpegCommand#audioFilters\n   * @aliases withAudioFilter,withAudioFilters,audioFilter\n   * @category Audio\n   *\n   * @param {...String|String[]|Object[]} filters audio filter strings, string array or\n   *   filter specification array, each with the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|String[]|Object} [filters.options] filter option string, array, or object\n   * @return FfmpegCommand\n   */\n  proto.withAudioFilter =\n  proto.withAudioFilters =\n  proto.audioFilter =\n  proto.audioFilters = function(filters) {\n    if (arguments.length > 1) {\n      filters = [].slice.call(arguments);\n    }\n\n    if (!Array.isArray(filters)) {\n      filters = [filters];\n    }\n\n    this._currentOutput.audioFilters(utils.makeFilterStrings(filters));\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Video-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Disable video in the output\n   *\n   * @method FfmpegCommand#noVideo\n   * @category Video\n   * @aliases withNoVideo\n   *\n   * @return FfmpegCommand\n   */\n  proto.withNoVideo =\n  proto.noVideo = function() {\n    this._currentOutput.video.clear();\n    this._currentOutput.videoFilters.clear();\n    this._currentOutput.video('-vn');\n\n    return this;\n  };\n\n\n  /**\n   * Specify video codec\n   *\n   * @method FfmpegCommand#videoCodec\n   * @category Video\n   * @aliases withVideoCodec\n   *\n   * @param {String} codec video codec name\n   * @return FfmpegCommand\n   */\n  proto.withVideoCodec =\n  proto.videoCodec = function(codec) {\n    this._currentOutput.video('-vcodec', codec);\n    return this;\n  };\n\n\n  /**\n   * Specify video bitrate\n   *\n   * @method FfmpegCommand#videoBitrate\n   * @category Video\n   * @aliases withVideoBitrate\n   *\n   * @param {String|Number} bitrate video bitrate in kbps (with an optional 'k' suffix)\n   * @param {Boolean} [constant=false] enforce constant bitrate\n   * @return FfmpegCommand\n   */\n  proto.withVideoBitrate =\n  proto.videoBitrate = function(bitrate, constant) {\n    bitrate = ('' + bitrate).replace(/k?$/, 'k');\n\n    this._currentOutput.video('-b:v', bitrate);\n    if (constant) {\n      this._currentOutput.video(\n        '-maxrate', bitrate,\n        '-minrate', bitrate,\n        '-bufsize', '3M'\n      );\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Specify custom video filter(s)\n   *\n   * Can be called both with one or many filters, or a filter array.\n   *\n   * @example\n   * command.videoFilters('filter1');\n   *\n   * @example\n   * command.videoFilters('filter1', 'filter2=param1=value1:param2=value2');\n   *\n   * @example\n   * command.videoFilters(['filter1', 'filter2']);\n   *\n   * @example\n   * command.videoFilters([\n   *   {\n   *     filter: 'filter1'\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: 'param=value:param=value'\n   *   }\n   * ]);\n   *\n   * @example\n   * command.videoFilters(\n   *   {\n   *     filter: 'filter1',\n   *     options: ['value1', 'value2']\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: { param1: 'value1', param2: 'value2' }\n   *   }\n   * );\n   *\n   * @method FfmpegCommand#videoFilters\n   * @category Video\n   * @aliases withVideoFilter,withVideoFilters,videoFilter\n   *\n   * @param {...String|String[]|Object[]} filters video filter strings, string array or\n   *   filter specification array, each with the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|String[]|Object} [filters.options] filter option string, array, or object\n   * @return FfmpegCommand\n   */\n  proto.withVideoFilter =\n  proto.withVideoFilters =\n  proto.videoFilter =\n  proto.videoFilters = function(filters) {\n    if (arguments.length > 1) {\n      filters = [].slice.call(arguments);\n    }\n\n    if (!Array.isArray(filters)) {\n      filters = [filters];\n    }\n\n    this._currentOutput.videoFilters(utils.makeFilterStrings(filters));\n\n    return this;\n  };\n\n\n  /**\n   * Specify output FPS\n   *\n   * @method FfmpegCommand#fps\n   * @category Video\n   * @aliases withOutputFps,withOutputFPS,withFpsOutput,withFPSOutput,withFps,withFPS,outputFPS,outputFps,fpsOutput,FPSOutput,FPS\n   *\n   * @param {Number} fps output FPS\n   * @return FfmpegCommand\n   */\n  proto.withOutputFps =\n  proto.withOutputFPS =\n  proto.withFpsOutput =\n  proto.withFPSOutput =\n  proto.withFps =\n  proto.withFPS =\n  proto.outputFPS =\n  proto.outputFps =\n  proto.fpsOutput =\n  proto.FPSOutput =\n  proto.fps =\n  proto.FPS = function(fps) {\n    this._currentOutput.video('-r', fps);\n    return this;\n  };\n\n\n  /**\n   * Only transcode a certain number of frames\n   *\n   * @method FfmpegCommand#frames\n   * @category Video\n   * @aliases takeFrames,withFrames\n   *\n   * @param {Number} frames frame count\n   * @return FfmpegCommand\n   */\n  proto.takeFrames =\n  proto.withFrames =\n  proto.frames = function(frames) {\n    this._currentOutput.video('-vframes', frames);\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\n/*\n *! Size helpers\n */\n\n\n/**\n * Return filters to pad video to width*height,\n *\n * @param {Number} width output width\n * @param {Number} height output height\n * @param {Number} aspect video aspect ratio (without padding)\n * @param {Number} color padding color\n * @return scale/pad filters\n * @private\n */\nfunction getScalePadFilters(width, height, aspect, color) {\n  /*\n    let a be the input aspect ratio, A be the requested aspect ratio\n\n    if a > A, padding is done on top and bottom\n    if a < A, padding is done on left and right\n   */\n\n  return [\n    /*\n      In both cases, we first have to scale the input to match the requested size.\n      When using computed width/height, we truncate them to multiples of 2\n     */\n    {\n      filter: 'scale',\n      options: {\n        w: 'if(gt(a,' + aspect + '),' + width + ',trunc(' + height + '*a/2)*2)',\n        h: 'if(lt(a,' + aspect + '),' + height + ',trunc(' + width + '/a/2)*2)'\n      }\n    },\n\n    /*\n      Then we pad the scaled input to match the target size\n      (here iw and ih refer to the padding input, i.e the scaled output)\n     */\n\n    {\n      filter: 'pad',\n      options: {\n        w: width,\n        h: height,\n        x: 'if(gt(a,' + aspect + '),0,(' + width + '-iw)/2)',\n        y: 'if(lt(a,' + aspect + '),0,(' + height + '-ih)/2)',\n        color: color\n      }\n    }\n  ];\n}\n\n\n/**\n * Recompute size filters\n *\n * @param {Object} output\n * @param {String} key newly-added parameter name ('size', 'aspect' or 'pad')\n * @param {String} value newly-added parameter value\n * @return filter string array\n * @private\n */\nfunction createSizeFilters(output, key, value) {\n  // Store parameters\n  var data = output.sizeData = output.sizeData || {};\n  data[key] = value;\n\n  if (!('size' in data)) {\n    // No size requested, keep original size\n    return [];\n  }\n\n  // Try to match the different size string formats\n  var fixedSize = data.size.match(/([0-9]+)x([0-9]+)/);\n  var fixedWidth = data.size.match(/([0-9]+)x\\?/);\n  var fixedHeight = data.size.match(/\\?x([0-9]+)/);\n  var percentRatio = data.size.match(/\\b([0-9]{1,3})%/);\n  var width, height, aspect;\n\n  if (percentRatio) {\n    var ratio = Number(percentRatio[1]) / 100;\n    return [{\n      filter: 'scale',\n      options: {\n        w: 'trunc(iw*' + ratio + '/2)*2',\n        h: 'trunc(ih*' + ratio + '/2)*2'\n      }\n    }];\n  } else if (fixedSize) {\n    // Round target size to multiples of 2\n    width = Math.round(Number(fixedSize[1]) / 2) * 2;\n    height = Math.round(Number(fixedSize[2]) / 2) * 2;\n\n    aspect = width / height;\n\n    if (data.pad) {\n      return getScalePadFilters(width, height, aspect, data.pad);\n    } else {\n      // No autopad requested, rescale to target size\n      return [{ filter: 'scale', options: { w: width, h: height }}];\n    }\n  } else if (fixedWidth || fixedHeight) {\n    if ('aspect' in data) {\n      // Specified aspect ratio\n      width = fixedWidth ? fixedWidth[1] : Math.round(Number(fixedHeight[1]) * data.aspect);\n      height = fixedHeight ? fixedHeight[1] : Math.round(Number(fixedWidth[1]) / data.aspect);\n\n      // Round to multiples of 2\n      width = Math.round(width / 2) * 2;\n      height = Math.round(height / 2) * 2;\n\n      if (data.pad) {\n        return getScalePadFilters(width, height, data.aspect, data.pad);\n      } else {\n        // No autopad requested, rescale to target size\n        return [{ filter: 'scale', options: { w: width, h: height }}];\n      }\n    } else {\n      // Keep input aspect ratio\n\n      if (fixedWidth) {\n        return [{\n          filter: 'scale',\n          options: {\n            w: Math.round(Number(fixedWidth[1]) / 2) * 2,\n            h: 'trunc(ow/a/2)*2'\n          }\n        }];\n      } else {\n        return [{\n          filter: 'scale',\n          options: {\n            w: 'trunc(oh*a/2)*2',\n            h: Math.round(Number(fixedHeight[1]) / 2) * 2\n          }\n        }];\n      }\n    }\n  } else {\n    throw new Error('Invalid size specified: ' + data.size);\n  }\n}\n\n\n/*\n *! Video size-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Keep display aspect ratio\n   *\n   * This method is useful when converting an input with non-square pixels to an output format\n   * that does not support non-square pixels.  It rescales the input so that the display aspect\n   * ratio is the same.\n   *\n   * @method FfmpegCommand#keepDAR\n   * @category Video size\n   * @aliases keepPixelAspect,keepDisplayAspect,keepDisplayAspectRatio\n   *\n   * @return FfmpegCommand\n   */\n  proto.keepPixelAspect = // Only for compatibility, this is not about keeping _pixel_ aspect ratio\n  proto.keepDisplayAspect =\n  proto.keepDisplayAspectRatio =\n  proto.keepDAR = function() {\n    return this.videoFilters([\n      {\n        filter: 'scale',\n        options: {\n          w: 'if(gt(sar,1),iw*sar,iw)',\n          h: 'if(lt(sar,1),ih/sar,ih)'\n        }\n      },\n      {\n        filter: 'setsar',\n        options: '1'\n      }\n    ]);\n  };\n\n\n  /**\n   * Set output size\n   *\n   * The 'size' parameter can have one of 4 forms:\n   * - 'X%': rescale to xx % of the original size\n   * - 'WxH': specify width and height\n   * - 'Wx?': specify width and compute height from input aspect ratio\n   * - '?xH': specify height and compute width from input aspect ratio\n   *\n   * Note: both dimensions will be truncated to multiples of 2.\n   *\n   * @method FfmpegCommand#size\n   * @category Video size\n   * @aliases withSize,setSize\n   *\n   * @param {String} size size string, eg. '33%', '320x240', '320x?', '?x240'\n   * @return FfmpegCommand\n   */\n  proto.withSize =\n  proto.setSize =\n  proto.size = function(size) {\n    var filters = createSizeFilters(this._currentOutput, 'size', size);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n\n\n  /**\n   * Set output aspect ratio\n   *\n   * @method FfmpegCommand#aspect\n   * @category Video size\n   * @aliases withAspect,withAspectRatio,setAspect,setAspectRatio,aspectRatio\n   *\n   * @param {String|Number} aspect aspect ratio (number or 'X:Y' string)\n   * @return FfmpegCommand\n   */\n  proto.withAspect =\n  proto.withAspectRatio =\n  proto.setAspect =\n  proto.setAspectRatio =\n  proto.aspect =\n  proto.aspectRatio = function(aspect) {\n    var a = Number(aspect);\n    if (isNaN(a)) {\n      var match = aspect.match(/^(\\d+):(\\d+)$/);\n      if (match) {\n        a = Number(match[1]) / Number(match[2]);\n      } else {\n        throw new Error('Invalid aspect ratio: ' + aspect);\n      }\n    }\n\n    var filters = createSizeFilters(this._currentOutput, 'aspect', a);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n\n\n  /**\n   * Enable auto-padding the output\n   *\n   * @method FfmpegCommand#autopad\n   * @category Video size\n   * @aliases applyAutopadding,applyAutoPadding,applyAutopad,applyAutoPad,withAutopadding,withAutoPadding,withAutopad,withAutoPad,autoPad\n   *\n   * @param {Boolean} [pad=true] enable/disable auto-padding\n   * @param {String} [color='black'] pad color\n   */\n  proto.applyAutopadding =\n  proto.applyAutoPadding =\n  proto.applyAutopad =\n  proto.applyAutoPad =\n  proto.withAutopadding =\n  proto.withAutoPadding =\n  proto.withAutopad =\n  proto.withAutoPad =\n  proto.autoPad =\n  proto.autopad = function(pad, color) {\n    // Allow autopad(color)\n    if (typeof pad === 'string') {\n      color = pad;\n      pad = true;\n    }\n\n    // Allow autopad() and autopad(undefined, color)\n    if (typeof pad === 'undefined') {\n      pad = true;\n    }\n\n    var filters = createSizeFilters(this._currentOutput, 'pad', pad ? color || 'black' : false);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Output-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add output\n   *\n   * @method FfmpegCommand#output\n   * @category Output\n   * @aliases addOutput\n   *\n   * @param {String|Writable} target target file path or writable stream\n   * @param {Object} [pipeopts={}] pipe options (only applies to streams)\n   * @return FfmpegCommand\n   */\n  proto.addOutput =\n  proto.output = function(target, pipeopts) {\n    var isFile = false;\n\n    if (!target && this._currentOutput) {\n      // No target is only allowed when called from constructor\n      throw new Error('Invalid output');\n    }\n\n    if (target && typeof target !== 'string') {\n      if (!('writable' in target) || !(target.writable)) {\n        throw new Error('Invalid output');\n      }\n    } else if (typeof target === 'string') {\n      var protocol = target.match(/^([a-z]{2,}):/i);\n      isFile = !protocol || protocol[0] === 'file';\n    }\n\n    if (target && !('target' in this._currentOutput)) {\n      // For backwards compatibility, set target for first output\n      this._currentOutput.target = target;\n      this._currentOutput.isFile = isFile;\n      this._currentOutput.pipeopts = pipeopts || {};\n    } else {\n      if (target && typeof target !== 'string') {\n        var hasOutputStream = this._outputs.some(function(output) {\n          return typeof output.target !== 'string';\n        });\n\n        if (hasOutputStream) {\n          throw new Error('Only one output stream is supported');\n        }\n      }\n\n      this._outputs.push(this._currentOutput = {\n        target: target,\n        isFile: isFile,\n        flags: {},\n        pipeopts: pipeopts || {}\n      });\n\n      var self = this;\n      ['audio', 'audioFilters', 'video', 'videoFilters', 'sizeFilters', 'options'].forEach(function(key) {\n        self._currentOutput[key] = utils.args();\n      });\n\n      if (!target) {\n        // Call from constructor: remove target key\n        delete this._currentOutput.target;\n      }\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Specify output seek time\n   *\n   * @method FfmpegCommand#seek\n   * @category Input\n   * @aliases seekOutput\n   *\n   * @param {String|Number} seek seek time in seconds or as a '[hh:[mm:]]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.seekOutput =\n  proto.seek = function(seek) {\n    this._currentOutput.options('-ss', seek);\n    return this;\n  };\n\n\n  /**\n   * Set output duration\n   *\n   * @method FfmpegCommand#duration\n   * @category Output\n   * @aliases withDuration,setDuration\n   *\n   * @param {String|Number} duration duration in seconds or as a '[[hh:]mm:]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.withDuration =\n  proto.setDuration =\n  proto.duration = function(duration) {\n    this._currentOutput.options('-t', duration);\n    return this;\n  };\n\n\n  /**\n   * Set output format\n   *\n   * @method FfmpegCommand#format\n   * @category Output\n   * @aliases toFormat,withOutputFormat,outputFormat\n   *\n   * @param {String} format output format name\n   * @return FfmpegCommand\n   */\n  proto.toFormat =\n  proto.withOutputFormat =\n  proto.outputFormat =\n  proto.format = function(format) {\n    this._currentOutput.options('-f', format);\n    return this;\n  };\n\n\n  /**\n   * Add stream mapping to output\n   *\n   * @method FfmpegCommand#map\n   * @category Output\n   *\n   * @param {String} spec stream specification string, with optional square brackets\n   * @return FfmpegCommand\n   */\n  proto.map = function(spec) {\n    this._currentOutput.options('-map', spec.replace(utils.streamRegexp, '[$1]'));\n    return this;\n  };\n\n\n  /**\n   * Run flvtool2/flvmeta on output\n   *\n   * @method FfmpegCommand#flvmeta\n   * @category Output\n   * @aliases updateFlvMetadata\n   *\n   * @return FfmpegCommand\n   */\n  proto.updateFlvMetadata =\n  proto.flvmeta = function() {\n    this._currentOutput.flags.flvmeta = true;\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Custom options methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add custom input option(s)\n   *\n   * When passing a single string or an array, each string containing two\n   * words is split (eg. inputOptions('-option value') is supported) for\n   * compatibility reasons.  This is not the case when passing more than\n   * one argument.\n   *\n   * @example\n   * command.inputOptions('option1');\n   *\n   * @example\n   * command.inputOptions('option1', 'option2');\n   *\n   * @example\n   * command.inputOptions(['option1', 'option2']);\n   *\n   * @method FfmpegCommand#inputOptions\n   * @category Custom options\n   * @aliases addInputOption,addInputOptions,withInputOption,withInputOptions,inputOption\n   *\n   * @param {...String} options option string(s) or string array\n   * @return FfmpegCommand\n   */\n  proto.addInputOption =\n  proto.addInputOptions =\n  proto.withInputOption =\n  proto.withInputOptions =\n  proto.inputOption =\n  proto.inputOptions = function(options) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    var doSplit = true;\n\n    if (arguments.length > 1) {\n      options = [].slice.call(arguments);\n      doSplit = false;\n    }\n\n    if (!Array.isArray(options)) {\n      options = [options];\n    }\n\n    this._currentInput.options(options.reduce(function(options, option) {\n      var split = String(option).split(' ');\n\n      if (doSplit && split.length === 2) {\n        options.push(split[0], split[1]);\n      } else {\n        options.push(option);\n      }\n\n      return options;\n    }, []));\n    return this;\n  };\n\n\n  /**\n   * Add custom output option(s)\n   *\n   * @example\n   * command.outputOptions('option1');\n   *\n   * @example\n   * command.outputOptions('option1', 'option2');\n   *\n   * @example\n   * command.outputOptions(['option1', 'option2']);\n   *\n   * @method FfmpegCommand#outputOptions\n   * @category Custom options\n   * @aliases addOutputOption,addOutputOptions,addOption,addOptions,withOutputOption,withOutputOptions,withOption,withOptions,outputOption\n   *\n   * @param {...String} options option string(s) or string array\n   * @return FfmpegCommand\n   */\n  proto.addOutputOption =\n  proto.addOutputOptions =\n  proto.addOption =\n  proto.addOptions =\n  proto.withOutputOption =\n  proto.withOutputOptions =\n  proto.withOption =\n  proto.withOptions =\n  proto.outputOption =\n  proto.outputOptions = function(options) {\n    var doSplit = true;\n\n    if (arguments.length > 1) {\n      options = [].slice.call(arguments);\n      doSplit = false;\n    }\n\n    if (!Array.isArray(options)) {\n      options = [options];\n    }\n\n    this._currentOutput.options(options.reduce(function(options, option) {\n      var split = String(option).split(' ');\n\n      if (doSplit && split.length === 2) {\n        options.push(split[0], split[1]);\n      } else {\n        options.push(option);\n      }\n\n      return options;\n    }, []));\n    return this;\n  };\n\n\n  /**\n   * Specify a complex filtergraph\n   *\n   * Calling this method will override any previously set filtergraph, but you can set\n   * as many filters as needed in one call.\n   *\n   * @example <caption>Overlay an image over a video (using a filtergraph string)</caption>\n   *   ffmpeg()\n   *     .input('video.avi')\n   *     .input('image.png')\n   *     .complexFilter('[0:v][1:v]overlay[out]', ['out']);\n   *\n   * @example <caption>Overlay an image over a video (using a filter array)</caption>\n   *   ffmpeg()\n   *     .input('video.avi')\n   *     .input('image.png')\n   *     .complexFilter([{\n   *       filter: 'overlay',\n   *       inputs: ['0:v', '1:v'],\n   *       outputs: ['out']\n   *     }], ['out']);\n   *\n   * @example <caption>Split video into RGB channels and output a 3x1 video with channels side to side</caption>\n   *  ffmpeg()\n   *    .input('video.avi')\n   *    .complexFilter([\n   *      // Duplicate video stream 3 times into streams a, b, and c\n   *      { filter: 'split', options: '3', outputs: ['a', 'b', 'c'] },\n   *\n   *      // Create stream 'red' by cancelling green and blue channels from stream 'a'\n   *      { filter: 'lutrgb', options: { g: 0, b: 0 }, inputs: 'a', outputs: 'red' },\n   *\n   *      // Create stream 'green' by cancelling red and blue channels from stream 'b'\n   *      { filter: 'lutrgb', options: { r: 0, b: 0 }, inputs: 'b', outputs: 'green' },\n   *\n   *      // Create stream 'blue' by cancelling red and green channels from stream 'c'\n   *      { filter: 'lutrgb', options: { r: 0, g: 0 }, inputs: 'c', outputs: 'blue' },\n   *\n   *      // Pad stream 'red' to 3x width, keeping the video on the left, and name output 'padded'\n   *      { filter: 'pad', options: { w: 'iw*3', h: 'ih' }, inputs: 'red', outputs: 'padded' },\n   *\n   *      // Overlay 'green' onto 'padded', moving it to the center, and name output 'redgreen'\n   *      { filter: 'overlay', options: { x: 'w', y: 0 }, inputs: ['padded', 'green'], outputs: 'redgreen'},\n   *\n   *      // Overlay 'blue' onto 'redgreen', moving it to the right\n   *      { filter: 'overlay', options: { x: '2*w', y: 0 }, inputs: ['redgreen', 'blue']},\n   *    ]);\n   *\n   * @method FfmpegCommand#complexFilter\n   * @category Custom options\n   * @aliases filterGraph\n   *\n   * @param {String|Array} spec filtergraph string or array of filter specification\n   *   objects, each having the following properties:\n   * @param {String} spec.filter filter name\n   * @param {String|Array} [spec.inputs] (array of) input stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically choosing the first unused matching streams\n   * @param {String|Array} [spec.outputs] (array of) output stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically assigning the output to the output file\n   * @param {Object|String|Array} [spec.options] filter options, can be omitted to not set any options\n   * @param {Array} [map] (array of) stream specifier(s) from the graph to include in\n   *   ffmpeg output, defaults to ffmpeg automatically choosing the first matching streams.\n   * @return FfmpegCommand\n   */\n  proto.filterGraph =\n  proto.complexFilter = function(spec, map) {\n    this._complexFilters.clear();\n\n    if (!Array.isArray(spec)) {\n      spec = [spec];\n    }\n\n    this._complexFilters('-filter_complex', utils.makeFilterStrings(spec).join(';'));\n\n    if (Array.isArray(map)) {\n      var self = this;\n      map.forEach(function(streamSpec) {\n        self._complexFilters('-map', streamSpec.replace(utils.streamRegexp, '[$1]'));\n      });\n    } else if (typeof map === 'string') {\n      this._complexFilters('-map', map.replace(utils.streamRegexp, '[$1]'));\n    }\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar path = require('path');\n\n/*\n *! Miscellaneous methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Use preset\n   *\n   * @method FfmpegCommand#preset\n   * @category Miscellaneous\n   * @aliases usingPreset\n   *\n   * @param {String|Function} preset preset name or preset function\n   */\n  proto.usingPreset =\n  proto.preset = function(preset) {\n    if (typeof preset === 'function') {\n      preset(this);\n    } else {\n      try {\n        var modulePath = path.join(this.options.presets, preset);\n        var module = require(modulePath);\n\n        if (typeof module.load === 'function') {\n          module.load(this);\n        } else {\n          throw new Error('preset ' + modulePath + ' has no load() function');\n        }\n      } catch (err) {\n        throw new Error('preset ' + modulePath + ' could not be loaded: ' + err.message);\n      }\n    }\n\n    return this;\n  };\n};\n","/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                }\n            }));\n        });\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (err, v) {\n                results[x.index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        if (!keys.length) {\n            return callback(null);\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (_keys(results).length === keys.length) {\n                callback(null, results);\n                callback = function () {};\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = (tasks[k] instanceof Function) ? [tasks[k]]: tasks[k];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor !== Array) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (test()) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (!test()) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if(data.constructor !== Array) {\n              data = [data];\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            }\n        };\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n                if(data.constructor !== Array) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain) cargo.drain();\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                callback.apply(null, memo[key]);\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.compose = function (/* functions... */) {\n        var fns = Array.prototype.reverse.call(arguments);\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // AMD / RequireJS\n    if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // Node.js\n    else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","/*jshint node:true*/\n'use strict';\n\nvar spawn = require('child_process').spawn;\nvar path = require('path');\nvar fs = require('fs');\nvar async = require('async');\nvar utils = require('./utils');\n\n/*\n *! Processor methods\n */\n\n\n/**\n * Run ffprobe asynchronously and store data in command\n *\n * @param {FfmpegCommand} command\n * @private\n */\nfunction runFfprobe(command) {\n  const inputProbeIndex = 0;\n  if (command._inputs[inputProbeIndex].isStream) {\n    // Don't probe input streams as this will consume them\n    return;\n  }\n  command.ffprobe(inputProbeIndex, function(err, data) {\n    command._ffprobeData = data;\n  });\n}\n\n\nmodule.exports = function(proto) {\n  /**\n   * Emitted just after ffmpeg has been spawned.\n   *\n   * @event FfmpegCommand#start\n   * @param {String} command ffmpeg command line\n   */\n\n  /**\n   * Emitted when ffmpeg reports progress information\n   *\n   * @event FfmpegCommand#progress\n   * @param {Object} progress progress object\n   * @param {Number} progress.frames number of frames transcoded\n   * @param {Number} progress.currentFps current processing speed in frames per second\n   * @param {Number} progress.currentKbps current output generation speed in kilobytes per second\n   * @param {Number} progress.targetSize current output file size\n   * @param {String} progress.timemark current video timemark\n   * @param {Number} [progress.percent] processing progress (may not be available depending on input)\n   */\n\n  /**\n   * Emitted when ffmpeg outputs to stderr\n   *\n   * @event FfmpegCommand#stderr\n   * @param {String} line stderr output line\n   */\n\n  /**\n   * Emitted when ffmpeg reports input codec data\n   *\n   * @event FfmpegCommand#codecData\n   * @param {Object} codecData codec data object\n   * @param {String} codecData.format input format name\n   * @param {String} codecData.audio input audio codec name\n   * @param {String} codecData.audio_details input audio codec parameters\n   * @param {String} codecData.video input video codec name\n   * @param {String} codecData.video_details input video codec parameters\n   */\n\n  /**\n   * Emitted when an error happens when preparing or running a command\n   *\n   * @event FfmpegCommand#error\n   * @param {Error} error error object, with optional properties 'inputStreamError' / 'outputStreamError' for errors on their respective streams\n   * @param {String|null} stdout ffmpeg stdout, unless outputting to a stream\n   * @param {String|null} stderr ffmpeg stderr\n   */\n\n  /**\n   * Emitted when a command finishes processing\n   *\n   * @event FfmpegCommand#end\n   * @param {Array|String|null} [filenames|stdout] generated filenames when taking screenshots, ffmpeg stdout when not outputting to a stream, null otherwise\n   * @param {String|null} stderr ffmpeg stderr\n   */\n\n\n  /**\n   * Spawn an ffmpeg process\n   *\n   * The 'options' argument may contain the following keys:\n   * - 'niceness': specify process niceness, ignored on Windows (default: 0)\n   * - `cwd`: change working directory\n   * - 'captureStdout': capture stdout and pass it to 'endCB' as its 2nd argument (default: false)\n   * - 'stdoutLines': override command limit (default: use command limit)\n   *\n   * The 'processCB' callback, if present, is called as soon as the process is created and\n   * receives a nodejs ChildProcess object.  It may not be called at all if an error happens\n   * before spawning the process.\n   *\n   * The 'endCB' callback is called either when an error occurs or when the ffmpeg process finishes.\n   *\n   * @method FfmpegCommand#_spawnFfmpeg\n   * @param {Array} args ffmpeg command line argument list\n   * @param {Object} [options] spawn options (see above)\n   * @param {Function} [processCB] callback called with process object and stdout/stderr ring buffers when process has been created\n   * @param {Function} endCB callback called with error (if applicable) and stdout/stderr ring buffers when process finished\n   * @private\n   */\n  proto._spawnFfmpeg = function(args, options, processCB, endCB) {\n    // Enable omitting options\n    if (typeof options === 'function') {\n      endCB = processCB;\n      processCB = options;\n      options = {};\n    }\n\n    // Enable omitting processCB\n    if (typeof endCB === 'undefined') {\n      endCB = processCB;\n      processCB = function() {};\n    }\n\n    var maxLines = 'stdoutLines' in options ? options.stdoutLines : this.options.stdoutLines;\n\n    // Find ffmpeg\n    this._getFfmpegPath(function(err, command) {\n      if (err) {\n        return endCB(err);\n      } else if (!command || command.length === 0) {\n        return endCB(new Error('Cannot find ffmpeg'));\n      }\n\n      // Apply niceness\n      if (options.niceness && options.niceness !== 0 && !utils.isWindows) {\n        args.unshift('-n', options.niceness, command);\n        command = 'nice';\n      }\n\n      var stdoutRing = utils.linesRing(maxLines);\n      var stdoutClosed = false;\n\n      var stderrRing = utils.linesRing(maxLines);\n      var stderrClosed = false;\n\n      // Spawn process\n      var ffmpegProc = spawn(command, args, options);\n\n      if (ffmpegProc.stderr) {\n        ffmpegProc.stderr.setEncoding('utf8');\n      }\n\n      ffmpegProc.on('error', function(err) {\n        endCB(err);\n      });\n\n      // Ensure we wait for captured streams to end before calling endCB\n      var exitError = null;\n      function handleExit(err) {\n        if (err) {\n          exitError = err;\n        }\n\n        if (processExited && (stdoutClosed || !options.captureStdout) && stderrClosed) {\n          endCB(exitError, stdoutRing, stderrRing);\n        }\n      }\n\n      // Handle process exit\n      var processExited = false;\n      ffmpegProc.on('exit', function(code, signal) {\n        processExited = true;\n\n        if (signal) {\n          handleExit(new Error('ffmpeg was killed with signal ' + signal));\n        } else if (code) {\n          handleExit(new Error('ffmpeg exited with code ' + code));\n        } else {\n          handleExit();\n        }\n      });\n\n      // Capture stdout if specified\n      if (options.captureStdout) {\n        ffmpegProc.stdout.on('data', function(data) {\n          stdoutRing.append(data);\n        });\n\n        ffmpegProc.stdout.on('close', function() {\n          stdoutRing.close();\n          stdoutClosed = true;\n          handleExit();\n        });\n      }\n\n      // Capture stderr if specified\n      ffmpegProc.stderr.on('data', function(data) {\n        stderrRing.append(data);\n      });\n\n      ffmpegProc.stderr.on('close', function() {\n        stderrRing.close();\n        stderrClosed = true;\n        handleExit();\n      });\n\n      // Call process callback\n      processCB(ffmpegProc, stdoutRing, stderrRing);\n    });\n  };\n\n\n  /**\n   * Build the argument list for an ffmpeg command\n   *\n   * @method FfmpegCommand#_getArguments\n   * @return argument list\n   * @private\n   */\n  proto._getArguments = function() {\n    var complexFilters = this._complexFilters.get();\n\n    var fileOutput = this._outputs.some(function(output) {\n      return output.isFile;\n    });\n\n    return [].concat(\n        // Inputs and input options\n        this._inputs.reduce(function(args, input) {\n          var source = (typeof input.source === 'string') ? input.source : 'pipe:0';\n\n          // For each input, add input options, then '-i <source>'\n          return args.concat(\n            input.options.get(),\n            ['-i', source]\n          );\n        }, []),\n\n        // Global options\n        this._global.get(),\n\n        // Overwrite if we have file outputs\n        fileOutput ? ['-y'] : [],\n\n        // Complex filters\n        complexFilters,\n\n        // Outputs, filters and output options\n        this._outputs.reduce(function(args, output) {\n          var sizeFilters = utils.makeFilterStrings(output.sizeFilters.get());\n          var audioFilters = output.audioFilters.get();\n          var videoFilters = output.videoFilters.get().concat(sizeFilters);\n          var outputArg;\n\n          if (!output.target) {\n            outputArg = [];\n          } else if (typeof output.target === 'string') {\n            outputArg = [output.target];\n          } else {\n            outputArg = ['pipe:1'];\n          }\n\n          return args.concat(\n            output.audio.get(),\n            audioFilters.length ? ['-filter:a', audioFilters.join(',')] : [],\n            output.video.get(),\n            videoFilters.length ? ['-filter:v', videoFilters.join(',')] : [],\n            output.options.get(),\n            outputArg\n          );\n        }, [])\n      );\n  };\n\n\n  /**\n   * Prepare execution of an ffmpeg command\n   *\n   * Checks prerequisites for the execution of the command (codec/format availability, flvtool...),\n   * then builds the argument list for ffmpeg and pass them to 'callback'.\n   *\n   * @method FfmpegCommand#_prepare\n   * @param {Function} callback callback with signature (err, args)\n   * @param {Boolean} [readMetadata=false] read metadata before processing\n   * @private\n   */\n  proto._prepare = function(callback, readMetadata) {\n    var self = this;\n\n    async.waterfall([\n      // Check codecs and formats\n      function(cb) {\n        self._checkCapabilities(cb);\n      },\n\n      // Read metadata if required\n      function(cb) {\n        if (!readMetadata) {\n          return cb();\n        }\n\n        self.ffprobe(0, function(err, data) {\n          if (!err) {\n            self._ffprobeData = data;\n          }\n\n          cb();\n        });\n      },\n\n      // Check for flvtool2/flvmeta if necessary\n      function(cb) {\n        var flvmeta = self._outputs.some(function(output) {\n          // Remove flvmeta flag on non-file output\n          if (output.flags.flvmeta && !output.isFile) {\n            self.logger.warn('Updating flv metadata is only supported for files');\n            output.flags.flvmeta = false;\n          }\n\n          return output.flags.flvmeta;\n        });\n\n        if (flvmeta) {\n          self._getFlvtoolPath(function(err) {\n            cb(err);\n          });\n        } else {\n          cb();\n        }\n      },\n\n      // Build argument list\n      function(cb) {\n        var args;\n        try {\n          args = self._getArguments();\n        } catch(e) {\n          return cb(e);\n        }\n\n        cb(null, args);\n      },\n\n      // Add \"-strict experimental\" option where needed\n      function(args, cb) {\n        self.availableEncoders(function(err, encoders) {\n          for (var i = 0; i < args.length; i++) {\n            if (args[i] === '-acodec' || args[i] === '-vcodec') {\n              i++;\n\n              if ((args[i] in encoders) && encoders[args[i]].experimental) {\n                args.splice(i + 1, 0, '-strict', 'experimental');\n                i += 2;\n              }\n            }\n          }\n\n          cb(null, args);\n        });\n      }\n    ], callback);\n\n    if (!readMetadata) {\n      // Read metadata as soon as 'progress' listeners are added\n\n      if (this.listeners('progress').length > 0) {\n        // Read metadata in parallel\n        runFfprobe(this);\n      } else {\n        // Read metadata as soon as the first 'progress' listener is added\n        this.once('newListener', function(event) {\n          if (event === 'progress') {\n            runFfprobe(this);\n          }\n        });\n      }\n    }\n  };\n\n\n  /**\n   * Run ffmpeg command\n   *\n   * @method FfmpegCommand#run\n   * @category Processing\n   * @aliases exec,execute\n   */\n  proto.exec =\n  proto.execute =\n  proto.run = function() {\n    var self = this;\n\n    // Check if at least one output is present\n    var outputPresent = this._outputs.some(function(output) {\n      return 'target' in output;\n    });\n\n    if (!outputPresent) {\n      throw new Error('No output specified');\n    }\n\n    // Get output stream if any\n    var outputStream = this._outputs.filter(function(output) {\n      return typeof output.target !== 'string';\n    })[0];\n\n    // Get input stream if any\n    var inputStream = this._inputs.filter(function(input) {\n      return typeof input.source !== 'string';\n    })[0];\n\n    // Ensure we send 'end' or 'error' only once\n    var ended = false;\n    function emitEnd(err, stdout, stderr) {\n      if (!ended) {\n        ended = true;\n\n        if (err) {\n          self.emit('error', err, stdout, stderr);\n        } else {\n          self.emit('end', stdout, stderr);\n        }\n      }\n    }\n\n    self._prepare(function(err, args) {\n      if (err) {\n        return emitEnd(err);\n      }\n\n      // Run ffmpeg\n      self._spawnFfmpeg(\n        args,\n        {\n          captureStdout: !outputStream,\n          niceness: self.options.niceness,\n          cwd: self.options.cwd,\n          windowsHide: true\n        }, \n\n        function processCB(ffmpegProc, stdoutRing, stderrRing) {\n          self.ffmpegProc = ffmpegProc;\n          self.emit('start', 'ffmpeg ' + args.join(' '));\n\n          // Pipe input stream if any\n          if (inputStream) {\n            inputStream.source.on('error', function(err) {\n              var reportingErr = new Error('Input stream error: ' + err.message);\n              reportingErr.inputStreamError = err;\n              emitEnd(reportingErr);\n              ffmpegProc.kill();\n            });\n\n            inputStream.source.resume();\n            inputStream.source.pipe(ffmpegProc.stdin);\n\n            // Set stdin error handler on ffmpeg (prevents nodejs catching the error, but\n            // ffmpeg will fail anyway, so no need to actually handle anything)\n            ffmpegProc.stdin.on('error', function() {});\n          }\n\n          // Setup timeout if requested\n          if (self.options.timeout) {\n            self.processTimer = setTimeout(function() {\n              var msg = 'process ran into a timeout (' + self.options.timeout + 's)';\n\n              emitEnd(new Error(msg), stdoutRing.get(), stderrRing.get());\n              ffmpegProc.kill();\n            }, self.options.timeout * 1000);\n          }\n\n\n          if (outputStream) {\n            // Pipe ffmpeg stdout to output stream\n            ffmpegProc.stdout.pipe(outputStream.target, outputStream.pipeopts);\n\n            // Handle output stream events\n            outputStream.target.on('close', function() {\n              self.logger.debug('Output stream closed, scheduling kill for ffmpeg process');\n\n              // Don't kill process yet, to give a chance to ffmpeg to\n              // terminate successfully first  This is necessary because\n              // under load, the process 'exit' event sometimes happens\n              // after the output stream 'close' event.\n              setTimeout(function() {\n                emitEnd(new Error('Output stream closed'));\n                ffmpegProc.kill();\n              }, 20);\n            });\n\n            outputStream.target.on('error', function(err) {\n              self.logger.debug('Output stream error, killing ffmpeg process');\n              var reportingErr = new Error('Output stream error: ' + err.message);\n              reportingErr.outputStreamError = err;\n              emitEnd(reportingErr, stdoutRing.get(), stderrRing.get());\n              ffmpegProc.kill('SIGKILL');\n            });\n          }\n\n          // Setup stderr handling\n          if (stderrRing) {\n\n            // 'stderr' event\n            if (self.listeners('stderr').length) {\n              stderrRing.callback(function(line) {\n                self.emit('stderr', line);\n              });\n            }\n\n            // 'codecData' event\n            if (self.listeners('codecData').length) {\n              var codecDataSent = false;\n              var codecObject = {};\n\n              stderrRing.callback(function(line) {\n                if (!codecDataSent)\n                  codecDataSent = utils.extractCodecData(self, line, codecObject);\n              });\n            }\n\n            // 'progress' event\n            if (self.listeners('progress').length) {\n              stderrRing.callback(function(line) {\n                utils.extractProgress(self, line);\n              });\n            }\n          }\n        },\n\n        function endCB(err, stdoutRing, stderrRing) {\n          clearTimeout(self.processTimer);\n          delete self.ffmpegProc;\n\n          if (err) {\n            if (err.message.match(/ffmpeg exited with code/)) {\n              // Add ffmpeg error message\n              err.message += ': ' + utils.extractError(stderrRing.get());\n            }\n\n            emitEnd(err, stdoutRing.get(), stderrRing.get());\n          } else {\n            // Find out which outputs need flv metadata\n            var flvmeta = self._outputs.filter(function(output) {\n              return output.flags.flvmeta;\n            });\n\n            if (flvmeta.length) {\n              self._getFlvtoolPath(function(err, flvtool) {\n                if (err) {\n                  return emitEnd(err);\n                }\n\n                async.each(\n                  flvmeta,\n                  function(output, cb) {\n                    spawn(flvtool, ['-U', output.target], {windowsHide: true})\n                      .on('error', function(err) {\n                        cb(new Error('Error running ' + flvtool + ' on ' + output.target + ': ' + err.message));\n                      })\n                      .on('exit', function(code, signal) {\n                        if (code !== 0 || signal) {\n                          cb(\n                            new Error(flvtool + ' ' +\n                              (signal ? 'received signal ' + signal\n                                      : 'exited with code ' + code)) +\n                              ' when running on ' + output.target\n                          );\n                        } else {\n                          cb();\n                        }\n                      });\n                  },\n                  function(err) {\n                    if (err) {\n                      emitEnd(err);\n                    } else {\n                      emitEnd(null, stdoutRing.get(), stderrRing.get());\n                    }\n                  }\n                );\n              });\n            } else {\n              emitEnd(null, stdoutRing.get(), stderrRing.get());\n            }\n          }\n        }\n      );\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Renice current and/or future ffmpeg processes\n   *\n   * Ignored on Windows platforms.\n   *\n   * @method FfmpegCommand#renice\n   * @category Processing\n   *\n   * @param {Number} [niceness=0] niceness value between -20 (highest priority) and 20 (lowest priority)\n   * @return FfmpegCommand\n   */\n  proto.renice = function(niceness) {\n    if (!utils.isWindows) {\n      niceness = niceness || 0;\n\n      if (niceness < -20 || niceness > 20) {\n        this.logger.warn('Invalid niceness value: ' + niceness + ', must be between -20 and 20');\n      }\n\n      niceness = Math.min(20, Math.max(-20, niceness));\n      this.options.niceness = niceness;\n\n      if (this.ffmpegProc) {\n        var logger = this.logger;\n        var pid = this.ffmpegProc.pid;\n        var renice = spawn('renice', [niceness, '-p', pid], {windowsHide: true});\n\n        renice.on('error', function(err) {\n          logger.warn('could not renice process ' + pid + ': ' + err.message);\n        });\n\n        renice.on('exit', function(code, signal) {\n          if (signal) {\n            logger.warn('could not renice process ' + pid + ': renice was killed by signal ' + signal);\n          } else if (code) {\n            logger.warn('could not renice process ' + pid + ': renice exited with ' + code);\n          } else {\n            logger.info('successfully reniced process ' + pid + ' to ' + niceness + ' niceness');\n          }\n        });\n      }\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Kill current ffmpeg process, if any\n   *\n   * @method FfmpegCommand#kill\n   * @category Processing\n   *\n   * @param {String} [signal=SIGKILL] signal name\n   * @return FfmpegCommand\n   */\n  proto.kill = function(signal) {\n    if (!this.ffmpegProc) {\n      this.logger.warn('No running ffmpeg process, cannot send signal');\n    } else {\n      this.ffmpegProc.kill(signal || 'SIGKILL');\n    }\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar async = require('async');\nvar utils = require('./utils');\n\n/*\n *! Capability helpers\n */\n\nvar avCodecRegexp = /^\\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/;\nvar ffCodecRegexp = /^\\s*([D\\.])([E\\.])([VAS])([I\\.])([L\\.])([S\\.]) ([^ ]+) +(.*)$/;\nvar ffEncodersRegexp = /\\(encoders:([^\\)]+)\\)/;\nvar ffDecodersRegexp = /\\(decoders:([^\\)]+)\\)/;\nvar encodersRegexp = /^\\s*([VAS\\.])([F\\.])([S\\.])([X\\.])([B\\.])([D\\.]) ([^ ]+) +(.*)$/;\nvar formatRegexp = /^\\s*([D ])([E ])\\s+([^ ]+)\\s+(.*)$/;\nvar lineBreakRegexp = /\\r\\n|\\r|\\n/;\nvar filterRegexp = /^(?: [T\\.][S\\.][C\\.] )?([^ ]+) +(AA?|VV?|\\|)->(AA?|VV?|\\|) +(.*)$/;\n\nvar cache = {};\n\nmodule.exports = function(proto) {\n  /**\n   * Manually define the ffmpeg binary full path.\n   *\n   * @method FfmpegCommand#setFfmpegPath\n   *\n   * @param {String} ffmpegPath The full path to the ffmpeg binary.\n   * @return FfmpegCommand\n   */\n  proto.setFfmpegPath = function(ffmpegPath) {\n    cache.ffmpegPath = ffmpegPath;\n    return this;\n  };\n\n  /**\n   * Manually define the ffprobe binary full path.\n   *\n   * @method FfmpegCommand#setFfprobePath\n   *\n   * @param {String} ffprobePath The full path to the ffprobe binary.\n   * @return FfmpegCommand\n   */\n  proto.setFfprobePath = function(ffprobePath) {\n    cache.ffprobePath = ffprobePath;\n    return this;\n  };\n\n  /**\n   * Manually define the flvtool2/flvmeta binary full path.\n   *\n   * @method FfmpegCommand#setFlvtoolPath\n   *\n   * @param {String} flvtool The full path to the flvtool2 or flvmeta binary.\n   * @return FfmpegCommand\n   */\n  proto.setFlvtoolPath = function(flvtool) {\n    cache.flvtoolPath = flvtool;\n    return this;\n  };\n\n  /**\n   * Forget executable paths\n   *\n   * (only used for testing purposes)\n   *\n   * @method FfmpegCommand#_forgetPaths\n   * @private\n   */\n  proto._forgetPaths = function() {\n    delete cache.ffmpegPath;\n    delete cache.ffprobePath;\n    delete cache.flvtoolPath;\n  };\n\n  /**\n   * Check for ffmpeg availability\n   *\n   * If the FFMPEG_PATH environment variable is set, try to use it.\n   * If it is unset or incorrect, try to find ffmpeg in the PATH instead.\n   *\n   * @method FfmpegCommand#_getFfmpegPath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  proto._getFfmpegPath = function(callback) {\n    if ('ffmpegPath' in cache) {\n      return callback(null, cache.ffmpegPath);\n    }\n\n    async.waterfall([\n      // Try FFMPEG_PATH\n      function(cb) {\n        if (process.env.FFMPEG_PATH) {\n          fs.exists(process.env.FFMPEG_PATH, function(exists) {\n            if (exists) {\n              cb(null, process.env.FFMPEG_PATH);\n            } else {\n              cb(null, '');\n            }\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search in the PATH\n      function(ffmpeg, cb) {\n        if (ffmpeg.length) {\n          return cb(null, ffmpeg);\n        }\n\n        utils.which('ffmpeg', function(err, ffmpeg) {\n          cb(err, ffmpeg);\n        });\n      }\n    ], function(err, ffmpeg) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.ffmpegPath = (ffmpeg || ''));\n      }\n    });\n  };\n\n\n  /**\n   * Check for ffprobe availability\n   *\n   * If the FFPROBE_PATH environment variable is set, try to use it.\n   * If it is unset or incorrect, try to find ffprobe in the PATH instead.\n   * If this still fails, try to find ffprobe in the same directory as ffmpeg.\n   *\n   * @method FfmpegCommand#_getFfprobePath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  proto._getFfprobePath = function(callback) {\n    var self = this;\n\n    if ('ffprobePath' in cache) {\n      return callback(null, cache.ffprobePath);\n    }\n\n    async.waterfall([\n      // Try FFPROBE_PATH\n      function(cb) {\n        if (process.env.FFPROBE_PATH) {\n          fs.exists(process.env.FFPROBE_PATH, function(exists) {\n            cb(null, exists ? process.env.FFPROBE_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search in the PATH\n      function(ffprobe, cb) {\n        if (ffprobe.length) {\n          return cb(null, ffprobe);\n        }\n\n        utils.which('ffprobe', function(err, ffprobe) {\n          cb(err, ffprobe);\n        });\n      },\n\n      // Search in the same directory as ffmpeg\n      function(ffprobe, cb) {\n        if (ffprobe.length) {\n          return cb(null, ffprobe);\n        }\n\n        self._getFfmpegPath(function(err, ffmpeg) {\n          if (err) {\n            cb(err);\n          } else if (ffmpeg.length) {\n            var name = utils.isWindows ? 'ffprobe.exe' : 'ffprobe';\n            var ffprobe = path.join(path.dirname(ffmpeg), name);\n            fs.exists(ffprobe, function(exists) {\n              cb(null, exists ? ffprobe : '');\n            });\n          } else {\n            cb(null, '');\n          }\n        });\n      }\n    ], function(err, ffprobe) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.ffprobePath = (ffprobe || ''));\n      }\n    });\n  };\n\n\n  /**\n   * Check for flvtool2/flvmeta availability\n   *\n   * If the FLVTOOL2_PATH or FLVMETA_PATH environment variable are set, try to use them.\n   * If both are either unset or incorrect, try to find flvtool2 or flvmeta in the PATH instead.\n   *\n   * @method FfmpegCommand#_getFlvtoolPath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n   proto._getFlvtoolPath = function(callback) {\n    if ('flvtoolPath' in cache) {\n      return callback(null, cache.flvtoolPath);\n    }\n\n    async.waterfall([\n      // Try FLVMETA_PATH\n      function(cb) {\n        if (process.env.FLVMETA_PATH) {\n          fs.exists(process.env.FLVMETA_PATH, function(exists) {\n            cb(null, exists ? process.env.FLVMETA_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Try FLVTOOL2_PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        if (process.env.FLVTOOL2_PATH) {\n          fs.exists(process.env.FLVTOOL2_PATH, function(exists) {\n            cb(null, exists ? process.env.FLVTOOL2_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search for flvmeta in the PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        utils.which('flvmeta', function(err, flvmeta) {\n          cb(err, flvmeta);\n        });\n      },\n\n      // Search for flvtool2 in the PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        utils.which('flvtool2', function(err, flvtool2) {\n          cb(err, flvtool2);\n        });\n      },\n    ], function(err, flvtool) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.flvtoolPath = (flvtool || ''));\n      }\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableFilters}.\n   *\n   * @callback FfmpegCommand~filterCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} filters filter object with filter names as keys and the following\n   *   properties for each filter:\n   * @param {String} filters.description filter description\n   * @param {String} filters.input input type, one of 'audio', 'video' and 'none'\n   * @param {Boolean} filters.multipleInputs whether the filter supports multiple inputs\n   * @param {String} filters.output output type, one of 'audio', 'video' and 'none'\n   * @param {Boolean} filters.multipleOutputs whether the filter supports multiple outputs\n   */\n\n  /**\n   * Query ffmpeg for available filters\n   *\n   * @method FfmpegCommand#availableFilters\n   * @category Capabilities\n   * @aliases getAvailableFilters\n   *\n   * @param {FfmpegCommand~filterCallback} callback callback function\n   */\n  proto.availableFilters =\n  proto.getAvailableFilters = function(callback) {\n    if ('filters' in cache) {\n      return callback(null, cache.filters);\n    }\n\n    this._spawnFfmpeg(['-filters'], { captureStdout: true, stdoutLines: 0 }, function (err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split('\\n');\n      var data = {};\n      var types = { A: 'audio', V: 'video', '|': 'none' };\n\n      lines.forEach(function(line) {\n        var match = line.match(filterRegexp);\n        if (match) {\n          data[match[1]] = {\n            description: match[4],\n            input: types[match[2].charAt(0)],\n            multipleInputs: match[2].length > 1,\n            output: types[match[3].charAt(0)],\n            multipleOutputs: match[3].length > 1\n          };\n        }\n      });\n\n      callback(null, cache.filters = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableCodecs}.\n   *\n   * @callback FfmpegCommand~codecCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} codecs codec object with codec names as keys and the following\n   *   properties for each codec (more properties may be available depending on the\n   *   ffmpeg version used):\n   * @param {String} codecs.description codec description\n   * @param {Boolean} codecs.canDecode whether the codec is able to decode streams\n   * @param {Boolean} codecs.canEncode whether the codec is able to encode streams\n   */\n\n  /**\n   * Query ffmpeg for available codecs\n   *\n   * @method FfmpegCommand#availableCodecs\n   * @category Capabilities\n   * @aliases getAvailableCodecs\n   *\n   * @param {FfmpegCommand~codecCallback} callback callback function\n   */\n  proto.availableCodecs =\n  proto.getAvailableCodecs = function(callback) {\n    if ('codecs' in cache) {\n      return callback(null, cache.codecs);\n    }\n\n    this._spawnFfmpeg(['-codecs'], { captureStdout: true, stdoutLines: 0 }, function(err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(avCodecRegexp);\n        if (match && match[7] !== '=') {\n          data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[3]],\n            description: match[8],\n            canDecode: match[1] === 'D',\n            canEncode: match[2] === 'E',\n            drawHorizBand: match[4] === 'S',\n            directRendering: match[5] === 'D',\n            weirdFrameTruncation: match[6] === 'T'\n          };\n        }\n\n        match = line.match(ffCodecRegexp);\n        if (match && match[7] !== '=') {\n          var codecData = data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[3]],\n            description: match[8],\n            canDecode: match[1] === 'D',\n            canEncode: match[2] === 'E',\n            intraFrameOnly: match[4] === 'I',\n            isLossy: match[5] === 'L',\n            isLossless: match[6] === 'S'\n          };\n\n          var encoders = codecData.description.match(ffEncodersRegexp);\n          encoders = encoders ? encoders[1].trim().split(' ') : [];\n\n          var decoders = codecData.description.match(ffDecodersRegexp);\n          decoders = decoders ? decoders[1].trim().split(' ') : [];\n\n          if (encoders.length || decoders.length) {\n            var coderData = {};\n            utils.copy(codecData, coderData);\n            delete coderData.canEncode;\n            delete coderData.canDecode;\n\n            encoders.forEach(function(name) {\n              data[name] = {};\n              utils.copy(coderData, data[name]);\n              data[name].canEncode = true;\n            });\n\n            decoders.forEach(function(name) {\n              if (name in data) {\n                data[name].canDecode = true;\n              } else {\n                data[name] = {};\n                utils.copy(coderData, data[name]);\n                data[name].canDecode = true;\n              }\n            });\n          }\n        }\n      });\n\n      callback(null, cache.codecs = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableEncoders}.\n   *\n   * @callback FfmpegCommand~encodersCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} encoders encoders object with encoder names as keys and the following\n   *   properties for each encoder:\n   * @param {String} encoders.description codec description\n   * @param {Boolean} encoders.type \"audio\", \"video\" or \"subtitle\"\n   * @param {Boolean} encoders.frameMT whether the encoder is able to do frame-level multithreading\n   * @param {Boolean} encoders.sliceMT whether the encoder is able to do slice-level multithreading\n   * @param {Boolean} encoders.experimental whether the encoder is experimental\n   * @param {Boolean} encoders.drawHorizBand whether the encoder supports draw_horiz_band\n   * @param {Boolean} encoders.directRendering whether the encoder supports direct encoding method 1\n   */\n\n  /**\n   * Query ffmpeg for available encoders\n   *\n   * @method FfmpegCommand#availableEncoders\n   * @category Capabilities\n   * @aliases getAvailableEncoders\n   *\n   * @param {FfmpegCommand~encodersCallback} callback callback function\n   */\n  proto.availableEncoders =\n  proto.getAvailableEncoders = function(callback) {\n    if ('encoders' in cache) {\n      return callback(null, cache.encoders);\n    }\n\n    this._spawnFfmpeg(['-encoders'], { captureStdout: true, stdoutLines: 0 }, function(err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(encodersRegexp);\n        if (match && match[7] !== '=') {\n          data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[1]],\n            description: match[8],\n            frameMT: match[2] === 'F',\n            sliceMT: match[3] === 'S',\n            experimental: match[4] === 'X',\n            drawHorizBand: match[5] === 'B',\n            directRendering: match[6] === 'D'\n          };\n        }\n      });\n\n      callback(null, cache.encoders = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableFormats}.\n   *\n   * @callback FfmpegCommand~formatCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} formats format object with format names as keys and the following\n   *   properties for each format:\n   * @param {String} formats.description format description\n   * @param {Boolean} formats.canDemux whether the format is able to demux streams from an input file\n   * @param {Boolean} formats.canMux whether the format is able to mux streams into an output file\n   */\n\n  /**\n   * Query ffmpeg for available formats\n   *\n   * @method FfmpegCommand#availableFormats\n   * @category Capabilities\n   * @aliases getAvailableFormats\n   *\n   * @param {FfmpegCommand~formatCallback} callback callback function\n   */\n  proto.availableFormats =\n  proto.getAvailableFormats = function(callback) {\n    if ('formats' in cache) {\n      return callback(null, cache.formats);\n    }\n\n    // Run ffmpeg -formats\n    this._spawnFfmpeg(['-formats'], { captureStdout: true, stdoutLines: 0 }, function (err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      // Parse output\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(formatRegexp);\n        if (match) {\n          match[3].split(',').forEach(function(format) {\n            if (!(format in data)) {\n              data[format] = {\n                description: match[4],\n                canDemux: false,\n                canMux: false\n              };\n            }\n\n            if (match[1] === 'D') {\n              data[format].canDemux = true;\n            }\n            if (match[2] === 'E') {\n              data[format].canMux = true;\n            }\n          });\n        }\n      });\n\n      callback(null, cache.formats = data);\n    });\n  };\n\n\n  /**\n   * Check capabilities before executing a command\n   *\n   * Checks whether all used codecs and formats are indeed available\n   *\n   * @method FfmpegCommand#_checkCapabilities\n   * @param {Function} callback callback with signature (err)\n   * @private\n   */\n  proto._checkCapabilities = function(callback) {\n    var self = this;\n    async.waterfall([\n      // Get available formats\n      function(cb) {\n        self.availableFormats(cb);\n      },\n\n      // Check whether specified formats are available\n      function(formats, cb) {\n        var unavailable;\n\n        // Output format(s)\n        unavailable = self._outputs\n          .reduce(function(fmts, output) {\n            var format = output.options.find('-f', 1);\n            if (format) {\n              if (!(format[0] in formats) || !(formats[format[0]].canMux)) {\n                fmts.push(format);\n              }\n            }\n\n            return fmts;\n          }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Output format ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Output formats ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        // Input format(s)\n        unavailable = self._inputs\n          .reduce(function(fmts, input) {\n            var format = input.options.find('-f', 1);\n            if (format) {\n              if (!(format[0] in formats) || !(formats[format[0]].canDemux)) {\n                fmts.push(format[0]);\n              }\n            }\n\n            return fmts;\n          }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Input format ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Input formats ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        cb();\n      },\n\n      // Get available codecs\n      function(cb) {\n        self.availableEncoders(cb);\n      },\n\n      // Check whether specified codecs are available and add strict experimental options if needed\n      function(encoders, cb) {\n        var unavailable;\n\n        // Audio codec(s)\n        unavailable = self._outputs.reduce(function(cdcs, output) {\n          var acodec = output.audio.find('-acodec', 1);\n          if (acodec && acodec[0] !== 'copy') {\n            if (!(acodec[0] in encoders) || encoders[acodec[0]].type !== 'audio') {\n              cdcs.push(acodec[0]);\n            }\n          }\n\n          return cdcs;\n        }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Audio codec ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Audio codecs ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        // Video codec(s)\n        unavailable = self._outputs.reduce(function(cdcs, output) {\n          var vcodec = output.video.find('-vcodec', 1);\n          if (vcodec && vcodec[0] !== 'copy') {\n            if (!(vcodec[0] in encoders) || encoders[vcodec[0]].type !== 'video') {\n              cdcs.push(vcodec[0]);\n            }\n          }\n\n          return cdcs;\n        }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Video codec ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Video codecs ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        cb();\n      }\n    ], callback);\n  };\n};\n","/*jshint node:true, laxcomma:true*/\n'use strict';\n\nvar spawn = require('child_process').spawn;\n\n\nfunction legacyTag(key) { return key.match(/^TAG:/); }\nfunction legacyDisposition(key) { return key.match(/^DISPOSITION:/); }\n\nfunction parseFfprobeOutput(out) {\n  var lines = out.split(/\\r\\n|\\r|\\n/);\n\n  lines = lines.filter(function (line) {\n    return line.length > 0;\n  });\n\n  var data = {\n    streams: [],\n    format: {},\n    chapters: []\n  };\n\n  function parseBlock(name) {\n    var data = {};\n\n    var line = lines.shift();\n    while (typeof line !== 'undefined') {\n      if (line.toLowerCase() == '[/'+name+']') {\n        return data;\n      } else if (line.match(/^\\[/)) {\n        line = lines.shift();\n        continue;\n      }\n\n      var kv = line.match(/^([^=]+)=(.*)$/);\n      if (kv) {\n        if (!(kv[1].match(/^TAG:/)) && kv[2].match(/^[0-9]+(\\.[0-9]+)?$/)) {\n          data[kv[1]] = Number(kv[2]);\n        } else {\n          data[kv[1]] = kv[2];\n        }\n      }\n\n      line = lines.shift();\n    }\n\n    return data;\n  }\n\n  var line = lines.shift();\n  while (typeof line !== 'undefined') {\n    if (line.match(/^\\[stream/i)) {\n      var stream = parseBlock('stream');\n      data.streams.push(stream);\n    } else if (line.match(/^\\[chapter/i)) {\n      var chapter = parseBlock('chapter');\n      data.chapters.push(chapter);\n    } else if (line.toLowerCase() === '[format]') {\n      data.format = parseBlock('format');\n    }\n\n    line = lines.shift();\n  }\n\n  return data;\n}\n\n\n\nmodule.exports = function(proto) {\n  /**\n   * A callback passed to the {@link FfmpegCommand#ffprobe} method.\n   *\n   * @callback FfmpegCommand~ffprobeCallback\n   *\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} ffprobeData ffprobe output data; this object\n   *   has the same format as what the following command returns:\n   *\n   *     `ffprobe -print_format json -show_streams -show_format INPUTFILE`\n   * @param {Array} ffprobeData.streams stream information\n   * @param {Object} ffprobeData.format format information\n   */\n\n  /**\n   * Run ffprobe on last specified input\n   *\n   * @method FfmpegCommand#ffprobe\n   * @category Metadata\n   *\n   * @param {?Number} [index] 0-based index of input to probe (defaults to last input)\n   * @param {?String[]} [options] array of output options to return\n   * @param {FfmpegCommand~ffprobeCallback} callback callback function\n   *\n   */\n  proto.ffprobe = function() {\n    var input, index = null, options = [], callback;\n\n    // the last argument should be the callback\n    var callback = arguments[arguments.length - 1];\n\n    var ended = false\n    function handleCallback(err, data) {\n      if (!ended) {\n        ended = true;\n        callback(err, data);\n      }\n    };\n\n    // map the arguments to the correct variable names\n    switch (arguments.length) {\n      case 3:\n        index = arguments[0];\n        options = arguments[1];\n        break;\n      case 2:\n        if (typeof arguments[0] === 'number') {\n          index = arguments[0];\n        } else if (Array.isArray(arguments[0])) {\n          options = arguments[0];\n        }\n        break;\n    }\n\n\n    if (index === null) {\n      if (!this._currentInput) {\n        return handleCallback(new Error('No input specified'));\n      }\n\n      input = this._currentInput;\n    } else {\n      input = this._inputs[index];\n\n      if (!input) {\n        return handleCallback(new Error('Invalid input index'));\n      }\n    }\n\n    // Find ffprobe\n    this._getFfprobePath(function(err, path) {\n      if (err) {\n        return handleCallback(err);\n      } else if (!path) {\n        return handleCallback(new Error('Cannot find ffprobe'));\n      }\n\n      var stdout = '';\n      var stdoutClosed = false;\n      var stderr = '';\n      var stderrClosed = false;\n\n      // Spawn ffprobe\n      var src = input.isStream ? 'pipe:0' : input.source;\n      var ffprobe = spawn(path, ['-show_streams', '-show_format'].concat(options, src), {windowsHide: true});\n\n      if (input.isStream) {\n        // Skip errors on stdin. These get thrown when ffprobe is complete and\n        // there seems to be no way hook in and close stdin before it throws.\n        ffprobe.stdin.on('error', function(err) {\n          if (['ECONNRESET', 'EPIPE', 'EOF'].indexOf(err.code) >= 0) { return; }\n          handleCallback(err);\n        });\n\n        // Once ffprobe's input stream closes, we need no more data from the\n        // input\n        ffprobe.stdin.on('close', function() {\n            input.source.pause();\n            input.source.unpipe(ffprobe.stdin);\n        });\n\n        input.source.pipe(ffprobe.stdin);\n      }\n\n      ffprobe.on('error', callback);\n\n      // Ensure we wait for captured streams to end before calling callback\n      var exitError = null;\n      function handleExit(err) {\n        if (err) {\n          exitError = err;\n        }\n\n        if (processExited && stdoutClosed && stderrClosed) {\n          if (exitError) {\n            if (stderr) {\n              exitError.message += '\\n' + stderr;\n            }\n\n            return handleCallback(exitError);\n          }\n\n          // Process output\n          var data = parseFfprobeOutput(stdout);\n\n          // Handle legacy output with \"TAG:x\" and \"DISPOSITION:x\" keys\n          [data.format].concat(data.streams).forEach(function(target) {\n            if (target) {\n              var legacyTagKeys = Object.keys(target).filter(legacyTag);\n\n              if (legacyTagKeys.length) {\n                target.tags = target.tags || {};\n\n                legacyTagKeys.forEach(function(tagKey) {\n                  target.tags[tagKey.substr(4)] = target[tagKey];\n                  delete target[tagKey];\n                });\n              }\n\n              var legacyDispositionKeys = Object.keys(target).filter(legacyDisposition);\n\n              if (legacyDispositionKeys.length) {\n                target.disposition = target.disposition || {};\n\n                legacyDispositionKeys.forEach(function(dispositionKey) {\n                  target.disposition[dispositionKey.substr(12)] = target[dispositionKey];\n                  delete target[dispositionKey];\n                });\n              }\n            }\n          });\n\n          handleCallback(null, data);\n        }\n      }\n\n      // Handle ffprobe exit\n      var processExited = false;\n      ffprobe.on('exit', function(code, signal) {\n        processExited = true;\n\n        if (code) {\n          handleExit(new Error('ffprobe exited with code ' + code));\n        } else if (signal) {\n          handleExit(new Error('ffprobe was killed with signal ' + signal));\n        } else {\n          handleExit();\n        }\n      });\n\n      // Handle stdout/stderr streams\n      ffprobe.stdout.on('data', function(data) {\n        stdout += data;\n      });\n\n      ffprobe.stdout.on('close', function() {\n        stdoutClosed = true;\n        handleExit();\n      });\n\n      ffprobe.stderr.on('data', function(data) {\n        stderr += data;\n      });\n\n      ffprobe.stderr.on('close', function() {\n        stderrClosed = true;\n        handleExit();\n      });\n    });\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar PassThrough = require('stream').PassThrough;\nvar async = require('async');\nvar utils = require('./utils');\n\n\n/*\n * Useful recipes for commands\n */\n\nmodule.exports = function recipes(proto) {\n  /**\n   * Execute ffmpeg command and save output to a file\n   *\n   * @method FfmpegCommand#save\n   * @category Processing\n   * @aliases saveToFile\n   *\n   * @param {String} output file path\n   * @return FfmpegCommand\n   */\n  proto.saveToFile =\n  proto.save = function(output) {\n    this.output(output).run();\n    return this;\n  };\n\n\n  /**\n   * Execute ffmpeg command and save output to a stream\n   *\n   * If 'stream' is not specified, a PassThrough stream is created and returned.\n   * 'options' will be used when piping ffmpeg output to the output stream\n   * (@see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options)\n   *\n   * @method FfmpegCommand#pipe\n   * @category Processing\n   * @aliases stream,writeToStream\n   *\n   * @param {stream.Writable} [stream] output stream\n   * @param {Object} [options={}] pipe options\n   * @return Output stream\n   */\n  proto.writeToStream =\n  proto.pipe =\n  proto.stream = function(stream, options) {\n    if (stream && !('writable' in stream)) {\n      options = stream;\n      stream = undefined;\n    }\n\n    if (!stream) {\n      if (process.version.match(/v0\\.8\\./)) {\n        throw new Error('PassThrough stream is not supported on node v0.8');\n      }\n\n      stream = new PassThrough();\n    }\n\n    this.output(stream, options).run();\n    return stream;\n  };\n\n\n  /**\n   * Generate images from a video\n   *\n   * Note: this method makes the command emit a 'filenames' event with an array of\n   * the generated image filenames.\n   *\n   * @method FfmpegCommand#screenshots\n   * @category Processing\n   * @aliases takeScreenshots,thumbnail,thumbnails,screenshot\n   *\n   * @param {Number|Object} [config=1] screenshot count or configuration object with\n   *   the following keys:\n   * @param {Number} [config.count] number of screenshots to take; using this option\n   *   takes screenshots at regular intervals (eg. count=4 would take screens at 20%, 40%,\n   *   60% and 80% of the video length).\n   * @param {String} [config.folder='.'] output folder\n   * @param {String} [config.filename='tn.png'] output filename pattern, may contain the following\n   *   tokens:\n   *   - '%s': offset in seconds\n   *   - '%w': screenshot width\n   *   - '%h': screenshot height\n   *   - '%r': screenshot resolution (same as '%wx%h')\n   *   - '%f': input filename\n   *   - '%b': input basename (filename w/o extension)\n   *   - '%i': index of screenshot in timemark array (can be zero-padded by using it like `%000i`)\n   * @param {Number[]|String[]} [config.timemarks] array of timemarks to take screenshots\n   *   at; each timemark may be a number of seconds, a '[[hh:]mm:]ss[.xxx]' string or a\n   *   'XX%' string.  Overrides 'count' if present.\n   * @param {Number[]|String[]} [config.timestamps] alias for 'timemarks'\n   * @param {Boolean} [config.fastSeek] use fast seek (less accurate)\n   * @param {String} [config.size] screenshot size, with the same syntax as {@link FfmpegCommand#size}\n   * @param {String} [folder] output folder (legacy alias for 'config.folder')\n   * @return FfmpegCommand\n   */\n  proto.takeScreenshots =\n  proto.thumbnail =\n  proto.thumbnails =\n  proto.screenshot =\n  proto.screenshots = function(config, folder) {\n    var self = this;\n    var source = this._currentInput.source;\n    config = config || { count: 1 };\n\n    // Accept a number of screenshots instead of a config object\n    if (typeof config === 'number') {\n      config = {\n        count: config\n      };\n    }\n\n    // Accept a second 'folder' parameter instead of config.folder\n    if (!('folder' in config)) {\n      config.folder = folder || '.';\n    }\n\n    // Accept 'timestamps' instead of 'timemarks'\n    if ('timestamps' in config) {\n      config.timemarks = config.timestamps;\n    }\n\n    // Compute timemarks from count if not present\n    if (!('timemarks' in config)) {\n      if (!config.count) {\n        throw new Error('Cannot take screenshots: neither a count nor a timemark list are specified');\n      }\n\n      var interval = 100 / (1 + config.count);\n      config.timemarks = [];\n      for (var i = 0; i < config.count; i++) {\n        config.timemarks.push((interval * (i + 1)) + '%');\n      }\n    }\n\n    // Parse size option\n    if ('size' in config) {\n      var fixedSize = config.size.match(/^(\\d+)x(\\d+)$/);\n      var fixedWidth = config.size.match(/^(\\d+)x\\?$/);\n      var fixedHeight = config.size.match(/^\\?x(\\d+)$/);\n      var percentSize = config.size.match(/^(\\d+)%$/);\n\n      if (!fixedSize && !fixedWidth && !fixedHeight && !percentSize) {\n        throw new Error('Invalid size parameter: ' + config.size);\n      }\n    }\n\n    // Metadata helper\n    var metadata;\n    function getMetadata(cb) {\n      if (metadata) {\n        cb(null, metadata);\n      } else {\n        self.ffprobe(function(err, meta) {\n          metadata = meta;\n          cb(err, meta);\n        });\n      }\n    }\n\n    async.waterfall([\n      // Compute percent timemarks if any\n      function computeTimemarks(next) {\n        if (config.timemarks.some(function(t) { return ('' + t).match(/^[\\d.]+%$/); })) {\n          if (typeof source !== 'string') {\n            return next(new Error('Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks'));\n          }\n\n          getMetadata(function(err, meta) {\n            if (err) {\n              next(err);\n            } else {\n              // Select video stream with the highest resolution\n              var vstream = meta.streams.reduce(function(biggest, stream) {\n                if (stream.codec_type === 'video' && stream.width * stream.height > biggest.width * biggest.height) {\n                  return stream;\n                } else {\n                  return biggest;\n                }\n              }, { width: 0, height: 0 });\n\n              if (vstream.width === 0) {\n                return next(new Error('No video stream in input, cannot take screenshots'));\n              }\n\n              var duration = Number(vstream.duration);\n              if (isNaN(duration)) {\n                duration = Number(meta.format.duration);\n              }\n\n              if (isNaN(duration)) {\n                return next(new Error('Could not get input duration, please specify fixed timemarks'));\n              }\n\n              config.timemarks = config.timemarks.map(function(mark) {\n                if (('' + mark).match(/^([\\d.]+)%$/)) {\n                  return duration * parseFloat(mark) / 100;\n                } else {\n                  return mark;\n                }\n              });\n\n              next();\n            }\n          });\n        } else {\n          next();\n        }\n      },\n\n      // Turn all timemarks into numbers and sort them\n      function normalizeTimemarks(next) {\n        config.timemarks = config.timemarks.map(function(mark) {\n          return utils.timemarkToSeconds(mark);\n        }).sort(function(a, b) { return a - b; });\n\n        next();\n      },\n\n      // Add '_%i' to pattern when requesting multiple screenshots and no variable token is present\n      function fixPattern(next) {\n        var pattern = config.filename || 'tn.png';\n\n        if (pattern.indexOf('.') === -1) {\n          pattern += '.png';\n        }\n\n        if (config.timemarks.length > 1 && !pattern.match(/%(s|0*i)/)) {\n          var ext = path.extname(pattern);\n          pattern = path.join(path.dirname(pattern), path.basename(pattern, ext) + '_%i' + ext);\n        }\n\n        next(null, pattern);\n      },\n\n      // Replace filename tokens (%f, %b) in pattern\n      function replaceFilenameTokens(pattern, next) {\n        if (pattern.match(/%[bf]/)) {\n          if (typeof source !== 'string') {\n            return next(new Error('Cannot replace %f or %b when using an input stream'));\n          }\n\n          pattern = pattern\n            .replace(/%f/g, path.basename(source))\n            .replace(/%b/g, path.basename(source, path.extname(source)));\n        }\n\n        next(null, pattern);\n      },\n\n      // Compute size if needed\n      function getSize(pattern, next) {\n        if (pattern.match(/%[whr]/)) {\n          if (fixedSize) {\n            return next(null, pattern, fixedSize[1], fixedSize[2]);\n          }\n\n          getMetadata(function(err, meta) {\n            if (err) {\n              return next(new Error('Could not determine video resolution to replace %w, %h or %r'));\n            }\n\n            var vstream = meta.streams.reduce(function(biggest, stream) {\n              if (stream.codec_type === 'video' && stream.width * stream.height > biggest.width * biggest.height) {\n                return stream;\n              } else {\n                return biggest;\n              }\n            }, { width: 0, height: 0 });\n\n            if (vstream.width === 0) {\n              return next(new Error('No video stream in input, cannot replace %w, %h or %r'));\n            }\n\n            var width = vstream.width;\n            var height = vstream.height;\n\n            if (fixedWidth) {\n              height = height * Number(fixedWidth[1]) / width;\n              width = Number(fixedWidth[1]);\n            } else if (fixedHeight) {\n              width = width * Number(fixedHeight[1]) / height;\n              height = Number(fixedHeight[1]);\n            } else if (percentSize) {\n              width = width * Number(percentSize[1]) / 100;\n              height = height * Number(percentSize[1]) / 100;\n            }\n\n            next(null, pattern, Math.round(width / 2) * 2, Math.round(height / 2) * 2);\n          });\n        } else {\n          next(null, pattern, -1, -1);\n        }\n      },\n\n      // Replace size tokens (%w, %h, %r) in pattern\n      function replaceSizeTokens(pattern, width, height, next) {\n        pattern = pattern\n          .replace(/%r/g, '%wx%h')\n          .replace(/%w/g, width)\n          .replace(/%h/g, height);\n\n        next(null, pattern);\n      },\n\n      // Replace variable tokens in pattern (%s, %i) and generate filename list\n      function replaceVariableTokens(pattern, next) {\n        var filenames = config.timemarks.map(function(t, i) {\n          return pattern\n            .replace(/%s/g, utils.timemarkToSeconds(t))\n            .replace(/%(0*)i/g, function(match, padding) {\n              var idx = '' + (i + 1);\n              return padding.substr(0, Math.max(0, padding.length + 1 - idx.length)) + idx;\n            });\n        });\n\n        self.emit('filenames', filenames);\n        next(null, filenames);\n      },\n\n      // Create output directory\n      function createDirectory(filenames, next) {\n        fs.exists(config.folder, function(exists) {\n          if (!exists) {\n            fs.mkdir(config.folder, function(err) {\n              if (err) {\n                next(err);\n              } else {\n                next(null, filenames);\n              }\n            });\n          } else {\n            next(null, filenames);\n          }\n        });\n      }\n    ], function runCommand(err, filenames) {\n      if (err) {\n        return self.emit('error', err);\n      }\n\n      var count = config.timemarks.length;\n      var split;\n      var filters = [split = {\n        filter: 'split',\n        options: count,\n        outputs: []\n      }];\n\n      if ('size' in config) {\n        // Set size to generate size filters\n        self.size(config.size);\n\n        // Get size filters and chain them with 'sizeN' stream names\n        var sizeFilters =  self._currentOutput.sizeFilters.get().map(function(f, i) {\n          if (i > 0) {\n            f.inputs = 'size' + (i - 1);\n          }\n\n          f.outputs = 'size' + i;\n\n          return f;\n        });\n\n        // Input last size filter output into split filter\n        split.inputs = 'size' + (sizeFilters.length - 1);\n\n        // Add size filters in front of split filter\n        filters = sizeFilters.concat(filters);\n\n        // Remove size filters\n        self._currentOutput.sizeFilters.clear();\n      }\n\n      var first = 0;\n      for (var i = 0; i < count; i++) {\n        var stream = 'screen' + i;\n        split.outputs.push(stream);\n\n        if (i === 0) {\n          first = config.timemarks[i];\n          self.seekInput(first);\n        }\n\n        self.output(path.join(config.folder, filenames[i]))\n          .frames(1)\n          .map(stream);\n\n        if (i > 0) {\n          self.seek(config.timemarks[i] - first);\n        }\n      }\n\n      self.complexFilter(filters);\n      self.run();\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Merge (concatenate) inputs to a single file\n   *\n   * @method FfmpegCommand#concat\n   * @category Processing\n   * @aliases concatenate,mergeToFile\n   *\n   * @param {String|Writable} target output file or writable stream\n   * @param {Object} [options] pipe options (only used when outputting to a writable stream)\n   * @return FfmpegCommand\n   */\n  proto.mergeToFile =\n  proto.concatenate =\n  proto.concat = function(target, options) {\n    // Find out which streams are present in the first non-stream input\n    var fileInput = this._inputs.filter(function(input) {\n      return !input.isStream;\n    })[0];\n\n    var self = this;\n    this.ffprobe(this._inputs.indexOf(fileInput), function(err, data) {\n      if (err) {\n        return self.emit('error', err);\n      }\n\n      var hasAudioStreams = data.streams.some(function(stream) {\n        return stream.codec_type === 'audio';\n      });\n\n      var hasVideoStreams = data.streams.some(function(stream) {\n        return stream.codec_type === 'video';\n      });\n\n      // Setup concat filter and start processing\n      self.output(target, options)\n        .complexFilter({\n          filter: 'concat',\n          options: {\n            n: self._inputs.length,\n            v: hasVideoStreams ? 1 : 0,\n            a: hasAudioStreams ? 1 : 0\n          }\n        })\n        .run();\n    });\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar path = require('path');\nvar util = require('util');\nvar EventEmitter = require('events').EventEmitter;\n\nvar utils = require('./utils');\nvar ARGLISTS = ['_global', '_audio', '_audioFilters', '_video', '_videoFilters', '_sizeFilters', '_complexFilters'];\n\n\n/**\n * Create an ffmpeg command\n *\n * Can be called with or without the 'new' operator, and the 'input' parameter\n * may be specified as 'options.source' instead (or passed later with the\n * addInput method).\n *\n * @constructor\n * @param {String|ReadableStream} [input] input file path or readable stream\n * @param {Object} [options] command options\n * @param {Object} [options.logger=<no logging>] logger object with 'error', 'warning', 'info' and 'debug' methods\n * @param {Number} [options.niceness=0] ffmpeg process niceness, ignored on Windows\n * @param {Number} [options.priority=0] alias for `niceness`\n * @param {String} [options.presets=\"fluent-ffmpeg/lib/presets\"] directory to load presets from\n * @param {String} [options.preset=\"fluent-ffmpeg/lib/presets\"] alias for `presets`\n * @param {String} [options.stdoutLines=100] maximum lines of ffmpeg output to keep in memory, use 0 for unlimited\n * @param {Number} [options.timeout=<no timeout>] ffmpeg processing timeout in seconds\n * @param {String|ReadableStream} [options.source=<no input>] alias for the `input` parameter\n */\nfunction FfmpegCommand(input, options) {\n  // Make 'new' optional\n  if (!(this instanceof FfmpegCommand)) {\n    return new FfmpegCommand(input, options);\n  }\n\n  EventEmitter.call(this);\n\n  if (typeof input === 'object' && !('readable' in input)) {\n    // Options object passed directly\n    options = input;\n  } else {\n    // Input passed first\n    options = options || {};\n    options.source = input;\n  }\n\n  // Add input if present\n  this._inputs = [];\n  if (options.source) {\n    this.input(options.source);\n  }\n\n  // Add target-less output for backwards compatibility\n  this._outputs = [];\n  this.output();\n\n  // Create argument lists\n  var self = this;\n  ['_global', '_complexFilters'].forEach(function(prop) {\n    self[prop] = utils.args();\n  });\n\n  // Set default option values\n  options.stdoutLines = 'stdoutLines' in options ? options.stdoutLines : 100;\n  options.presets = options.presets || options.preset || path.join(__dirname, 'presets');\n  options.niceness = options.niceness || options.priority || 0;\n\n  // Save options\n  this.options = options;\n\n  // Setup logger\n  this.logger = options.logger || {\n    debug: function() {},\n    info: function() {},\n    warn: function() {},\n    error: function() {}\n  };\n}\nutil.inherits(FfmpegCommand, EventEmitter);\nmodule.exports = FfmpegCommand;\n\n\n/**\n * Clone an ffmpeg command\n *\n * This method is useful when you want to process the same input multiple times.\n * It returns a new FfmpegCommand instance with the exact same options.\n *\n * All options set _after_ the clone() call will only be applied to the instance\n * it has been called on.\n *\n * @example\n *   var command = ffmpeg('/path/to/source.avi')\n *     .audioCodec('libfaac')\n *     .videoCodec('libx264')\n *     .format('mp4');\n *\n *   command.clone()\n *     .size('320x200')\n *     .save('/path/to/output-small.mp4');\n *\n *   command.clone()\n *     .size('640x400')\n *     .save('/path/to/output-medium.mp4');\n *\n *   command.save('/path/to/output-original-size.mp4');\n *\n * @method FfmpegCommand#clone\n * @return FfmpegCommand\n */\nFfmpegCommand.prototype.clone = function() {\n  var clone = new FfmpegCommand();\n  var self = this;\n\n  // Clone options and logger\n  clone.options = this.options;\n  clone.logger = this.logger;\n\n  // Clone inputs\n  clone._inputs = this._inputs.map(function(input) {\n    return {\n      source: input.source,\n      options: input.options.clone()\n    };\n  });\n\n  // Create first output\n  if ('target' in this._outputs[0]) {\n    // We have outputs set, don't clone them and create first output\n    clone._outputs = [];\n    clone.output();\n  } else {\n    // No outputs set, clone first output options\n    clone._outputs = [\n      clone._currentOutput = {\n        flags: {}\n      }\n    ];\n\n    ['audio', 'audioFilters', 'video', 'videoFilters', 'sizeFilters', 'options'].forEach(function(key) {\n      clone._currentOutput[key] = self._currentOutput[key].clone();\n    });\n\n    if (this._currentOutput.sizeData) {\n      clone._currentOutput.sizeData = {};\n      utils.copy(this._currentOutput.sizeData, clone._currentOutput.sizeData);\n    }\n\n    utils.copy(this._currentOutput.flags, clone._currentOutput.flags);\n  }\n\n  // Clone argument lists\n  ['_global', '_complexFilters'].forEach(function(prop) {\n    clone[prop] = self[prop].clone();\n  });\n\n  return clone;\n};\n\n\n/* Add methods from options submodules */\n\nrequire('./options/inputs')(FfmpegCommand.prototype);\nrequire('./options/audio')(FfmpegCommand.prototype);\nrequire('./options/video')(FfmpegCommand.prototype);\nrequire('./options/videosize')(FfmpegCommand.prototype);\nrequire('./options/output')(FfmpegCommand.prototype);\nrequire('./options/custom')(FfmpegCommand.prototype);\nrequire('./options/misc')(FfmpegCommand.prototype);\n\n\n/* Add processor methods */\n\nrequire('./processor')(FfmpegCommand.prototype);\n\n\n/* Add capabilities methods */\n\nrequire('./capabilities')(FfmpegCommand.prototype);\n\nFfmpegCommand.setFfmpegPath = function(path) {\n  (new FfmpegCommand()).setFfmpegPath(path);\n};\n\nFfmpegCommand.setFfprobePath = function(path) {\n  (new FfmpegCommand()).setFfprobePath(path);\n};\n\nFfmpegCommand.setFlvtoolPath = function(path) {\n  (new FfmpegCommand()).setFlvtoolPath(path);\n};\n\nFfmpegCommand.availableFilters =\nFfmpegCommand.getAvailableFilters = function(callback) {\n  (new FfmpegCommand()).availableFilters(callback);\n};\n\nFfmpegCommand.availableCodecs =\nFfmpegCommand.getAvailableCodecs = function(callback) {\n  (new FfmpegCommand()).availableCodecs(callback);\n};\n\nFfmpegCommand.availableFormats =\nFfmpegCommand.getAvailableFormats = function(callback) {\n  (new FfmpegCommand()).availableFormats(callback);\n};\n\nFfmpegCommand.availableEncoders =\nFfmpegCommand.getAvailableEncoders = function(callback) {\n  (new FfmpegCommand()).availableEncoders(callback);\n};\n\n\n/* Add ffprobe methods */\n\nrequire('./ffprobe')(FfmpegCommand.prototype);\n\nFfmpegCommand.ffprobe = function(file) {\n  var instance = new FfmpegCommand(file);\n  instance.ffprobe.apply(instance, Array.prototype.slice.call(arguments, 1));\n};\n\n/* Add processing recipes */\n\nrequire('./recipes')(FfmpegCommand.prototype);\n","module.exports = require('./lib/fluent-ffmpeg');\n","/**\n * File Cleanup Utility for ClipVault\n * Handles permanent deletion (bypassing recycle bin) and cache management\n */\n\nimport { unlink, readdir, stat, rmdir } from 'fs/promises'\nimport { existsSync } from 'fs'\nimport { join, basename, extname } from 'path'\n\n/**\n * Permanently delete a file (bypasses recycle bin on Windows)\n * Uses Node.js fs.unlink which performs permanent deletion\n */\nexport async function permanentDelete(filePath: string): Promise<boolean> {\n  try {\n    if (!existsSync(filePath)) {\n      return true // Already deleted\n    }\n    \n    await unlink(filePath)\n    console.log(`[Cleanup] Permanently deleted: ${filePath}`)\n    return true\n  } catch (error) {\n    console.error(`[Cleanup] Failed to delete ${filePath}:`, error)\n    return false\n  }\n}\n\n/**\n * Delete all cache files associated with a clip\n * - Thumbnail (.jpg)\n * - Audio tracks (.m4a)\n */\nexport async function deleteClipCache(\n  clipId: string,\n  thumbnailsPath: string\n): Promise<boolean> {\n  let success = true\n  \n  try {\n    // Delete thumbnail\n    const thumbnailPath = join(thumbnailsPath, `${clipId}.jpg`)\n    if (existsSync(thumbnailPath)) {\n      const thumbDeleted = await permanentDelete(thumbnailPath)\n      if (!thumbDeleted) success = false\n    }\n    \n    // Delete audio cache files\n    const audioCachePath = join(thumbnailsPath, 'audio')\n    const track1Path = join(audioCachePath, `${clipId}_track1.m4a`)\n    const track2Path = join(audioCachePath, `${clipId}_track2.m4a`)\n    \n    if (existsSync(track1Path)) {\n      const t1Deleted = await permanentDelete(track1Path)\n      if (!t1Deleted) success = false\n    }\n    \n    if (existsSync(track2Path)) {\n      const t2Deleted = await permanentDelete(track2Path)\n      if (!t2Deleted) success = false\n    }\n    \n    return success\n  } catch (error) {\n    console.error(`[Cleanup] Error deleting cache for clip ${clipId}:`, error)\n    return false\n  }\n}\n\n/**\n * Clean up orphaned cache files (thumbnails/audio for clips that no longer exist)\n * This should be called periodically or on app startup\n */\nexport async function cleanupOrphanedCache(\n  clipsPath: string,\n  thumbnailsPath: string\n): Promise<{ deletedCount: number; errors: string[] }> {\n  const result = { deletedCount: 0, errors: [] as string[] }\n  \n  try {\n    // Get list of valid clip IDs from the clips directory\n    const clipFiles = await readdir(clipsPath)\n    const validClipIds = new Set(\n      clipFiles\n        .filter(f => f.endsWith('.mp4'))\n        .map(f => basename(f, extname(f)).split('_')[0]) // Extract clip ID from filename\n    )\n    \n    // Clean up orphaned thumbnails\n    if (existsSync(thumbnailsPath)) {\n      const thumbFiles = await readdir(thumbnailsPath)\n      for (const thumbFile of thumbFiles) {\n        if (!thumbFile.endsWith('.jpg')) continue\n        \n        const clipId = basename(thumbFile, '.jpg')\n        if (!validClipIds.has(clipId)) {\n          const thumbPath = join(thumbnailsPath, thumbFile)\n          const deleted = await permanentDelete(thumbPath)\n          if (deleted) {\n            result.deletedCount++\n            console.log(`[Cleanup] Deleted orphaned thumbnail: ${thumbFile}`)\n          } else {\n            result.errors.push(`Failed to delete thumbnail: ${thumbFile}`)\n          }\n        }\n      }\n    }\n    \n    // Clean up orphaned audio cache\n    const audioCachePath = join(thumbnailsPath, 'audio')\n    if (existsSync(audioCachePath)) {\n      const audioFiles = await readdir(audioCachePath)\n      for (const audioFile of audioFiles) {\n        if (!audioFile.endsWith('.m4a')) continue\n        \n        // Extract clip ID from filename like \"{clipId}_track1.m4a\"\n        const clipId = audioFile.split('_')[0]\n        if (!validClipIds.has(clipId)) {\n          const audioPath = join(audioCachePath, audioFile)\n          const deleted = await permanentDelete(audioPath)\n          if (deleted) {\n            result.deletedCount++\n            console.log(`[Cleanup] Deleted orphaned audio cache: ${audioFile}`)\n          } else {\n            result.errors.push(`Failed to delete audio cache: ${audioFile}`)\n          }\n        }\n      }\n    }\n    \n    console.log(`[Cleanup] Orphaned cache cleanup complete. Deleted ${result.deletedCount} files.`)\n    return result\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : String(error)\n    console.error('[Cleanup] Error during orphaned cache cleanup:', error)\n    result.errors.push(errorMsg)\n    return result\n  }\n}\n\n/**\n * Get cache storage statistics\n */\nexport async function getCacheStats(thumbnailsPath: string): Promise<{\n  thumbnailCount: number\n  thumbnailSize: number\n  audioCount: number\n  audioSize: number\n  totalSize: number\n}> {\n  const stats = {\n    thumbnailCount: 0,\n    thumbnailSize: 0,\n    audioCount: 0,\n    audioSize: 0,\n    totalSize: 0\n  }\n  \n  try {\n    // Calculate thumbnails\n    if (existsSync(thumbnailsPath)) {\n      const thumbFiles = await readdir(thumbnailsPath)\n      for (const file of thumbFiles) {\n        if (file.endsWith('.jpg')) {\n          const filePath = join(thumbnailsPath, file)\n          const fileStat = await stat(filePath)\n          stats.thumbnailCount++\n          stats.thumbnailSize += fileStat.size\n        }\n      }\n    }\n    \n    // Calculate audio cache\n    const audioCachePath = join(thumbnailsPath, 'audio')\n    if (existsSync(audioCachePath)) {\n      const audioFiles = await readdir(audioCachePath)\n      for (const file of audioFiles) {\n        if (file.endsWith('.m4a')) {\n          const filePath = join(audioCachePath, file)\n          const fileStat = await stat(filePath)\n          stats.audioCount++\n          stats.audioSize += fileStat.size\n        }\n      }\n    }\n    \n    stats.totalSize = stats.thumbnailSize + stats.audioSize\n    return stats\n  } catch (error) {\n    console.error('[Cleanup] Error getting cache stats:', error)\n    return stats\n  }\n}\n\n/**\n * Format bytes to human readable string\n */\nexport function formatBytes(bytes: number): string {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB', 'TB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n","'use strict';\n\nconst path = require('path');\nconst WIN_SLASH = '\\\\\\\\/';\nconst WIN_NO_SLASH = `[^${WIN_SLASH}]`;\n\n/**\n * Posix glob regex\n */\n\nconst DOT_LITERAL = '\\\\.';\nconst PLUS_LITERAL = '\\\\+';\nconst QMARK_LITERAL = '\\\\?';\nconst SLASH_LITERAL = '\\\\/';\nconst ONE_CHAR = '(?=.)';\nconst QMARK = '[^/]';\nconst END_ANCHOR = `(?:${SLASH_LITERAL}|$)`;\nconst START_ANCHOR = `(?:^|${SLASH_LITERAL})`;\nconst DOTS_SLASH = `${DOT_LITERAL}{1,2}${END_ANCHOR}`;\nconst NO_DOT = `(?!${DOT_LITERAL})`;\nconst NO_DOTS = `(?!${START_ANCHOR}${DOTS_SLASH})`;\nconst NO_DOT_SLASH = `(?!${DOT_LITERAL}{0,1}${END_ANCHOR})`;\nconst NO_DOTS_SLASH = `(?!${DOTS_SLASH})`;\nconst QMARK_NO_DOT = `[^.${SLASH_LITERAL}]`;\nconst STAR = `${QMARK}*?`;\n\nconst POSIX_CHARS = {\n  DOT_LITERAL,\n  PLUS_LITERAL,\n  QMARK_LITERAL,\n  SLASH_LITERAL,\n  ONE_CHAR,\n  QMARK,\n  END_ANCHOR,\n  DOTS_SLASH,\n  NO_DOT,\n  NO_DOTS,\n  NO_DOT_SLASH,\n  NO_DOTS_SLASH,\n  QMARK_NO_DOT,\n  STAR,\n  START_ANCHOR\n};\n\n/**\n * Windows glob regex\n */\n\nconst WINDOWS_CHARS = {\n  ...POSIX_CHARS,\n\n  SLASH_LITERAL: `[${WIN_SLASH}]`,\n  QMARK: WIN_NO_SLASH,\n  STAR: `${WIN_NO_SLASH}*?`,\n  DOTS_SLASH: `${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$)`,\n  NO_DOT: `(?!${DOT_LITERAL})`,\n  NO_DOTS: `(?!(?:^|[${WIN_SLASH}])${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  NO_DOT_SLASH: `(?!${DOT_LITERAL}{0,1}(?:[${WIN_SLASH}]|$))`,\n  NO_DOTS_SLASH: `(?!${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  QMARK_NO_DOT: `[^.${WIN_SLASH}]`,\n  START_ANCHOR: `(?:^|[${WIN_SLASH}])`,\n  END_ANCHOR: `(?:[${WIN_SLASH}]|$)`\n};\n\n/**\n * POSIX Bracket Regex\n */\n\nconst POSIX_REGEX_SOURCE = {\n  alnum: 'a-zA-Z0-9',\n  alpha: 'a-zA-Z',\n  ascii: '\\\\x00-\\\\x7F',\n  blank: ' \\\\t',\n  cntrl: '\\\\x00-\\\\x1F\\\\x7F',\n  digit: '0-9',\n  graph: '\\\\x21-\\\\x7E',\n  lower: 'a-z',\n  print: '\\\\x20-\\\\x7E ',\n  punct: '\\\\-!\"#$%&\\'()\\\\*+,./:;<=>?@[\\\\]^_`{|}~',\n  space: ' \\\\t\\\\r\\\\n\\\\v\\\\f',\n  upper: 'A-Z',\n  word: 'A-Za-z0-9_',\n  xdigit: 'A-Fa-f0-9'\n};\n\nmodule.exports = {\n  MAX_LENGTH: 1024 * 64,\n  POSIX_REGEX_SOURCE,\n\n  // regular expressions\n  REGEX_BACKSLASH: /\\\\(?![*+?^${}(|)[\\]])/g,\n  REGEX_NON_SPECIAL_CHARS: /^[^@![\\].,$*+?^{}()|\\\\/]+/,\n  REGEX_SPECIAL_CHARS: /[-*+?.^${}(|)[\\]]/,\n  REGEX_SPECIAL_CHARS_BACKREF: /(\\\\?)((\\W)(\\3*))/g,\n  REGEX_SPECIAL_CHARS_GLOBAL: /([-*+?.^${}(|)[\\]])/g,\n  REGEX_REMOVE_BACKSLASH: /(?:\\[.*?[^\\\\]\\]|\\\\(?=.))/g,\n\n  // Replace globs with equivalent patterns to reduce parsing time.\n  REPLACEMENTS: {\n    '***': '*',\n    '**/**': '**',\n    '**/**/**': '**'\n  },\n\n  // Digits\n  CHAR_0: 48, /* 0 */\n  CHAR_9: 57, /* 9 */\n\n  // Alphabet chars.\n  CHAR_UPPERCASE_A: 65, /* A */\n  CHAR_LOWERCASE_A: 97, /* a */\n  CHAR_UPPERCASE_Z: 90, /* Z */\n  CHAR_LOWERCASE_Z: 122, /* z */\n\n  CHAR_LEFT_PARENTHESES: 40, /* ( */\n  CHAR_RIGHT_PARENTHESES: 41, /* ) */\n\n  CHAR_ASTERISK: 42, /* * */\n\n  // Non-alphabetic chars.\n  CHAR_AMPERSAND: 38, /* & */\n  CHAR_AT: 64, /* @ */\n  CHAR_BACKWARD_SLASH: 92, /* \\ */\n  CHAR_CARRIAGE_RETURN: 13, /* \\r */\n  CHAR_CIRCUMFLEX_ACCENT: 94, /* ^ */\n  CHAR_COLON: 58, /* : */\n  CHAR_COMMA: 44, /* , */\n  CHAR_DOT: 46, /* . */\n  CHAR_DOUBLE_QUOTE: 34, /* \" */\n  CHAR_EQUAL: 61, /* = */\n  CHAR_EXCLAMATION_MARK: 33, /* ! */\n  CHAR_FORM_FEED: 12, /* \\f */\n  CHAR_FORWARD_SLASH: 47, /* / */\n  CHAR_GRAVE_ACCENT: 96, /* ` */\n  CHAR_HASH: 35, /* # */\n  CHAR_HYPHEN_MINUS: 45, /* - */\n  CHAR_LEFT_ANGLE_BRACKET: 60, /* < */\n  CHAR_LEFT_CURLY_BRACE: 123, /* { */\n  CHAR_LEFT_SQUARE_BRACKET: 91, /* [ */\n  CHAR_LINE_FEED: 10, /* \\n */\n  CHAR_NO_BREAK_SPACE: 160, /* \\u00A0 */\n  CHAR_PERCENT: 37, /* % */\n  CHAR_PLUS: 43, /* + */\n  CHAR_QUESTION_MARK: 63, /* ? */\n  CHAR_RIGHT_ANGLE_BRACKET: 62, /* > */\n  CHAR_RIGHT_CURLY_BRACE: 125, /* } */\n  CHAR_RIGHT_SQUARE_BRACKET: 93, /* ] */\n  CHAR_SEMICOLON: 59, /* ; */\n  CHAR_SINGLE_QUOTE: 39, /* ' */\n  CHAR_SPACE: 32, /*   */\n  CHAR_TAB: 9, /* \\t */\n  CHAR_UNDERSCORE: 95, /* _ */\n  CHAR_VERTICAL_LINE: 124, /* | */\n  CHAR_ZERO_WIDTH_NOBREAK_SPACE: 65279, /* \\uFEFF */\n\n  SEP: path.sep,\n\n  /**\n   * Create EXTGLOB_CHARS\n   */\n\n  extglobChars(chars) {\n    return {\n      '!': { type: 'negate', open: '(?:(?!(?:', close: `))${chars.STAR})` },\n      '?': { type: 'qmark', open: '(?:', close: ')?' },\n      '+': { type: 'plus', open: '(?:', close: ')+' },\n      '*': { type: 'star', open: '(?:', close: ')*' },\n      '@': { type: 'at', open: '(?:', close: ')' }\n    };\n  },\n\n  /**\n   * Create GLOB_CHARS\n   */\n\n  globChars(win32) {\n    return win32 === true ? WINDOWS_CHARS : POSIX_CHARS;\n  }\n};\n","'use strict';\n\nconst path = require('path');\nconst win32 = process.platform === 'win32';\nconst {\n  REGEX_BACKSLASH,\n  REGEX_REMOVE_BACKSLASH,\n  REGEX_SPECIAL_CHARS,\n  REGEX_SPECIAL_CHARS_GLOBAL\n} = require('./constants');\n\nexports.isObject = val => val !== null && typeof val === 'object' && !Array.isArray(val);\nexports.hasRegexChars = str => REGEX_SPECIAL_CHARS.test(str);\nexports.isRegexChar = str => str.length === 1 && exports.hasRegexChars(str);\nexports.escapeRegex = str => str.replace(REGEX_SPECIAL_CHARS_GLOBAL, '\\\\$1');\nexports.toPosixSlashes = str => str.replace(REGEX_BACKSLASH, '/');\n\nexports.removeBackslashes = str => {\n  return str.replace(REGEX_REMOVE_BACKSLASH, match => {\n    return match === '\\\\' ? '' : match;\n  });\n};\n\nexports.supportsLookbehinds = () => {\n  const segs = process.version.slice(1).split('.').map(Number);\n  if (segs.length === 3 && segs[0] >= 9 || (segs[0] === 8 && segs[1] >= 10)) {\n    return true;\n  }\n  return false;\n};\n\nexports.isWindows = options => {\n  if (options && typeof options.windows === 'boolean') {\n    return options.windows;\n  }\n  return win32 === true || path.sep === '\\\\';\n};\n\nexports.escapeLast = (input, char, lastIdx) => {\n  const idx = input.lastIndexOf(char, lastIdx);\n  if (idx === -1) return input;\n  if (input[idx - 1] === '\\\\') return exports.escapeLast(input, char, idx - 1);\n  return `${input.slice(0, idx)}\\\\${input.slice(idx)}`;\n};\n\nexports.removePrefix = (input, state = {}) => {\n  let output = input;\n  if (output.startsWith('./')) {\n    output = output.slice(2);\n    state.prefix = './';\n  }\n  return output;\n};\n\nexports.wrapOutput = (input, state = {}, options = {}) => {\n  const prepend = options.contains ? '' : '^';\n  const append = options.contains ? '' : '$';\n\n  let output = `${prepend}(?:${input})${append}`;\n  if (state.negated === true) {\n    output = `(?:^(?!${output}).*$)`;\n  }\n  return output;\n};\n","'use strict';\n\nconst utils = require('./utils');\nconst {\n  CHAR_ASTERISK,             /* * */\n  CHAR_AT,                   /* @ */\n  CHAR_BACKWARD_SLASH,       /* \\ */\n  CHAR_COMMA,                /* , */\n  CHAR_DOT,                  /* . */\n  CHAR_EXCLAMATION_MARK,     /* ! */\n  CHAR_FORWARD_SLASH,        /* / */\n  CHAR_LEFT_CURLY_BRACE,     /* { */\n  CHAR_LEFT_PARENTHESES,     /* ( */\n  CHAR_LEFT_SQUARE_BRACKET,  /* [ */\n  CHAR_PLUS,                 /* + */\n  CHAR_QUESTION_MARK,        /* ? */\n  CHAR_RIGHT_CURLY_BRACE,    /* } */\n  CHAR_RIGHT_PARENTHESES,    /* ) */\n  CHAR_RIGHT_SQUARE_BRACKET  /* ] */\n} = require('./constants');\n\nconst isPathSeparator = code => {\n  return code === CHAR_FORWARD_SLASH || code === CHAR_BACKWARD_SLASH;\n};\n\nconst depth = token => {\n  if (token.isPrefix !== true) {\n    token.depth = token.isGlobstar ? Infinity : 1;\n  }\n};\n\n/**\n * Quickly scans a glob pattern and returns an object with a handful of\n * useful properties, like `isGlob`, `path` (the leading non-glob, if it exists),\n * `glob` (the actual pattern), `negated` (true if the path starts with `!` but not\n * with `!(`) and `negatedExtglob` (true if the path starts with `!(`).\n *\n * ```js\n * const pm = require('picomatch');\n * console.log(pm.scan('foo/bar/*.js'));\n * { isGlob: true, input: 'foo/bar/*.js', base: 'foo/bar', glob: '*.js' }\n * ```\n * @param {String} `str`\n * @param {Object} `options`\n * @return {Object} Returns an object with tokens and regex source string.\n * @api public\n */\n\nconst scan = (input, options) => {\n  const opts = options || {};\n\n  const length = input.length - 1;\n  const scanToEnd = opts.parts === true || opts.scanToEnd === true;\n  const slashes = [];\n  const tokens = [];\n  const parts = [];\n\n  let str = input;\n  let index = -1;\n  let start = 0;\n  let lastIndex = 0;\n  let isBrace = false;\n  let isBracket = false;\n  let isGlob = false;\n  let isExtglob = false;\n  let isGlobstar = false;\n  let braceEscaped = false;\n  let backslashes = false;\n  let negated = false;\n  let negatedExtglob = false;\n  let finished = false;\n  let braces = 0;\n  let prev;\n  let code;\n  let token = { value: '', depth: 0, isGlob: false };\n\n  const eos = () => index >= length;\n  const peek = () => str.charCodeAt(index + 1);\n  const advance = () => {\n    prev = code;\n    return str.charCodeAt(++index);\n  };\n\n  while (index < length) {\n    code = advance();\n    let next;\n\n    if (code === CHAR_BACKWARD_SLASH) {\n      backslashes = token.backslashes = true;\n      code = advance();\n\n      if (code === CHAR_LEFT_CURLY_BRACE) {\n        braceEscaped = true;\n      }\n      continue;\n    }\n\n    if (braceEscaped === true || code === CHAR_LEFT_CURLY_BRACE) {\n      braces++;\n\n      while (eos() !== true && (code = advance())) {\n        if (code === CHAR_BACKWARD_SLASH) {\n          backslashes = token.backslashes = true;\n          advance();\n          continue;\n        }\n\n        if (code === CHAR_LEFT_CURLY_BRACE) {\n          braces++;\n          continue;\n        }\n\n        if (braceEscaped !== true && code === CHAR_DOT && (code = advance()) === CHAR_DOT) {\n          isBrace = token.isBrace = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n\n          if (scanToEnd === true) {\n            continue;\n          }\n\n          break;\n        }\n\n        if (braceEscaped !== true && code === CHAR_COMMA) {\n          isBrace = token.isBrace = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n\n          if (scanToEnd === true) {\n            continue;\n          }\n\n          break;\n        }\n\n        if (code === CHAR_RIGHT_CURLY_BRACE) {\n          braces--;\n\n          if (braces === 0) {\n            braceEscaped = false;\n            isBrace = token.isBrace = true;\n            finished = true;\n            break;\n          }\n        }\n      }\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n\n    if (code === CHAR_FORWARD_SLASH) {\n      slashes.push(index);\n      tokens.push(token);\n      token = { value: '', depth: 0, isGlob: false };\n\n      if (finished === true) continue;\n      if (prev === CHAR_DOT && index === (start + 1)) {\n        start += 2;\n        continue;\n      }\n\n      lastIndex = index + 1;\n      continue;\n    }\n\n    if (opts.noext !== true) {\n      const isExtglobChar = code === CHAR_PLUS\n        || code === CHAR_AT\n        || code === CHAR_ASTERISK\n        || code === CHAR_QUESTION_MARK\n        || code === CHAR_EXCLAMATION_MARK;\n\n      if (isExtglobChar === true && peek() === CHAR_LEFT_PARENTHESES) {\n        isGlob = token.isGlob = true;\n        isExtglob = token.isExtglob = true;\n        finished = true;\n        if (code === CHAR_EXCLAMATION_MARK && index === start) {\n          negatedExtglob = true;\n        }\n\n        if (scanToEnd === true) {\n          while (eos() !== true && (code = advance())) {\n            if (code === CHAR_BACKWARD_SLASH) {\n              backslashes = token.backslashes = true;\n              code = advance();\n              continue;\n            }\n\n            if (code === CHAR_RIGHT_PARENTHESES) {\n              isGlob = token.isGlob = true;\n              finished = true;\n              break;\n            }\n          }\n          continue;\n        }\n        break;\n      }\n    }\n\n    if (code === CHAR_ASTERISK) {\n      if (prev === CHAR_ASTERISK) isGlobstar = token.isGlobstar = true;\n      isGlob = token.isGlob = true;\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n      break;\n    }\n\n    if (code === CHAR_QUESTION_MARK) {\n      isGlob = token.isGlob = true;\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n      break;\n    }\n\n    if (code === CHAR_LEFT_SQUARE_BRACKET) {\n      while (eos() !== true && (next = advance())) {\n        if (next === CHAR_BACKWARD_SLASH) {\n          backslashes = token.backslashes = true;\n          advance();\n          continue;\n        }\n\n        if (next === CHAR_RIGHT_SQUARE_BRACKET) {\n          isBracket = token.isBracket = true;\n          isGlob = token.isGlob = true;\n          finished = true;\n          break;\n        }\n      }\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n\n    if (opts.nonegate !== true && code === CHAR_EXCLAMATION_MARK && index === start) {\n      negated = token.negated = true;\n      start++;\n      continue;\n    }\n\n    if (opts.noparen !== true && code === CHAR_LEFT_PARENTHESES) {\n      isGlob = token.isGlob = true;\n\n      if (scanToEnd === true) {\n        while (eos() !== true && (code = advance())) {\n          if (code === CHAR_LEFT_PARENTHESES) {\n            backslashes = token.backslashes = true;\n            code = advance();\n            continue;\n          }\n\n          if (code === CHAR_RIGHT_PARENTHESES) {\n            finished = true;\n            break;\n          }\n        }\n        continue;\n      }\n      break;\n    }\n\n    if (isGlob === true) {\n      finished = true;\n\n      if (scanToEnd === true) {\n        continue;\n      }\n\n      break;\n    }\n  }\n\n  if (opts.noext === true) {\n    isExtglob = false;\n    isGlob = false;\n  }\n\n  let base = str;\n  let prefix = '';\n  let glob = '';\n\n  if (start > 0) {\n    prefix = str.slice(0, start);\n    str = str.slice(start);\n    lastIndex -= start;\n  }\n\n  if (base && isGlob === true && lastIndex > 0) {\n    base = str.slice(0, lastIndex);\n    glob = str.slice(lastIndex);\n  } else if (isGlob === true) {\n    base = '';\n    glob = str;\n  } else {\n    base = str;\n  }\n\n  if (base && base !== '' && base !== '/' && base !== str) {\n    if (isPathSeparator(base.charCodeAt(base.length - 1))) {\n      base = base.slice(0, -1);\n    }\n  }\n\n  if (opts.unescape === true) {\n    if (glob) glob = utils.removeBackslashes(glob);\n\n    if (base && backslashes === true) {\n      base = utils.removeBackslashes(base);\n    }\n  }\n\n  const state = {\n    prefix,\n    input,\n    start,\n    base,\n    glob,\n    isBrace,\n    isBracket,\n    isGlob,\n    isExtglob,\n    isGlobstar,\n    negated,\n    negatedExtglob\n  };\n\n  if (opts.tokens === true) {\n    state.maxDepth = 0;\n    if (!isPathSeparator(code)) {\n      tokens.push(token);\n    }\n    state.tokens = tokens;\n  }\n\n  if (opts.parts === true || opts.tokens === true) {\n    let prevIndex;\n\n    for (let idx = 0; idx < slashes.length; idx++) {\n      const n = prevIndex ? prevIndex + 1 : start;\n      const i = slashes[idx];\n      const value = input.slice(n, i);\n      if (opts.tokens) {\n        if (idx === 0 && start !== 0) {\n          tokens[idx].isPrefix = true;\n          tokens[idx].value = prefix;\n        } else {\n          tokens[idx].value = value;\n        }\n        depth(tokens[idx]);\n        state.maxDepth += tokens[idx].depth;\n      }\n      if (idx !== 0 || value !== '') {\n        parts.push(value);\n      }\n      prevIndex = i;\n    }\n\n    if (prevIndex && prevIndex + 1 < input.length) {\n      const value = input.slice(prevIndex + 1);\n      parts.push(value);\n\n      if (opts.tokens) {\n        tokens[tokens.length - 1].value = value;\n        depth(tokens[tokens.length - 1]);\n        state.maxDepth += tokens[tokens.length - 1].depth;\n      }\n    }\n\n    state.slashes = slashes;\n    state.parts = parts;\n  }\n\n  return state;\n};\n\nmodule.exports = scan;\n","'use strict';\n\nconst constants = require('./constants');\nconst utils = require('./utils');\n\n/**\n * Constants\n */\n\nconst {\n  MAX_LENGTH,\n  POSIX_REGEX_SOURCE,\n  REGEX_NON_SPECIAL_CHARS,\n  REGEX_SPECIAL_CHARS_BACKREF,\n  REPLACEMENTS\n} = constants;\n\n/**\n * Helpers\n */\n\nconst expandRange = (args, options) => {\n  if (typeof options.expandRange === 'function') {\n    return options.expandRange(...args, options);\n  }\n\n  args.sort();\n  const value = `[${args.join('-')}]`;\n\n  try {\n    /* eslint-disable-next-line no-new */\n    new RegExp(value);\n  } catch (ex) {\n    return args.map(v => utils.escapeRegex(v)).join('..');\n  }\n\n  return value;\n};\n\n/**\n * Create the message for a syntax error\n */\n\nconst syntaxError = (type, char) => {\n  return `Missing ${type}: \"${char}\" - use \"\\\\\\\\${char}\" to match literal characters`;\n};\n\n/**\n * Parse the given input string.\n * @param {String} input\n * @param {Object} options\n * @return {Object}\n */\n\nconst parse = (input, options) => {\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n\n  input = REPLACEMENTS[input] || input;\n\n  const opts = { ...options };\n  const max = typeof opts.maxLength === 'number' ? Math.min(MAX_LENGTH, opts.maxLength) : MAX_LENGTH;\n\n  let len = input.length;\n  if (len > max) {\n    throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`);\n  }\n\n  const bos = { type: 'bos', value: '', output: opts.prepend || '' };\n  const tokens = [bos];\n\n  const capture = opts.capture ? '' : '?:';\n  const win32 = utils.isWindows(options);\n\n  // create constants based on platform, for windows or posix\n  const PLATFORM_CHARS = constants.globChars(win32);\n  const EXTGLOB_CHARS = constants.extglobChars(PLATFORM_CHARS);\n\n  const {\n    DOT_LITERAL,\n    PLUS_LITERAL,\n    SLASH_LITERAL,\n    ONE_CHAR,\n    DOTS_SLASH,\n    NO_DOT,\n    NO_DOT_SLASH,\n    NO_DOTS_SLASH,\n    QMARK,\n    QMARK_NO_DOT,\n    STAR,\n    START_ANCHOR\n  } = PLATFORM_CHARS;\n\n  const globstar = opts => {\n    return `(${capture}(?:(?!${START_ANCHOR}${opts.dot ? DOTS_SLASH : DOT_LITERAL}).)*?)`;\n  };\n\n  const nodot = opts.dot ? '' : NO_DOT;\n  const qmarkNoDot = opts.dot ? QMARK : QMARK_NO_DOT;\n  let star = opts.bash === true ? globstar(opts) : STAR;\n\n  if (opts.capture) {\n    star = `(${star})`;\n  }\n\n  // minimatch options support\n  if (typeof opts.noext === 'boolean') {\n    opts.noextglob = opts.noext;\n  }\n\n  const state = {\n    input,\n    index: -1,\n    start: 0,\n    dot: opts.dot === true,\n    consumed: '',\n    output: '',\n    prefix: '',\n    backtrack: false,\n    negated: false,\n    brackets: 0,\n    braces: 0,\n    parens: 0,\n    quotes: 0,\n    globstar: false,\n    tokens\n  };\n\n  input = utils.removePrefix(input, state);\n  len = input.length;\n\n  const extglobs = [];\n  const braces = [];\n  const stack = [];\n  let prev = bos;\n  let value;\n\n  /**\n   * Tokenizing helpers\n   */\n\n  const eos = () => state.index === len - 1;\n  const peek = state.peek = (n = 1) => input[state.index + n];\n  const advance = state.advance = () => input[++state.index] || '';\n  const remaining = () => input.slice(state.index + 1);\n  const consume = (value = '', num = 0) => {\n    state.consumed += value;\n    state.index += num;\n  };\n\n  const append = token => {\n    state.output += token.output != null ? token.output : token.value;\n    consume(token.value);\n  };\n\n  const negate = () => {\n    let count = 1;\n\n    while (peek() === '!' && (peek(2) !== '(' || peek(3) === '?')) {\n      advance();\n      state.start++;\n      count++;\n    }\n\n    if (count % 2 === 0) {\n      return false;\n    }\n\n    state.negated = true;\n    state.start++;\n    return true;\n  };\n\n  const increment = type => {\n    state[type]++;\n    stack.push(type);\n  };\n\n  const decrement = type => {\n    state[type]--;\n    stack.pop();\n  };\n\n  /**\n   * Push tokens onto the tokens array. This helper speeds up\n   * tokenizing by 1) helping us avoid backtracking as much as possible,\n   * and 2) helping us avoid creating extra tokens when consecutive\n   * characters are plain text. This improves performance and simplifies\n   * lookbehinds.\n   */\n\n  const push = tok => {\n    if (prev.type === 'globstar') {\n      const isBrace = state.braces > 0 && (tok.type === 'comma' || tok.type === 'brace');\n      const isExtglob = tok.extglob === true || (extglobs.length && (tok.type === 'pipe' || tok.type === 'paren'));\n\n      if (tok.type !== 'slash' && tok.type !== 'paren' && !isBrace && !isExtglob) {\n        state.output = state.output.slice(0, -prev.output.length);\n        prev.type = 'star';\n        prev.value = '*';\n        prev.output = star;\n        state.output += prev.output;\n      }\n    }\n\n    if (extglobs.length && tok.type !== 'paren') {\n      extglobs[extglobs.length - 1].inner += tok.value;\n    }\n\n    if (tok.value || tok.output) append(tok);\n    if (prev && prev.type === 'text' && tok.type === 'text') {\n      prev.value += tok.value;\n      prev.output = (prev.output || '') + tok.value;\n      return;\n    }\n\n    tok.prev = prev;\n    tokens.push(tok);\n    prev = tok;\n  };\n\n  const extglobOpen = (type, value) => {\n    const token = { ...EXTGLOB_CHARS[value], conditions: 1, inner: '' };\n\n    token.prev = prev;\n    token.parens = state.parens;\n    token.output = state.output;\n    const output = (opts.capture ? '(' : '') + token.open;\n\n    increment('parens');\n    push({ type, value, output: state.output ? '' : ONE_CHAR });\n    push({ type: 'paren', extglob: true, value: advance(), output });\n    extglobs.push(token);\n  };\n\n  const extglobClose = token => {\n    let output = token.close + (opts.capture ? ')' : '');\n    let rest;\n\n    if (token.type === 'negate') {\n      let extglobStar = star;\n\n      if (token.inner && token.inner.length > 1 && token.inner.includes('/')) {\n        extglobStar = globstar(opts);\n      }\n\n      if (extglobStar !== star || eos() || /^\\)+$/.test(remaining())) {\n        output = token.close = `)$))${extglobStar}`;\n      }\n\n      if (token.inner.includes('*') && (rest = remaining()) && /^\\.[^\\\\/.]+$/.test(rest)) {\n        // Any non-magical string (`.ts`) or even nested expression (`.{ts,tsx}`) can follow after the closing parenthesis.\n        // In this case, we need to parse the string and use it in the output of the original pattern.\n        // Suitable patterns: `/!(*.d).ts`, `/!(*.d).{ts,tsx}`, `**/!(*-dbg).@(js)`.\n        //\n        // Disabling the `fastpaths` option due to a problem with parsing strings as `.ts` in the pattern like `**/!(*.d).ts`.\n        const expression = parse(rest, { ...options, fastpaths: false }).output;\n\n        output = token.close = `)${expression})${extglobStar})`;\n      }\n\n      if (token.prev.type === 'bos') {\n        state.negatedExtglob = true;\n      }\n    }\n\n    push({ type: 'paren', extglob: true, value, output });\n    decrement('parens');\n  };\n\n  /**\n   * Fast paths\n   */\n\n  if (opts.fastpaths !== false && !/(^[*!]|[/()[\\]{}\"])/.test(input)) {\n    let backslashes = false;\n\n    let output = input.replace(REGEX_SPECIAL_CHARS_BACKREF, (m, esc, chars, first, rest, index) => {\n      if (first === '\\\\') {\n        backslashes = true;\n        return m;\n      }\n\n      if (first === '?') {\n        if (esc) {\n          return esc + first + (rest ? QMARK.repeat(rest.length) : '');\n        }\n        if (index === 0) {\n          return qmarkNoDot + (rest ? QMARK.repeat(rest.length) : '');\n        }\n        return QMARK.repeat(chars.length);\n      }\n\n      if (first === '.') {\n        return DOT_LITERAL.repeat(chars.length);\n      }\n\n      if (first === '*') {\n        if (esc) {\n          return esc + first + (rest ? star : '');\n        }\n        return star;\n      }\n      return esc ? m : `\\\\${m}`;\n    });\n\n    if (backslashes === true) {\n      if (opts.unescape === true) {\n        output = output.replace(/\\\\/g, '');\n      } else {\n        output = output.replace(/\\\\+/g, m => {\n          return m.length % 2 === 0 ? '\\\\\\\\' : (m ? '\\\\' : '');\n        });\n      }\n    }\n\n    if (output === input && opts.contains === true) {\n      state.output = input;\n      return state;\n    }\n\n    state.output = utils.wrapOutput(output, state, options);\n    return state;\n  }\n\n  /**\n   * Tokenize input until we reach end-of-string\n   */\n\n  while (!eos()) {\n    value = advance();\n\n    if (value === '\\u0000') {\n      continue;\n    }\n\n    /**\n     * Escaped characters\n     */\n\n    if (value === '\\\\') {\n      const next = peek();\n\n      if (next === '/' && opts.bash !== true) {\n        continue;\n      }\n\n      if (next === '.' || next === ';') {\n        continue;\n      }\n\n      if (!next) {\n        value += '\\\\';\n        push({ type: 'text', value });\n        continue;\n      }\n\n      // collapse slashes to reduce potential for exploits\n      const match = /^\\\\+/.exec(remaining());\n      let slashes = 0;\n\n      if (match && match[0].length > 2) {\n        slashes = match[0].length;\n        state.index += slashes;\n        if (slashes % 2 !== 0) {\n          value += '\\\\';\n        }\n      }\n\n      if (opts.unescape === true) {\n        value = advance();\n      } else {\n        value += advance();\n      }\n\n      if (state.brackets === 0) {\n        push({ type: 'text', value });\n        continue;\n      }\n    }\n\n    /**\n     * If we're inside a regex character class, continue\n     * until we reach the closing bracket.\n     */\n\n    if (state.brackets > 0 && (value !== ']' || prev.value === '[' || prev.value === '[^')) {\n      if (opts.posix !== false && value === ':') {\n        const inner = prev.value.slice(1);\n        if (inner.includes('[')) {\n          prev.posix = true;\n\n          if (inner.includes(':')) {\n            const idx = prev.value.lastIndexOf('[');\n            const pre = prev.value.slice(0, idx);\n            const rest = prev.value.slice(idx + 2);\n            const posix = POSIX_REGEX_SOURCE[rest];\n            if (posix) {\n              prev.value = pre + posix;\n              state.backtrack = true;\n              advance();\n\n              if (!bos.output && tokens.indexOf(prev) === 1) {\n                bos.output = ONE_CHAR;\n              }\n              continue;\n            }\n          }\n        }\n      }\n\n      if ((value === '[' && peek() !== ':') || (value === '-' && peek() === ']')) {\n        value = `\\\\${value}`;\n      }\n\n      if (value === ']' && (prev.value === '[' || prev.value === '[^')) {\n        value = `\\\\${value}`;\n      }\n\n      if (opts.posix === true && value === '!' && prev.value === '[') {\n        value = '^';\n      }\n\n      prev.value += value;\n      append({ value });\n      continue;\n    }\n\n    /**\n     * If we're inside a quoted string, continue\n     * until we reach the closing double quote.\n     */\n\n    if (state.quotes === 1 && value !== '\"') {\n      value = utils.escapeRegex(value);\n      prev.value += value;\n      append({ value });\n      continue;\n    }\n\n    /**\n     * Double quotes\n     */\n\n    if (value === '\"') {\n      state.quotes = state.quotes === 1 ? 0 : 1;\n      if (opts.keepQuotes === true) {\n        push({ type: 'text', value });\n      }\n      continue;\n    }\n\n    /**\n     * Parentheses\n     */\n\n    if (value === '(') {\n      increment('parens');\n      push({ type: 'paren', value });\n      continue;\n    }\n\n    if (value === ')') {\n      if (state.parens === 0 && opts.strictBrackets === true) {\n        throw new SyntaxError(syntaxError('opening', '('));\n      }\n\n      const extglob = extglobs[extglobs.length - 1];\n      if (extglob && state.parens === extglob.parens + 1) {\n        extglobClose(extglobs.pop());\n        continue;\n      }\n\n      push({ type: 'paren', value, output: state.parens ? ')' : '\\\\)' });\n      decrement('parens');\n      continue;\n    }\n\n    /**\n     * Square brackets\n     */\n\n    if (value === '[') {\n      if (opts.nobracket === true || !remaining().includes(']')) {\n        if (opts.nobracket !== true && opts.strictBrackets === true) {\n          throw new SyntaxError(syntaxError('closing', ']'));\n        }\n\n        value = `\\\\${value}`;\n      } else {\n        increment('brackets');\n      }\n\n      push({ type: 'bracket', value });\n      continue;\n    }\n\n    if (value === ']') {\n      if (opts.nobracket === true || (prev && prev.type === 'bracket' && prev.value.length === 1)) {\n        push({ type: 'text', value, output: `\\\\${value}` });\n        continue;\n      }\n\n      if (state.brackets === 0) {\n        if (opts.strictBrackets === true) {\n          throw new SyntaxError(syntaxError('opening', '['));\n        }\n\n        push({ type: 'text', value, output: `\\\\${value}` });\n        continue;\n      }\n\n      decrement('brackets');\n\n      const prevValue = prev.value.slice(1);\n      if (prev.posix !== true && prevValue[0] === '^' && !prevValue.includes('/')) {\n        value = `/${value}`;\n      }\n\n      prev.value += value;\n      append({ value });\n\n      // when literal brackets are explicitly disabled\n      // assume we should match with a regex character class\n      if (opts.literalBrackets === false || utils.hasRegexChars(prevValue)) {\n        continue;\n      }\n\n      const escaped = utils.escapeRegex(prev.value);\n      state.output = state.output.slice(0, -prev.value.length);\n\n      // when literal brackets are explicitly enabled\n      // assume we should escape the brackets to match literal characters\n      if (opts.literalBrackets === true) {\n        state.output += escaped;\n        prev.value = escaped;\n        continue;\n      }\n\n      // when the user specifies nothing, try to match both\n      prev.value = `(${capture}${escaped}|${prev.value})`;\n      state.output += prev.value;\n      continue;\n    }\n\n    /**\n     * Braces\n     */\n\n    if (value === '{' && opts.nobrace !== true) {\n      increment('braces');\n\n      const open = {\n        type: 'brace',\n        value,\n        output: '(',\n        outputIndex: state.output.length,\n        tokensIndex: state.tokens.length\n      };\n\n      braces.push(open);\n      push(open);\n      continue;\n    }\n\n    if (value === '}') {\n      const brace = braces[braces.length - 1];\n\n      if (opts.nobrace === true || !brace) {\n        push({ type: 'text', value, output: value });\n        continue;\n      }\n\n      let output = ')';\n\n      if (brace.dots === true) {\n        const arr = tokens.slice();\n        const range = [];\n\n        for (let i = arr.length - 1; i >= 0; i--) {\n          tokens.pop();\n          if (arr[i].type === 'brace') {\n            break;\n          }\n          if (arr[i].type !== 'dots') {\n            range.unshift(arr[i].value);\n          }\n        }\n\n        output = expandRange(range, opts);\n        state.backtrack = true;\n      }\n\n      if (brace.comma !== true && brace.dots !== true) {\n        const out = state.output.slice(0, brace.outputIndex);\n        const toks = state.tokens.slice(brace.tokensIndex);\n        brace.value = brace.output = '\\\\{';\n        value = output = '\\\\}';\n        state.output = out;\n        for (const t of toks) {\n          state.output += (t.output || t.value);\n        }\n      }\n\n      push({ type: 'brace', value, output });\n      decrement('braces');\n      braces.pop();\n      continue;\n    }\n\n    /**\n     * Pipes\n     */\n\n    if (value === '|') {\n      if (extglobs.length > 0) {\n        extglobs[extglobs.length - 1].conditions++;\n      }\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Commas\n     */\n\n    if (value === ',') {\n      let output = value;\n\n      const brace = braces[braces.length - 1];\n      if (brace && stack[stack.length - 1] === 'braces') {\n        brace.comma = true;\n        output = '|';\n      }\n\n      push({ type: 'comma', value, output });\n      continue;\n    }\n\n    /**\n     * Slashes\n     */\n\n    if (value === '/') {\n      // if the beginning of the glob is \"./\", advance the start\n      // to the current index, and don't add the \"./\" characters\n      // to the state. This greatly simplifies lookbehinds when\n      // checking for BOS characters like \"!\" and \".\" (not \"./\")\n      if (prev.type === 'dot' && state.index === state.start + 1) {\n        state.start = state.index + 1;\n        state.consumed = '';\n        state.output = '';\n        tokens.pop();\n        prev = bos; // reset \"prev\" to the first token\n        continue;\n      }\n\n      push({ type: 'slash', value, output: SLASH_LITERAL });\n      continue;\n    }\n\n    /**\n     * Dots\n     */\n\n    if (value === '.') {\n      if (state.braces > 0 && prev.type === 'dot') {\n        if (prev.value === '.') prev.output = DOT_LITERAL;\n        const brace = braces[braces.length - 1];\n        prev.type = 'dots';\n        prev.output += value;\n        prev.value += value;\n        brace.dots = true;\n        continue;\n      }\n\n      if ((state.braces + state.parens) === 0 && prev.type !== 'bos' && prev.type !== 'slash') {\n        push({ type: 'text', value, output: DOT_LITERAL });\n        continue;\n      }\n\n      push({ type: 'dot', value, output: DOT_LITERAL });\n      continue;\n    }\n\n    /**\n     * Question marks\n     */\n\n    if (value === '?') {\n      const isGroup = prev && prev.value === '(';\n      if (!isGroup && opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        extglobOpen('qmark', value);\n        continue;\n      }\n\n      if (prev && prev.type === 'paren') {\n        const next = peek();\n        let output = value;\n\n        if (next === '<' && !utils.supportsLookbehinds()) {\n          throw new Error('Node.js v10 or higher is required for regex lookbehinds');\n        }\n\n        if ((prev.value === '(' && !/[!=<:]/.test(next)) || (next === '<' && !/<([!=]|\\w+>)/.test(remaining()))) {\n          output = `\\\\${value}`;\n        }\n\n        push({ type: 'text', value, output });\n        continue;\n      }\n\n      if (opts.dot !== true && (prev.type === 'slash' || prev.type === 'bos')) {\n        push({ type: 'qmark', value, output: QMARK_NO_DOT });\n        continue;\n      }\n\n      push({ type: 'qmark', value, output: QMARK });\n      continue;\n    }\n\n    /**\n     * Exclamation\n     */\n\n    if (value === '!') {\n      if (opts.noextglob !== true && peek() === '(') {\n        if (peek(2) !== '?' || !/[!=<:]/.test(peek(3))) {\n          extglobOpen('negate', value);\n          continue;\n        }\n      }\n\n      if (opts.nonegate !== true && state.index === 0) {\n        negate();\n        continue;\n      }\n    }\n\n    /**\n     * Plus\n     */\n\n    if (value === '+') {\n      if (opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        extglobOpen('plus', value);\n        continue;\n      }\n\n      if ((prev && prev.value === '(') || opts.regex === false) {\n        push({ type: 'plus', value, output: PLUS_LITERAL });\n        continue;\n      }\n\n      if ((prev && (prev.type === 'bracket' || prev.type === 'paren' || prev.type === 'brace')) || state.parens > 0) {\n        push({ type: 'plus', value });\n        continue;\n      }\n\n      push({ type: 'plus', value: PLUS_LITERAL });\n      continue;\n    }\n\n    /**\n     * Plain text\n     */\n\n    if (value === '@') {\n      if (opts.noextglob !== true && peek() === '(' && peek(2) !== '?') {\n        push({ type: 'at', extglob: true, value, output: '' });\n        continue;\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Plain text\n     */\n\n    if (value !== '*') {\n      if (value === '$' || value === '^') {\n        value = `\\\\${value}`;\n      }\n\n      const match = REGEX_NON_SPECIAL_CHARS.exec(remaining());\n      if (match) {\n        value += match[0];\n        state.index += match[0].length;\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Stars\n     */\n\n    if (prev && (prev.type === 'globstar' || prev.star === true)) {\n      prev.type = 'star';\n      prev.star = true;\n      prev.value += value;\n      prev.output = star;\n      state.backtrack = true;\n      state.globstar = true;\n      consume(value);\n      continue;\n    }\n\n    let rest = remaining();\n    if (opts.noextglob !== true && /^\\([^?]/.test(rest)) {\n      extglobOpen('star', value);\n      continue;\n    }\n\n    if (prev.type === 'star') {\n      if (opts.noglobstar === true) {\n        consume(value);\n        continue;\n      }\n\n      const prior = prev.prev;\n      const before = prior.prev;\n      const isStart = prior.type === 'slash' || prior.type === 'bos';\n      const afterStar = before && (before.type === 'star' || before.type === 'globstar');\n\n      if (opts.bash === true && (!isStart || (rest[0] && rest[0] !== '/'))) {\n        push({ type: 'star', value, output: '' });\n        continue;\n      }\n\n      const isBrace = state.braces > 0 && (prior.type === 'comma' || prior.type === 'brace');\n      const isExtglob = extglobs.length && (prior.type === 'pipe' || prior.type === 'paren');\n      if (!isStart && prior.type !== 'paren' && !isBrace && !isExtglob) {\n        push({ type: 'star', value, output: '' });\n        continue;\n      }\n\n      // strip consecutive `/**/`\n      while (rest.slice(0, 3) === '/**') {\n        const after = input[state.index + 4];\n        if (after && after !== '/') {\n          break;\n        }\n        rest = rest.slice(3);\n        consume('/**', 3);\n      }\n\n      if (prior.type === 'bos' && eos()) {\n        prev.type = 'globstar';\n        prev.value += value;\n        prev.output = globstar(opts);\n        state.output = prev.output;\n        state.globstar = true;\n        consume(value);\n        continue;\n      }\n\n      if (prior.type === 'slash' && prior.prev.type !== 'bos' && !afterStar && eos()) {\n        state.output = state.output.slice(0, -(prior.output + prev.output).length);\n        prior.output = `(?:${prior.output}`;\n\n        prev.type = 'globstar';\n        prev.output = globstar(opts) + (opts.strictSlashes ? ')' : '|$)');\n        prev.value += value;\n        state.globstar = true;\n        state.output += prior.output + prev.output;\n        consume(value);\n        continue;\n      }\n\n      if (prior.type === 'slash' && prior.prev.type !== 'bos' && rest[0] === '/') {\n        const end = rest[1] !== void 0 ? '|$' : '';\n\n        state.output = state.output.slice(0, -(prior.output + prev.output).length);\n        prior.output = `(?:${prior.output}`;\n\n        prev.type = 'globstar';\n        prev.output = `${globstar(opts)}${SLASH_LITERAL}|${SLASH_LITERAL}${end})`;\n        prev.value += value;\n\n        state.output += prior.output + prev.output;\n        state.globstar = true;\n\n        consume(value + advance());\n\n        push({ type: 'slash', value: '/', output: '' });\n        continue;\n      }\n\n      if (prior.type === 'bos' && rest[0] === '/') {\n        prev.type = 'globstar';\n        prev.value += value;\n        prev.output = `(?:^|${SLASH_LITERAL}|${globstar(opts)}${SLASH_LITERAL})`;\n        state.output = prev.output;\n        state.globstar = true;\n        consume(value + advance());\n        push({ type: 'slash', value: '/', output: '' });\n        continue;\n      }\n\n      // remove single star from output\n      state.output = state.output.slice(0, -prev.output.length);\n\n      // reset previous token to globstar\n      prev.type = 'globstar';\n      prev.output = globstar(opts);\n      prev.value += value;\n\n      // reset output with globstar\n      state.output += prev.output;\n      state.globstar = true;\n      consume(value);\n      continue;\n    }\n\n    const token = { type: 'star', value, output: star };\n\n    if (opts.bash === true) {\n      token.output = '.*?';\n      if (prev.type === 'bos' || prev.type === 'slash') {\n        token.output = nodot + token.output;\n      }\n      push(token);\n      continue;\n    }\n\n    if (prev && (prev.type === 'bracket' || prev.type === 'paren') && opts.regex === true) {\n      token.output = value;\n      push(token);\n      continue;\n    }\n\n    if (state.index === state.start || prev.type === 'slash' || prev.type === 'dot') {\n      if (prev.type === 'dot') {\n        state.output += NO_DOT_SLASH;\n        prev.output += NO_DOT_SLASH;\n\n      } else if (opts.dot === true) {\n        state.output += NO_DOTS_SLASH;\n        prev.output += NO_DOTS_SLASH;\n\n      } else {\n        state.output += nodot;\n        prev.output += nodot;\n      }\n\n      if (peek() !== '*') {\n        state.output += ONE_CHAR;\n        prev.output += ONE_CHAR;\n      }\n    }\n\n    push(token);\n  }\n\n  while (state.brackets > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', ']'));\n    state.output = utils.escapeLast(state.output, '[');\n    decrement('brackets');\n  }\n\n  while (state.parens > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', ')'));\n    state.output = utils.escapeLast(state.output, '(');\n    decrement('parens');\n  }\n\n  while (state.braces > 0) {\n    if (opts.strictBrackets === true) throw new SyntaxError(syntaxError('closing', '}'));\n    state.output = utils.escapeLast(state.output, '{');\n    decrement('braces');\n  }\n\n  if (opts.strictSlashes !== true && (prev.type === 'star' || prev.type === 'bracket')) {\n    push({ type: 'maybe_slash', value: '', output: `${SLASH_LITERAL}?` });\n  }\n\n  // rebuild the output if we had to backtrack at any point\n  if (state.backtrack === true) {\n    state.output = '';\n\n    for (const token of state.tokens) {\n      state.output += token.output != null ? token.output : token.value;\n\n      if (token.suffix) {\n        state.output += token.suffix;\n      }\n    }\n  }\n\n  return state;\n};\n\n/**\n * Fast paths for creating regular expressions for common glob patterns.\n * This can significantly speed up processing and has very little downside\n * impact when none of the fast paths match.\n */\n\nparse.fastpaths = (input, options) => {\n  const opts = { ...options };\n  const max = typeof opts.maxLength === 'number' ? Math.min(MAX_LENGTH, opts.maxLength) : MAX_LENGTH;\n  const len = input.length;\n  if (len > max) {\n    throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`);\n  }\n\n  input = REPLACEMENTS[input] || input;\n  const win32 = utils.isWindows(options);\n\n  // create constants based on platform, for windows or posix\n  const {\n    DOT_LITERAL,\n    SLASH_LITERAL,\n    ONE_CHAR,\n    DOTS_SLASH,\n    NO_DOT,\n    NO_DOTS,\n    NO_DOTS_SLASH,\n    STAR,\n    START_ANCHOR\n  } = constants.globChars(win32);\n\n  const nodot = opts.dot ? NO_DOTS : NO_DOT;\n  const slashDot = opts.dot ? NO_DOTS_SLASH : NO_DOT;\n  const capture = opts.capture ? '' : '?:';\n  const state = { negated: false, prefix: '' };\n  let star = opts.bash === true ? '.*?' : STAR;\n\n  if (opts.capture) {\n    star = `(${star})`;\n  }\n\n  const globstar = opts => {\n    if (opts.noglobstar === true) return star;\n    return `(${capture}(?:(?!${START_ANCHOR}${opts.dot ? DOTS_SLASH : DOT_LITERAL}).)*?)`;\n  };\n\n  const create = str => {\n    switch (str) {\n      case '*':\n        return `${nodot}${ONE_CHAR}${star}`;\n\n      case '.*':\n        return `${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '*.*':\n        return `${nodot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '*/*':\n        return `${nodot}${star}${SLASH_LITERAL}${ONE_CHAR}${slashDot}${star}`;\n\n      case '**':\n        return nodot + globstar(opts);\n\n      case '**/*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${ONE_CHAR}${star}`;\n\n      case '**/*.*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      case '**/.*':\n        return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${DOT_LITERAL}${ONE_CHAR}${star}`;\n\n      default: {\n        const match = /^(.*?)\\.(\\w+)$/.exec(str);\n        if (!match) return;\n\n        const source = create(match[1]);\n        if (!source) return;\n\n        return source + DOT_LITERAL + match[2];\n      }\n    }\n  };\n\n  const output = utils.removePrefix(input, state);\n  let source = create(output);\n\n  if (source && opts.strictSlashes !== true) {\n    source += `${SLASH_LITERAL}?`;\n  }\n\n  return source;\n};\n\nmodule.exports = parse;\n","'use strict';\n\nconst path = require('path');\nconst scan = require('./scan');\nconst parse = require('./parse');\nconst utils = require('./utils');\nconst constants = require('./constants');\nconst isObject = val => val && typeof val === 'object' && !Array.isArray(val);\n\n/**\n * Creates a matcher function from one or more glob patterns. The\n * returned function takes a string to match as its first argument,\n * and returns true if the string is a match. The returned matcher\n * function also takes a boolean as the second argument that, when true,\n * returns an object with additional information.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch(glob[, options]);\n *\n * const isMatch = picomatch('*.!(*a)');\n * console.log(isMatch('a.a')); //=> false\n * console.log(isMatch('a.b')); //=> true\n * ```\n * @name picomatch\n * @param {String|Array} `globs` One or more glob patterns.\n * @param {Object=} `options`\n * @return {Function=} Returns a matcher function.\n * @api public\n */\n\nconst picomatch = (glob, options, returnState = false) => {\n  if (Array.isArray(glob)) {\n    const fns = glob.map(input => picomatch(input, options, returnState));\n    const arrayMatcher = str => {\n      for (const isMatch of fns) {\n        const state = isMatch(str);\n        if (state) return state;\n      }\n      return false;\n    };\n    return arrayMatcher;\n  }\n\n  const isState = isObject(glob) && glob.tokens && glob.input;\n\n  if (glob === '' || (typeof glob !== 'string' && !isState)) {\n    throw new TypeError('Expected pattern to be a non-empty string');\n  }\n\n  const opts = options || {};\n  const posix = utils.isWindows(options);\n  const regex = isState\n    ? picomatch.compileRe(glob, options)\n    : picomatch.makeRe(glob, options, false, true);\n\n  const state = regex.state;\n  delete regex.state;\n\n  let isIgnored = () => false;\n  if (opts.ignore) {\n    const ignoreOpts = { ...options, ignore: null, onMatch: null, onResult: null };\n    isIgnored = picomatch(opts.ignore, ignoreOpts, returnState);\n  }\n\n  const matcher = (input, returnObject = false) => {\n    const { isMatch, match, output } = picomatch.test(input, regex, options, { glob, posix });\n    const result = { glob, state, regex, posix, input, output, match, isMatch };\n\n    if (typeof opts.onResult === 'function') {\n      opts.onResult(result);\n    }\n\n    if (isMatch === false) {\n      result.isMatch = false;\n      return returnObject ? result : false;\n    }\n\n    if (isIgnored(input)) {\n      if (typeof opts.onIgnore === 'function') {\n        opts.onIgnore(result);\n      }\n      result.isMatch = false;\n      return returnObject ? result : false;\n    }\n\n    if (typeof opts.onMatch === 'function') {\n      opts.onMatch(result);\n    }\n    return returnObject ? result : true;\n  };\n\n  if (returnState) {\n    matcher.state = state;\n  }\n\n  return matcher;\n};\n\n/**\n * Test `input` with the given `regex`. This is used by the main\n * `picomatch()` function to test the input string.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.test(input, regex[, options]);\n *\n * console.log(picomatch.test('foo/bar', /^(?:([^/]*?)\\/([^/]*?))$/));\n * // { isMatch: true, match: [ 'foo/', 'foo', 'bar' ], output: 'foo/bar' }\n * ```\n * @param {String} `input` String to test.\n * @param {RegExp} `regex`\n * @return {Object} Returns an object with matching info.\n * @api public\n */\n\npicomatch.test = (input, regex, options, { glob, posix } = {}) => {\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected input to be a string');\n  }\n\n  if (input === '') {\n    return { isMatch: false, output: '' };\n  }\n\n  const opts = options || {};\n  const format = opts.format || (posix ? utils.toPosixSlashes : null);\n  let match = input === glob;\n  let output = (match && format) ? format(input) : input;\n\n  if (match === false) {\n    output = format ? format(input) : input;\n    match = output === glob;\n  }\n\n  if (match === false || opts.capture === true) {\n    if (opts.matchBase === true || opts.basename === true) {\n      match = picomatch.matchBase(input, regex, options, posix);\n    } else {\n      match = regex.exec(output);\n    }\n  }\n\n  return { isMatch: Boolean(match), match, output };\n};\n\n/**\n * Match the basename of a filepath.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.matchBase(input, glob[, options]);\n * console.log(picomatch.matchBase('foo/bar.js', '*.js'); // true\n * ```\n * @param {String} `input` String to test.\n * @param {RegExp|String} `glob` Glob pattern or regex created by [.makeRe](#makeRe).\n * @return {Boolean}\n * @api public\n */\n\npicomatch.matchBase = (input, glob, options, posix = utils.isWindows(options)) => {\n  const regex = glob instanceof RegExp ? glob : picomatch.makeRe(glob, options);\n  return regex.test(path.basename(input));\n};\n\n/**\n * Returns true if **any** of the given glob `patterns` match the specified `string`.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.isMatch(string, patterns[, options]);\n *\n * console.log(picomatch.isMatch('a.a', ['b.*', '*.a'])); //=> true\n * console.log(picomatch.isMatch('a.a', 'b.*')); //=> false\n * ```\n * @param {String|Array} str The string to test.\n * @param {String|Array} patterns One or more glob patterns to use for matching.\n * @param {Object} [options] See available [options](#options).\n * @return {Boolean} Returns true if any patterns match `str`\n * @api public\n */\n\npicomatch.isMatch = (str, patterns, options) => picomatch(patterns, options)(str);\n\n/**\n * Parse a glob pattern to create the source string for a regular\n * expression.\n *\n * ```js\n * const picomatch = require('picomatch');\n * const result = picomatch.parse(pattern[, options]);\n * ```\n * @param {String} `pattern`\n * @param {Object} `options`\n * @return {Object} Returns an object with useful properties and output to be used as a regex source string.\n * @api public\n */\n\npicomatch.parse = (pattern, options) => {\n  if (Array.isArray(pattern)) return pattern.map(p => picomatch.parse(p, options));\n  return parse(pattern, { ...options, fastpaths: false });\n};\n\n/**\n * Scan a glob pattern to separate the pattern into segments.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.scan(input[, options]);\n *\n * const result = picomatch.scan('!./foo/*.js');\n * console.log(result);\n * { prefix: '!./',\n *   input: '!./foo/*.js',\n *   start: 3,\n *   base: 'foo',\n *   glob: '*.js',\n *   isBrace: false,\n *   isBracket: false,\n *   isGlob: true,\n *   isExtglob: false,\n *   isGlobstar: false,\n *   negated: true }\n * ```\n * @param {String} `input` Glob pattern to scan.\n * @param {Object} `options`\n * @return {Object} Returns an object with\n * @api public\n */\n\npicomatch.scan = (input, options) => scan(input, options);\n\n/**\n * Compile a regular expression from the `state` object returned by the\n * [parse()](#parse) method.\n *\n * @param {Object} `state`\n * @param {Object} `options`\n * @param {Boolean} `returnOutput` Intended for implementors, this argument allows you to return the raw output from the parser.\n * @param {Boolean} `returnState` Adds the state to a `state` property on the returned regex. Useful for implementors and debugging.\n * @return {RegExp}\n * @api public\n */\n\npicomatch.compileRe = (state, options, returnOutput = false, returnState = false) => {\n  if (returnOutput === true) {\n    return state.output;\n  }\n\n  const opts = options || {};\n  const prepend = opts.contains ? '' : '^';\n  const append = opts.contains ? '' : '$';\n\n  let source = `${prepend}(?:${state.output})${append}`;\n  if (state && state.negated === true) {\n    source = `^(?!${source}).*$`;\n  }\n\n  const regex = picomatch.toRegex(source, options);\n  if (returnState === true) {\n    regex.state = state;\n  }\n\n  return regex;\n};\n\n/**\n * Create a regular expression from a parsed glob pattern.\n *\n * ```js\n * const picomatch = require('picomatch');\n * const state = picomatch.parse('*.js');\n * // picomatch.compileRe(state[, options]);\n *\n * console.log(picomatch.compileRe(state));\n * //=> /^(?:(?!\\.)(?=.)[^/]*?\\.js)$/\n * ```\n * @param {String} `state` The object returned from the `.parse` method.\n * @param {Object} `options`\n * @param {Boolean} `returnOutput` Implementors may use this argument to return the compiled output, instead of a regular expression. This is not exposed on the options to prevent end-users from mutating the result.\n * @param {Boolean} `returnState` Implementors may use this argument to return the state from the parsed glob with the returned regular expression.\n * @return {RegExp} Returns a regex created from the given pattern.\n * @api public\n */\n\npicomatch.makeRe = (input, options = {}, returnOutput = false, returnState = false) => {\n  if (!input || typeof input !== 'string') {\n    throw new TypeError('Expected a non-empty string');\n  }\n\n  let parsed = { negated: false, fastpaths: true };\n\n  if (options.fastpaths !== false && (input[0] === '.' || input[0] === '*')) {\n    parsed.output = parse.fastpaths(input, options);\n  }\n\n  if (!parsed.output) {\n    parsed = parse(input, options);\n  }\n\n  return picomatch.compileRe(parsed, options, returnOutput, returnState);\n};\n\n/**\n * Create a regular expression from the given regex source string.\n *\n * ```js\n * const picomatch = require('picomatch');\n * // picomatch.toRegex(source[, options]);\n *\n * const { output } = picomatch.parse('*.js');\n * console.log(picomatch.toRegex(output));\n * //=> /^(?:(?!\\.)(?=.)[^/]*?\\.js)$/\n * ```\n * @param {String} `source` Regular expression source string.\n * @param {Object} `options`\n * @return {RegExp}\n * @api public\n */\n\npicomatch.toRegex = (source, options) => {\n  try {\n    const opts = options || {};\n    return new RegExp(source, opts.flags || (opts.nocase ? 'i' : ''));\n  } catch (err) {\n    if (options && options.debug === true) throw err;\n    return /$^/;\n  }\n};\n\n/**\n * Picomatch constants.\n * @return {Object}\n */\n\npicomatch.constants = constants;\n\n/**\n * Expose \"picomatch\"\n */\n\nmodule.exports = picomatch;\n","'use strict';\n\nmodule.exports = require('./lib/picomatch');\n","'use strict';\n\nconst fs = require('fs');\nconst { Readable } = require('stream');\nconst sysPath = require('path');\nconst { promisify } = require('util');\nconst picomatch = require('picomatch');\n\nconst readdir = promisify(fs.readdir);\nconst stat = promisify(fs.stat);\nconst lstat = promisify(fs.lstat);\nconst realpath = promisify(fs.realpath);\n\n/**\n * @typedef {Object} EntryInfo\n * @property {String} path\n * @property {String} fullPath\n * @property {fs.Stats=} stats\n * @property {fs.Dirent=} dirent\n * @property {String} basename\n */\n\nconst BANG = '!';\nconst RECURSIVE_ERROR_CODE = 'READDIRP_RECURSIVE_ERROR';\nconst NORMAL_FLOW_ERRORS = new Set(['ENOENT', 'EPERM', 'EACCES', 'ELOOP', RECURSIVE_ERROR_CODE]);\nconst FILE_TYPE = 'files';\nconst DIR_TYPE = 'directories';\nconst FILE_DIR_TYPE = 'files_directories';\nconst EVERYTHING_TYPE = 'all';\nconst ALL_TYPES = [FILE_TYPE, DIR_TYPE, FILE_DIR_TYPE, EVERYTHING_TYPE];\n\nconst isNormalFlowError = error => NORMAL_FLOW_ERRORS.has(error.code);\nconst [maj, min] = process.versions.node.split('.').slice(0, 2).map(n => Number.parseInt(n, 10));\nconst wantBigintFsStats = process.platform === 'win32' && (maj > 10 || (maj === 10 && min >= 5));\n\nconst normalizeFilter = filter => {\n  if (filter === undefined) return;\n  if (typeof filter === 'function') return filter;\n\n  if (typeof filter === 'string') {\n    const glob = picomatch(filter.trim());\n    return entry => glob(entry.basename);\n  }\n\n  if (Array.isArray(filter)) {\n    const positive = [];\n    const negative = [];\n    for (const item of filter) {\n      const trimmed = item.trim();\n      if (trimmed.charAt(0) === BANG) {\n        negative.push(picomatch(trimmed.slice(1)));\n      } else {\n        positive.push(picomatch(trimmed));\n      }\n    }\n\n    if (negative.length > 0) {\n      if (positive.length > 0) {\n        return entry =>\n          positive.some(f => f(entry.basename)) && !negative.some(f => f(entry.basename));\n      }\n      return entry => !negative.some(f => f(entry.basename));\n    }\n    return entry => positive.some(f => f(entry.basename));\n  }\n};\n\nclass ReaddirpStream extends Readable {\n  static get defaultOptions() {\n    return {\n      root: '.',\n      /* eslint-disable no-unused-vars */\n      fileFilter: (path) => true,\n      directoryFilter: (path) => true,\n      /* eslint-enable no-unused-vars */\n      type: FILE_TYPE,\n      lstat: false,\n      depth: 2147483648,\n      alwaysStat: false\n    };\n  }\n\n  constructor(options = {}) {\n    super({\n      objectMode: true,\n      autoDestroy: true,\n      highWaterMark: options.highWaterMark || 4096\n    });\n    const opts = { ...ReaddirpStream.defaultOptions, ...options };\n    const { root, type } = opts;\n\n    this._fileFilter = normalizeFilter(opts.fileFilter);\n    this._directoryFilter = normalizeFilter(opts.directoryFilter);\n\n    const statMethod = opts.lstat ? lstat : stat;\n    // Use bigint stats if it's windows and stat() supports options (node 10+).\n    if (wantBigintFsStats) {\n      this._stat = path => statMethod(path, { bigint: true });\n    } else {\n      this._stat = statMethod;\n    }\n\n    this._maxDepth = opts.depth;\n    this._wantsDir = [DIR_TYPE, FILE_DIR_TYPE, EVERYTHING_TYPE].includes(type);\n    this._wantsFile = [FILE_TYPE, FILE_DIR_TYPE, EVERYTHING_TYPE].includes(type);\n    this._wantsEverything = type === EVERYTHING_TYPE;\n    this._root = sysPath.resolve(root);\n    this._isDirent = ('Dirent' in fs) && !opts.alwaysStat;\n    this._statsProp = this._isDirent ? 'dirent' : 'stats';\n    this._rdOptions = { encoding: 'utf8', withFileTypes: this._isDirent };\n\n    // Launch stream with one parent, the root dir.\n    this.parents = [this._exploreDir(root, 1)];\n    this.reading = false;\n    this.parent = undefined;\n  }\n\n  async _read(batch) {\n    if (this.reading) return;\n    this.reading = true;\n\n    try {\n      while (!this.destroyed && batch > 0) {\n        const { path, depth, files = [] } = this.parent || {};\n\n        if (files.length > 0) {\n          const slice = files.splice(0, batch).map(dirent => this._formatEntry(dirent, path));\n          for (const entry of await Promise.all(slice)) {\n            if (this.destroyed) return;\n\n            const entryType = await this._getEntryType(entry);\n            if (entryType === 'directory' && this._directoryFilter(entry)) {\n              if (depth <= this._maxDepth) {\n                this.parents.push(this._exploreDir(entry.fullPath, depth + 1));\n              }\n\n              if (this._wantsDir) {\n                this.push(entry);\n                batch--;\n              }\n            } else if ((entryType === 'file' || this._includeAsFile(entry)) && this._fileFilter(entry)) {\n              if (this._wantsFile) {\n                this.push(entry);\n                batch--;\n              }\n            }\n          }\n        } else {\n          const parent = this.parents.pop();\n          if (!parent) {\n            this.push(null);\n            break;\n          }\n          this.parent = await parent;\n          if (this.destroyed) return;\n        }\n      }\n    } catch (error) {\n      this.destroy(error);\n    } finally {\n      this.reading = false;\n    }\n  }\n\n  async _exploreDir(path, depth) {\n    let files;\n    try {\n      files = await readdir(path, this._rdOptions);\n    } catch (error) {\n      this._onError(error);\n    }\n    return { files, depth, path };\n  }\n\n  async _formatEntry(dirent, path) {\n    let entry;\n    try {\n      const basename = this._isDirent ? dirent.name : dirent;\n      const fullPath = sysPath.resolve(sysPath.join(path, basename));\n      entry = { path: sysPath.relative(this._root, fullPath), fullPath, basename };\n      entry[this._statsProp] = this._isDirent ? dirent : await this._stat(fullPath);\n    } catch (err) {\n      this._onError(err);\n    }\n    return entry;\n  }\n\n  _onError(err) {\n    if (isNormalFlowError(err) && !this.destroyed) {\n      this.emit('warn', err);\n    } else {\n      this.destroy(err);\n    }\n  }\n\n  async _getEntryType(entry) {\n    // entry may be undefined, because a warning or an error were emitted\n    // and the statsProp is undefined\n    const stats = entry && entry[this._statsProp];\n    if (!stats) {\n      return;\n    }\n    if (stats.isFile()) {\n      return 'file';\n    }\n    if (stats.isDirectory()) {\n      return 'directory';\n    }\n    if (stats && stats.isSymbolicLink()) {\n      const full = entry.fullPath;\n      try {\n        const entryRealPath = await realpath(full);\n        const entryRealPathStats = await lstat(entryRealPath);\n        if (entryRealPathStats.isFile()) {\n          return 'file';\n        }\n        if (entryRealPathStats.isDirectory()) {\n          const len = entryRealPath.length;\n          if (full.startsWith(entryRealPath) && full.substr(len, 1) === sysPath.sep) {\n            const recursiveError = new Error(\n              `Circular symlink detected: \"${full}\" points to \"${entryRealPath}\"`\n            );\n            recursiveError.code = RECURSIVE_ERROR_CODE;\n            return this._onError(recursiveError);\n          }\n          return 'directory';\n        }\n      } catch (error) {\n        this._onError(error);\n      }\n    }\n  }\n\n  _includeAsFile(entry) {\n    const stats = entry && entry[this._statsProp];\n\n    return stats && this._wantsEverything && !stats.isDirectory();\n  }\n}\n\n/**\n * @typedef {Object} ReaddirpArguments\n * @property {Function=} fileFilter\n * @property {Function=} directoryFilter\n * @property {String=} type\n * @property {Number=} depth\n * @property {String=} root\n * @property {Boolean=} lstat\n * @property {Boolean=} bigint\n */\n\n/**\n * Main function which ends up calling readdirRec and reads all files and directories in given root recursively.\n * @param {String} root Root directory\n * @param {ReaddirpArguments=} options Options to specify root (start directory), filters and recursion depth\n */\nconst readdirp = (root, options = {}) => {\n  let type = options.entryType || options.type;\n  if (type === 'both') type = FILE_DIR_TYPE; // backwards-compatibility\n  if (type) options.type = type;\n  if (!root) {\n    throw new Error('readdirp: root argument is required. Usage: readdirp(root, options)');\n  } else if (typeof root !== 'string') {\n    throw new TypeError('readdirp: root argument must be a string. Usage: readdirp(root, options)');\n  } else if (type && !ALL_TYPES.includes(type)) {\n    throw new Error(`readdirp: Invalid type passed. Use one of ${ALL_TYPES.join(', ')}`);\n  }\n\n  options.root = root;\n  return new ReaddirpStream(options);\n};\n\nconst readdirpPromise = (root, options = {}) => {\n  return new Promise((resolve, reject) => {\n    const files = [];\n    readdirp(root, options)\n      .on('data', entry => files.push(entry))\n      .on('end', () => resolve(files))\n      .on('error', error => reject(error));\n  });\n};\n\nreaddirp.promise = readdirpPromise;\nreaddirp.ReaddirpStream = ReaddirpStream;\nreaddirp.default = readdirp;\n\nmodule.exports = readdirp;\n","/*!\n * normalize-path <https://github.com/jonschlinkert/normalize-path>\n *\n * Copyright (c) 2014-2018, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nmodule.exports = function(path, stripTrailing) {\n  if (typeof path !== 'string') {\n    throw new TypeError('expected path to be a string');\n  }\n\n  if (path === '\\\\' || path === '/') return '/';\n\n  var len = path.length;\n  if (len <= 1) return path;\n\n  // ensure that win32 namespaces has two leading slashes, so that the path is\n  // handled properly by the win32 version of path.parse() after being normalized\n  // https://msdn.microsoft.com/library/windows/desktop/aa365247(v=vs.85).aspx#namespaces\n  var prefix = '';\n  if (len > 4 && path[3] === '\\\\') {\n    var ch = path[2];\n    if ((ch === '?' || ch === '.') && path.slice(0, 2) === '\\\\\\\\') {\n      path = path.slice(2);\n      prefix = '//';\n    }\n  }\n\n  var segs = path.split(/[/\\\\]+/);\n  if (stripTrailing !== false && segs[segs.length - 1] === '') {\n    segs.pop();\n  }\n  return prefix + segs.join('/');\n};\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nconst picomatch = require('picomatch');\nconst normalizePath = require('normalize-path');\n\n/**\n * @typedef {(testString: string) => boolean} AnymatchFn\n * @typedef {string|RegExp|AnymatchFn} AnymatchPattern\n * @typedef {AnymatchPattern|AnymatchPattern[]} AnymatchMatcher\n */\nconst BANG = '!';\nconst DEFAULT_OPTIONS = {returnIndex: false};\nconst arrify = (item) => Array.isArray(item) ? item : [item];\n\n/**\n * @param {AnymatchPattern} matcher\n * @param {object} options\n * @returns {AnymatchFn}\n */\nconst createPattern = (matcher, options) => {\n  if (typeof matcher === 'function') {\n    return matcher;\n  }\n  if (typeof matcher === 'string') {\n    const glob = picomatch(matcher, options);\n    return (string) => matcher === string || glob(string);\n  }\n  if (matcher instanceof RegExp) {\n    return (string) => matcher.test(string);\n  }\n  return (string) => false;\n};\n\n/**\n * @param {Array<Function>} patterns\n * @param {Array<Function>} negPatterns\n * @param {String|Array} args\n * @param {Boolean} returnIndex\n * @returns {boolean|number}\n */\nconst matchPatterns = (patterns, negPatterns, args, returnIndex) => {\n  const isList = Array.isArray(args);\n  const _path = isList ? args[0] : args;\n  if (!isList && typeof _path !== 'string') {\n    throw new TypeError('anymatch: second argument must be a string: got ' +\n      Object.prototype.toString.call(_path))\n  }\n  const path = normalizePath(_path, false);\n\n  for (let index = 0; index < negPatterns.length; index++) {\n    const nglob = negPatterns[index];\n    if (nglob(path)) {\n      return returnIndex ? -1 : false;\n    }\n  }\n\n  const applied = isList && [path].concat(args.slice(1));\n  for (let index = 0; index < patterns.length; index++) {\n    const pattern = patterns[index];\n    if (isList ? pattern(...applied) : pattern(path)) {\n      return returnIndex ? index : true;\n    }\n  }\n\n  return returnIndex ? -1 : false;\n};\n\n/**\n * @param {AnymatchMatcher} matchers\n * @param {Array|string} testString\n * @param {object} options\n * @returns {boolean|number|Function}\n */\nconst anymatch = (matchers, testString, options = DEFAULT_OPTIONS) => {\n  if (matchers == null) {\n    throw new TypeError('anymatch: specify first argument');\n  }\n  const opts = typeof options === 'boolean' ? {returnIndex: options} : options;\n  const returnIndex = opts.returnIndex || false;\n\n  // Early cache for matchers.\n  const mtchers = arrify(matchers);\n  const negatedGlobs = mtchers\n    .filter(item => typeof item === 'string' && item.charAt(0) === BANG)\n    .map(item => item.slice(1))\n    .map(item => picomatch(item, opts));\n  const patterns = mtchers\n    .filter(item => typeof item !== 'string' || (typeof item === 'string' && item.charAt(0) !== BANG))\n    .map(matcher => createPattern(matcher, opts));\n\n  if (testString == null) {\n    return (testString, ri = false) => {\n      const returnIndex = typeof ri === 'boolean' ? ri : false;\n      return matchPatterns(patterns, negatedGlobs, testString, returnIndex);\n    }\n  }\n\n  return matchPatterns(patterns, negatedGlobs, testString, returnIndex);\n};\n\nanymatch.default = anymatch;\nmodule.exports = anymatch;\n","/*!\n * is-extglob <https://github.com/jonschlinkert/is-extglob>\n *\n * Copyright (c) 2014-2016, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\nmodule.exports = function isExtglob(str) {\n  if (typeof str !== 'string' || str === '') {\n    return false;\n  }\n\n  var match;\n  while ((match = /(\\\\).|([@?!+*]\\(.*\\))/g.exec(str))) {\n    if (match[2]) return true;\n    str = str.slice(match.index + match[0].length);\n  }\n\n  return false;\n};\n","/*!\n * is-glob <https://github.com/jonschlinkert/is-glob>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nvar isExtglob = require('is-extglob');\nvar chars = { '{': '}', '(': ')', '[': ']'};\nvar strictCheck = function(str) {\n  if (str[0] === '!') {\n    return true;\n  }\n  var index = 0;\n  var pipeIndex = -2;\n  var closeSquareIndex = -2;\n  var closeCurlyIndex = -2;\n  var closeParenIndex = -2;\n  var backSlashIndex = -2;\n  while (index < str.length) {\n    if (str[index] === '*') {\n      return true;\n    }\n\n    if (str[index + 1] === '?' && /[\\].+)]/.test(str[index])) {\n      return true;\n    }\n\n    if (closeSquareIndex !== -1 && str[index] === '[' && str[index + 1] !== ']') {\n      if (closeSquareIndex < index) {\n        closeSquareIndex = str.indexOf(']', index);\n      }\n      if (closeSquareIndex > index) {\n        if (backSlashIndex === -1 || backSlashIndex > closeSquareIndex) {\n          return true;\n        }\n        backSlashIndex = str.indexOf('\\\\', index);\n        if (backSlashIndex === -1 || backSlashIndex > closeSquareIndex) {\n          return true;\n        }\n      }\n    }\n\n    if (closeCurlyIndex !== -1 && str[index] === '{' && str[index + 1] !== '}') {\n      closeCurlyIndex = str.indexOf('}', index);\n      if (closeCurlyIndex > index) {\n        backSlashIndex = str.indexOf('\\\\', index);\n        if (backSlashIndex === -1 || backSlashIndex > closeCurlyIndex) {\n          return true;\n        }\n      }\n    }\n\n    if (closeParenIndex !== -1 && str[index] === '(' && str[index + 1] === '?' && /[:!=]/.test(str[index + 2]) && str[index + 3] !== ')') {\n      closeParenIndex = str.indexOf(')', index);\n      if (closeParenIndex > index) {\n        backSlashIndex = str.indexOf('\\\\', index);\n        if (backSlashIndex === -1 || backSlashIndex > closeParenIndex) {\n          return true;\n        }\n      }\n    }\n\n    if (pipeIndex !== -1 && str[index] === '(' && str[index + 1] !== '|') {\n      if (pipeIndex < index) {\n        pipeIndex = str.indexOf('|', index);\n      }\n      if (pipeIndex !== -1 && str[pipeIndex + 1] !== ')') {\n        closeParenIndex = str.indexOf(')', pipeIndex);\n        if (closeParenIndex > pipeIndex) {\n          backSlashIndex = str.indexOf('\\\\', pipeIndex);\n          if (backSlashIndex === -1 || backSlashIndex > closeParenIndex) {\n            return true;\n          }\n        }\n      }\n    }\n\n    if (str[index] === '\\\\') {\n      var open = str[index + 1];\n      index += 2;\n      var close = chars[open];\n\n      if (close) {\n        var n = str.indexOf(close, index);\n        if (n !== -1) {\n          index = n + 1;\n        }\n      }\n\n      if (str[index] === '!') {\n        return true;\n      }\n    } else {\n      index++;\n    }\n  }\n  return false;\n};\n\nvar relaxedCheck = function(str) {\n  if (str[0] === '!') {\n    return true;\n  }\n  var index = 0;\n  while (index < str.length) {\n    if (/[*?{}()[\\]]/.test(str[index])) {\n      return true;\n    }\n\n    if (str[index] === '\\\\') {\n      var open = str[index + 1];\n      index += 2;\n      var close = chars[open];\n\n      if (close) {\n        var n = str.indexOf(close, index);\n        if (n !== -1) {\n          index = n + 1;\n        }\n      }\n\n      if (str[index] === '!') {\n        return true;\n      }\n    } else {\n      index++;\n    }\n  }\n  return false;\n};\n\nmodule.exports = function isGlob(str, options) {\n  if (typeof str !== 'string' || str === '') {\n    return false;\n  }\n\n  if (isExtglob(str)) {\n    return true;\n  }\n\n  var check = strictCheck;\n\n  // optionally relax check\n  if (options && options.strict === false) {\n    check = relaxedCheck;\n  }\n\n  return check(str);\n};\n","'use strict';\n\nvar isGlob = require('is-glob');\nvar pathPosixDirname = require('path').posix.dirname;\nvar isWin32 = require('os').platform() === 'win32';\n\nvar slash = '/';\nvar backslash = /\\\\/g;\nvar enclosure = /[\\{\\[].*[\\}\\]]$/;\nvar globby = /(^|[^\\\\])([\\{\\[]|\\([^\\)]+$)/;\nvar escaped = /\\\\([\\!\\*\\?\\|\\[\\]\\(\\)\\{\\}])/g;\n\n/**\n * @param {string} str\n * @param {Object} opts\n * @param {boolean} [opts.flipBackslashes=true]\n * @returns {string}\n */\nmodule.exports = function globParent(str, opts) {\n  var options = Object.assign({ flipBackslashes: true }, opts);\n\n  // flip windows path separators\n  if (options.flipBackslashes && isWin32 && str.indexOf(slash) < 0) {\n    str = str.replace(backslash, slash);\n  }\n\n  // special case for strings ending in enclosure containing path separator\n  if (enclosure.test(str)) {\n    str += slash;\n  }\n\n  // preserves full path in case of trailing path separator\n  str += 'a';\n\n  // remove path parts that are globby\n  do {\n    str = pathPosixDirname(str);\n  } while (isGlob(str) || globby.test(str));\n\n  // remove escape chars and return result\n  return str.replace(escaped, '$1');\n};\n","'use strict';\n\nexports.isInteger = num => {\n  if (typeof num === 'number') {\n    return Number.isInteger(num);\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isInteger(Number(num));\n  }\n  return false;\n};\n\n/**\n * Find a node of the given type\n */\n\nexports.find = (node, type) => node.nodes.find(node => node.type === type);\n\n/**\n * Find a node of the given type\n */\n\nexports.exceedsLimit = (min, max, step = 1, limit) => {\n  if (limit === false) return false;\n  if (!exports.isInteger(min) || !exports.isInteger(max)) return false;\n  return ((Number(max) - Number(min)) / Number(step)) >= limit;\n};\n\n/**\n * Escape the given node with '\\\\' before node.value\n */\n\nexports.escapeNode = (block, n = 0, type) => {\n  const node = block.nodes[n];\n  if (!node) return;\n\n  if ((type && node.type === type) || node.type === 'open' || node.type === 'close') {\n    if (node.escaped !== true) {\n      node.value = '\\\\' + node.value;\n      node.escaped = true;\n    }\n  }\n};\n\n/**\n * Returns true if the given brace node should be enclosed in literal braces\n */\n\nexports.encloseBrace = node => {\n  if (node.type !== 'brace') return false;\n  if ((node.commas >> 0 + node.ranges >> 0) === 0) {\n    node.invalid = true;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Returns true if a brace node is invalid.\n */\n\nexports.isInvalidBrace = block => {\n  if (block.type !== 'brace') return false;\n  if (block.invalid === true || block.dollar) return true;\n  if ((block.commas >> 0 + block.ranges >> 0) === 0) {\n    block.invalid = true;\n    return true;\n  }\n  if (block.open !== true || block.close !== true) {\n    block.invalid = true;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Returns true if a node is an open or close node\n */\n\nexports.isOpenOrClose = node => {\n  if (node.type === 'open' || node.type === 'close') {\n    return true;\n  }\n  return node.open === true || node.close === true;\n};\n\n/**\n * Reduce an array of text nodes.\n */\n\nexports.reduce = nodes => nodes.reduce((acc, node) => {\n  if (node.type === 'text') acc.push(node.value);\n  if (node.type === 'range') node.type = 'text';\n  return acc;\n}, []);\n\n/**\n * Flatten an array\n */\n\nexports.flatten = (...args) => {\n  const result = [];\n\n  const flat = arr => {\n    for (let i = 0; i < arr.length; i++) {\n      const ele = arr[i];\n\n      if (Array.isArray(ele)) {\n        flat(ele);\n        continue;\n      }\n\n      if (ele !== undefined) {\n        result.push(ele);\n      }\n    }\n    return result;\n  };\n\n  flat(args);\n  return result;\n};\n","'use strict';\n\nconst utils = require('./utils');\n\nmodule.exports = (ast, options = {}) => {\n  const stringify = (node, parent = {}) => {\n    const invalidBlock = options.escapeInvalid && utils.isInvalidBrace(parent);\n    const invalidNode = node.invalid === true && options.escapeInvalid === true;\n    let output = '';\n\n    if (node.value) {\n      if ((invalidBlock || invalidNode) && utils.isOpenOrClose(node)) {\n        return '\\\\' + node.value;\n      }\n      return node.value;\n    }\n\n    if (node.value) {\n      return node.value;\n    }\n\n    if (node.nodes) {\n      for (const child of node.nodes) {\n        output += stringify(child);\n      }\n    }\n    return output;\n  };\n\n  return stringify(ast);\n};\n\n","/*!\n * is-number <https://github.com/jonschlinkert/is-number>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(num) {\n  if (typeof num === 'number') {\n    return num - num === 0;\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isFinite ? Number.isFinite(+num) : isFinite(+num);\n  }\n  return false;\n};\n","/*!\n * to-regex-range <https://github.com/micromatch/to-regex-range>\n *\n * Copyright (c) 2015-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nconst isNumber = require('is-number');\n\nconst toRegexRange = (min, max, options) => {\n  if (isNumber(min) === false) {\n    throw new TypeError('toRegexRange: expected the first argument to be a number');\n  }\n\n  if (max === void 0 || min === max) {\n    return String(min);\n  }\n\n  if (isNumber(max) === false) {\n    throw new TypeError('toRegexRange: expected the second argument to be a number.');\n  }\n\n  let opts = { relaxZeros: true, ...options };\n  if (typeof opts.strictZeros === 'boolean') {\n    opts.relaxZeros = opts.strictZeros === false;\n  }\n\n  let relax = String(opts.relaxZeros);\n  let shorthand = String(opts.shorthand);\n  let capture = String(opts.capture);\n  let wrap = String(opts.wrap);\n  let cacheKey = min + ':' + max + '=' + relax + shorthand + capture + wrap;\n\n  if (toRegexRange.cache.hasOwnProperty(cacheKey)) {\n    return toRegexRange.cache[cacheKey].result;\n  }\n\n  let a = Math.min(min, max);\n  let b = Math.max(min, max);\n\n  if (Math.abs(a - b) === 1) {\n    let result = min + '|' + max;\n    if (opts.capture) {\n      return `(${result})`;\n    }\n    if (opts.wrap === false) {\n      return result;\n    }\n    return `(?:${result})`;\n  }\n\n  let isPadded = hasPadding(min) || hasPadding(max);\n  let state = { min, max, a, b };\n  let positives = [];\n  let negatives = [];\n\n  if (isPadded) {\n    state.isPadded = isPadded;\n    state.maxLen = String(state.max).length;\n  }\n\n  if (a < 0) {\n    let newMin = b < 0 ? Math.abs(b) : 1;\n    negatives = splitToPatterns(newMin, Math.abs(a), state, opts);\n    a = state.a = 0;\n  }\n\n  if (b >= 0) {\n    positives = splitToPatterns(a, b, state, opts);\n  }\n\n  state.negatives = negatives;\n  state.positives = positives;\n  state.result = collatePatterns(negatives, positives, opts);\n\n  if (opts.capture === true) {\n    state.result = `(${state.result})`;\n  } else if (opts.wrap !== false && (positives.length + negatives.length) > 1) {\n    state.result = `(?:${state.result})`;\n  }\n\n  toRegexRange.cache[cacheKey] = state;\n  return state.result;\n};\n\nfunction collatePatterns(neg, pos, options) {\n  let onlyNegative = filterPatterns(neg, pos, '-', false, options) || [];\n  let onlyPositive = filterPatterns(pos, neg, '', false, options) || [];\n  let intersected = filterPatterns(neg, pos, '-?', true, options) || [];\n  let subpatterns = onlyNegative.concat(intersected).concat(onlyPositive);\n  return subpatterns.join('|');\n}\n\nfunction splitToRanges(min, max) {\n  let nines = 1;\n  let zeros = 1;\n\n  let stop = countNines(min, nines);\n  let stops = new Set([max]);\n\n  while (min <= stop && stop <= max) {\n    stops.add(stop);\n    nines += 1;\n    stop = countNines(min, nines);\n  }\n\n  stop = countZeros(max + 1, zeros) - 1;\n\n  while (min < stop && stop <= max) {\n    stops.add(stop);\n    zeros += 1;\n    stop = countZeros(max + 1, zeros) - 1;\n  }\n\n  stops = [...stops];\n  stops.sort(compare);\n  return stops;\n}\n\n/**\n * Convert a range to a regex pattern\n * @param {Number} `start`\n * @param {Number} `stop`\n * @return {String}\n */\n\nfunction rangeToPattern(start, stop, options) {\n  if (start === stop) {\n    return { pattern: start, count: [], digits: 0 };\n  }\n\n  let zipped = zip(start, stop);\n  let digits = zipped.length;\n  let pattern = '';\n  let count = 0;\n\n  for (let i = 0; i < digits; i++) {\n    let [startDigit, stopDigit] = zipped[i];\n\n    if (startDigit === stopDigit) {\n      pattern += startDigit;\n\n    } else if (startDigit !== '0' || stopDigit !== '9') {\n      pattern += toCharacterClass(startDigit, stopDigit, options);\n\n    } else {\n      count++;\n    }\n  }\n\n  if (count) {\n    pattern += options.shorthand === true ? '\\\\d' : '[0-9]';\n  }\n\n  return { pattern, count: [count], digits };\n}\n\nfunction splitToPatterns(min, max, tok, options) {\n  let ranges = splitToRanges(min, max);\n  let tokens = [];\n  let start = min;\n  let prev;\n\n  for (let i = 0; i < ranges.length; i++) {\n    let max = ranges[i];\n    let obj = rangeToPattern(String(start), String(max), options);\n    let zeros = '';\n\n    if (!tok.isPadded && prev && prev.pattern === obj.pattern) {\n      if (prev.count.length > 1) {\n        prev.count.pop();\n      }\n\n      prev.count.push(obj.count[0]);\n      prev.string = prev.pattern + toQuantifier(prev.count);\n      start = max + 1;\n      continue;\n    }\n\n    if (tok.isPadded) {\n      zeros = padZeros(max, tok, options);\n    }\n\n    obj.string = zeros + obj.pattern + toQuantifier(obj.count);\n    tokens.push(obj);\n    start = max + 1;\n    prev = obj;\n  }\n\n  return tokens;\n}\n\nfunction filterPatterns(arr, comparison, prefix, intersection, options) {\n  let result = [];\n\n  for (let ele of arr) {\n    let { string } = ele;\n\n    // only push if _both_ are negative...\n    if (!intersection && !contains(comparison, 'string', string)) {\n      result.push(prefix + string);\n    }\n\n    // or _both_ are positive\n    if (intersection && contains(comparison, 'string', string)) {\n      result.push(prefix + string);\n    }\n  }\n  return result;\n}\n\n/**\n * Zip strings\n */\n\nfunction zip(a, b) {\n  let arr = [];\n  for (let i = 0; i < a.length; i++) arr.push([a[i], b[i]]);\n  return arr;\n}\n\nfunction compare(a, b) {\n  return a > b ? 1 : b > a ? -1 : 0;\n}\n\nfunction contains(arr, key, val) {\n  return arr.some(ele => ele[key] === val);\n}\n\nfunction countNines(min, len) {\n  return Number(String(min).slice(0, -len) + '9'.repeat(len));\n}\n\nfunction countZeros(integer, zeros) {\n  return integer - (integer % Math.pow(10, zeros));\n}\n\nfunction toQuantifier(digits) {\n  let [start = 0, stop = ''] = digits;\n  if (stop || start > 1) {\n    return `{${start + (stop ? ',' + stop : '')}}`;\n  }\n  return '';\n}\n\nfunction toCharacterClass(a, b, options) {\n  return `[${a}${(b - a === 1) ? '' : '-'}${b}]`;\n}\n\nfunction hasPadding(str) {\n  return /^-?(0+)\\d/.test(str);\n}\n\nfunction padZeros(value, tok, options) {\n  if (!tok.isPadded) {\n    return value;\n  }\n\n  let diff = Math.abs(tok.maxLen - String(value).length);\n  let relax = options.relaxZeros !== false;\n\n  switch (diff) {\n    case 0:\n      return '';\n    case 1:\n      return relax ? '0?' : '0';\n    case 2:\n      return relax ? '0{0,2}' : '00';\n    default: {\n      return relax ? `0{0,${diff}}` : `0{${diff}}`;\n    }\n  }\n}\n\n/**\n * Cache\n */\n\ntoRegexRange.cache = {};\ntoRegexRange.clearCache = () => (toRegexRange.cache = {});\n\n/**\n * Expose `toRegexRange`\n */\n\nmodule.exports = toRegexRange;\n","/*!\n * fill-range <https://github.com/jonschlinkert/fill-range>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\nconst util = require('util');\nconst toRegexRange = require('to-regex-range');\n\nconst isObject = val => val !== null && typeof val === 'object' && !Array.isArray(val);\n\nconst transform = toNumber => {\n  return value => toNumber === true ? Number(value) : String(value);\n};\n\nconst isValidValue = value => {\n  return typeof value === 'number' || (typeof value === 'string' && value !== '');\n};\n\nconst isNumber = num => Number.isInteger(+num);\n\nconst zeros = input => {\n  let value = `${input}`;\n  let index = -1;\n  if (value[0] === '-') value = value.slice(1);\n  if (value === '0') return false;\n  while (value[++index] === '0');\n  return index > 0;\n};\n\nconst stringify = (start, end, options) => {\n  if (typeof start === 'string' || typeof end === 'string') {\n    return true;\n  }\n  return options.stringify === true;\n};\n\nconst pad = (input, maxLength, toNumber) => {\n  if (maxLength > 0) {\n    let dash = input[0] === '-' ? '-' : '';\n    if (dash) input = input.slice(1);\n    input = (dash + input.padStart(dash ? maxLength - 1 : maxLength, '0'));\n  }\n  if (toNumber === false) {\n    return String(input);\n  }\n  return input;\n};\n\nconst toMaxLen = (input, maxLength) => {\n  let negative = input[0] === '-' ? '-' : '';\n  if (negative) {\n    input = input.slice(1);\n    maxLength--;\n  }\n  while (input.length < maxLength) input = '0' + input;\n  return negative ? ('-' + input) : input;\n};\n\nconst toSequence = (parts, options, maxLen) => {\n  parts.negatives.sort((a, b) => a < b ? -1 : a > b ? 1 : 0);\n  parts.positives.sort((a, b) => a < b ? -1 : a > b ? 1 : 0);\n\n  let prefix = options.capture ? '' : '?:';\n  let positives = '';\n  let negatives = '';\n  let result;\n\n  if (parts.positives.length) {\n    positives = parts.positives.map(v => toMaxLen(String(v), maxLen)).join('|');\n  }\n\n  if (parts.negatives.length) {\n    negatives = `-(${prefix}${parts.negatives.map(v => toMaxLen(String(v), maxLen)).join('|')})`;\n  }\n\n  if (positives && negatives) {\n    result = `${positives}|${negatives}`;\n  } else {\n    result = positives || negatives;\n  }\n\n  if (options.wrap) {\n    return `(${prefix}${result})`;\n  }\n\n  return result;\n};\n\nconst toRange = (a, b, isNumbers, options) => {\n  if (isNumbers) {\n    return toRegexRange(a, b, { wrap: false, ...options });\n  }\n\n  let start = String.fromCharCode(a);\n  if (a === b) return start;\n\n  let stop = String.fromCharCode(b);\n  return `[${start}-${stop}]`;\n};\n\nconst toRegex = (start, end, options) => {\n  if (Array.isArray(start)) {\n    let wrap = options.wrap === true;\n    let prefix = options.capture ? '' : '?:';\n    return wrap ? `(${prefix}${start.join('|')})` : start.join('|');\n  }\n  return toRegexRange(start, end, options);\n};\n\nconst rangeError = (...args) => {\n  return new RangeError('Invalid range arguments: ' + util.inspect(...args));\n};\n\nconst invalidRange = (start, end, options) => {\n  if (options.strictRanges === true) throw rangeError([start, end]);\n  return [];\n};\n\nconst invalidStep = (step, options) => {\n  if (options.strictRanges === true) {\n    throw new TypeError(`Expected step \"${step}\" to be a number`);\n  }\n  return [];\n};\n\nconst fillNumbers = (start, end, step = 1, options = {}) => {\n  let a = Number(start);\n  let b = Number(end);\n\n  if (!Number.isInteger(a) || !Number.isInteger(b)) {\n    if (options.strictRanges === true) throw rangeError([start, end]);\n    return [];\n  }\n\n  // fix negative zero\n  if (a === 0) a = 0;\n  if (b === 0) b = 0;\n\n  let descending = a > b;\n  let startString = String(start);\n  let endString = String(end);\n  let stepString = String(step);\n  step = Math.max(Math.abs(step), 1);\n\n  let padded = zeros(startString) || zeros(endString) || zeros(stepString);\n  let maxLen = padded ? Math.max(startString.length, endString.length, stepString.length) : 0;\n  let toNumber = padded === false && stringify(start, end, options) === false;\n  let format = options.transform || transform(toNumber);\n\n  if (options.toRegex && step === 1) {\n    return toRange(toMaxLen(start, maxLen), toMaxLen(end, maxLen), true, options);\n  }\n\n  let parts = { negatives: [], positives: [] };\n  let push = num => parts[num < 0 ? 'negatives' : 'positives'].push(Math.abs(num));\n  let range = [];\n  let index = 0;\n\n  while (descending ? a >= b : a <= b) {\n    if (options.toRegex === true && step > 1) {\n      push(a);\n    } else {\n      range.push(pad(format(a, index), maxLen, toNumber));\n    }\n    a = descending ? a - step : a + step;\n    index++;\n  }\n\n  if (options.toRegex === true) {\n    return step > 1\n      ? toSequence(parts, options, maxLen)\n      : toRegex(range, null, { wrap: false, ...options });\n  }\n\n  return range;\n};\n\nconst fillLetters = (start, end, step = 1, options = {}) => {\n  if ((!isNumber(start) && start.length > 1) || (!isNumber(end) && end.length > 1)) {\n    return invalidRange(start, end, options);\n  }\n\n  let format = options.transform || (val => String.fromCharCode(val));\n  let a = `${start}`.charCodeAt(0);\n  let b = `${end}`.charCodeAt(0);\n\n  let descending = a > b;\n  let min = Math.min(a, b);\n  let max = Math.max(a, b);\n\n  if (options.toRegex && step === 1) {\n    return toRange(min, max, false, options);\n  }\n\n  let range = [];\n  let index = 0;\n\n  while (descending ? a >= b : a <= b) {\n    range.push(format(a, index));\n    a = descending ? a - step : a + step;\n    index++;\n  }\n\n  if (options.toRegex === true) {\n    return toRegex(range, null, { wrap: false, options });\n  }\n\n  return range;\n};\n\nconst fill = (start, end, step, options = {}) => {\n  if (end == null && isValidValue(start)) {\n    return [start];\n  }\n\n  if (!isValidValue(start) || !isValidValue(end)) {\n    return invalidRange(start, end, options);\n  }\n\n  if (typeof step === 'function') {\n    return fill(start, end, 1, { transform: step });\n  }\n\n  if (isObject(step)) {\n    return fill(start, end, 0, step);\n  }\n\n  let opts = { ...options };\n  if (opts.capture === true) opts.wrap = true;\n  step = step || opts.step || 1;\n\n  if (!isNumber(step)) {\n    if (step != null && !isObject(step)) return invalidStep(step, opts);\n    return fill(start, end, 1, step);\n  }\n\n  if (isNumber(start) && isNumber(end)) {\n    return fillNumbers(start, end, step, opts);\n  }\n\n  return fillLetters(start, end, Math.max(Math.abs(step), 1), opts);\n};\n\nmodule.exports = fill;\n","'use strict';\n\nconst fill = require('fill-range');\nconst utils = require('./utils');\n\nconst compile = (ast, options = {}) => {\n  const walk = (node, parent = {}) => {\n    const invalidBlock = utils.isInvalidBrace(parent);\n    const invalidNode = node.invalid === true && options.escapeInvalid === true;\n    const invalid = invalidBlock === true || invalidNode === true;\n    const prefix = options.escapeInvalid === true ? '\\\\' : '';\n    let output = '';\n\n    if (node.isOpen === true) {\n      return prefix + node.value;\n    }\n\n    if (node.isClose === true) {\n      console.log('node.isClose', prefix, node.value);\n      return prefix + node.value;\n    }\n\n    if (node.type === 'open') {\n      return invalid ? prefix + node.value : '(';\n    }\n\n    if (node.type === 'close') {\n      return invalid ? prefix + node.value : ')';\n    }\n\n    if (node.type === 'comma') {\n      return node.prev.type === 'comma' ? '' : invalid ? node.value : '|';\n    }\n\n    if (node.value) {\n      return node.value;\n    }\n\n    if (node.nodes && node.ranges > 0) {\n      const args = utils.reduce(node.nodes);\n      const range = fill(...args, { ...options, wrap: false, toRegex: true, strictZeros: true });\n\n      if (range.length !== 0) {\n        return args.length > 1 && range.length > 1 ? `(${range})` : range;\n      }\n    }\n\n    if (node.nodes) {\n      for (const child of node.nodes) {\n        output += walk(child, node);\n      }\n    }\n\n    return output;\n  };\n\n  return walk(ast);\n};\n\nmodule.exports = compile;\n","'use strict';\n\nconst fill = require('fill-range');\nconst stringify = require('./stringify');\nconst utils = require('./utils');\n\nconst append = (queue = '', stash = '', enclose = false) => {\n  const result = [];\n\n  queue = [].concat(queue);\n  stash = [].concat(stash);\n\n  if (!stash.length) return queue;\n  if (!queue.length) {\n    return enclose ? utils.flatten(stash).map(ele => `{${ele}}`) : stash;\n  }\n\n  for (const item of queue) {\n    if (Array.isArray(item)) {\n      for (const value of item) {\n        result.push(append(value, stash, enclose));\n      }\n    } else {\n      for (let ele of stash) {\n        if (enclose === true && typeof ele === 'string') ele = `{${ele}}`;\n        result.push(Array.isArray(ele) ? append(item, ele, enclose) : item + ele);\n      }\n    }\n  }\n  return utils.flatten(result);\n};\n\nconst expand = (ast, options = {}) => {\n  const rangeLimit = options.rangeLimit === undefined ? 1000 : options.rangeLimit;\n\n  const walk = (node, parent = {}) => {\n    node.queue = [];\n\n    let p = parent;\n    let q = parent.queue;\n\n    while (p.type !== 'brace' && p.type !== 'root' && p.parent) {\n      p = p.parent;\n      q = p.queue;\n    }\n\n    if (node.invalid || node.dollar) {\n      q.push(append(q.pop(), stringify(node, options)));\n      return;\n    }\n\n    if (node.type === 'brace' && node.invalid !== true && node.nodes.length === 2) {\n      q.push(append(q.pop(), ['{}']));\n      return;\n    }\n\n    if (node.nodes && node.ranges > 0) {\n      const args = utils.reduce(node.nodes);\n\n      if (utils.exceedsLimit(...args, options.step, rangeLimit)) {\n        throw new RangeError('expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.');\n      }\n\n      let range = fill(...args, options);\n      if (range.length === 0) {\n        range = stringify(node, options);\n      }\n\n      q.push(append(q.pop(), range));\n      node.nodes = [];\n      return;\n    }\n\n    const enclose = utils.encloseBrace(node);\n    let queue = node.queue;\n    let block = node;\n\n    while (block.type !== 'brace' && block.type !== 'root' && block.parent) {\n      block = block.parent;\n      queue = block.queue;\n    }\n\n    for (let i = 0; i < node.nodes.length; i++) {\n      const child = node.nodes[i];\n\n      if (child.type === 'comma' && node.type === 'brace') {\n        if (i === 1) queue.push('');\n        queue.push('');\n        continue;\n      }\n\n      if (child.type === 'close') {\n        q.push(append(q.pop(), queue, enclose));\n        continue;\n      }\n\n      if (child.value && child.type !== 'open') {\n        queue.push(append(queue.pop(), child.value));\n        continue;\n      }\n\n      if (child.nodes) {\n        walk(child, node);\n      }\n    }\n\n    return queue;\n  };\n\n  return utils.flatten(walk(ast));\n};\n\nmodule.exports = expand;\n","'use strict';\n\nmodule.exports = {\n  MAX_LENGTH: 10000,\n\n  // Digits\n  CHAR_0: '0', /* 0 */\n  CHAR_9: '9', /* 9 */\n\n  // Alphabet chars.\n  CHAR_UPPERCASE_A: 'A', /* A */\n  CHAR_LOWERCASE_A: 'a', /* a */\n  CHAR_UPPERCASE_Z: 'Z', /* Z */\n  CHAR_LOWERCASE_Z: 'z', /* z */\n\n  CHAR_LEFT_PARENTHESES: '(', /* ( */\n  CHAR_RIGHT_PARENTHESES: ')', /* ) */\n\n  CHAR_ASTERISK: '*', /* * */\n\n  // Non-alphabetic chars.\n  CHAR_AMPERSAND: '&', /* & */\n  CHAR_AT: '@', /* @ */\n  CHAR_BACKSLASH: '\\\\', /* \\ */\n  CHAR_BACKTICK: '`', /* ` */\n  CHAR_CARRIAGE_RETURN: '\\r', /* \\r */\n  CHAR_CIRCUMFLEX_ACCENT: '^', /* ^ */\n  CHAR_COLON: ':', /* : */\n  CHAR_COMMA: ',', /* , */\n  CHAR_DOLLAR: '$', /* . */\n  CHAR_DOT: '.', /* . */\n  CHAR_DOUBLE_QUOTE: '\"', /* \" */\n  CHAR_EQUAL: '=', /* = */\n  CHAR_EXCLAMATION_MARK: '!', /* ! */\n  CHAR_FORM_FEED: '\\f', /* \\f */\n  CHAR_FORWARD_SLASH: '/', /* / */\n  CHAR_HASH: '#', /* # */\n  CHAR_HYPHEN_MINUS: '-', /* - */\n  CHAR_LEFT_ANGLE_BRACKET: '<', /* < */\n  CHAR_LEFT_CURLY_BRACE: '{', /* { */\n  CHAR_LEFT_SQUARE_BRACKET: '[', /* [ */\n  CHAR_LINE_FEED: '\\n', /* \\n */\n  CHAR_NO_BREAK_SPACE: '\\u00A0', /* \\u00A0 */\n  CHAR_PERCENT: '%', /* % */\n  CHAR_PLUS: '+', /* + */\n  CHAR_QUESTION_MARK: '?', /* ? */\n  CHAR_RIGHT_ANGLE_BRACKET: '>', /* > */\n  CHAR_RIGHT_CURLY_BRACE: '}', /* } */\n  CHAR_RIGHT_SQUARE_BRACKET: ']', /* ] */\n  CHAR_SEMICOLON: ';', /* ; */\n  CHAR_SINGLE_QUOTE: '\\'', /* ' */\n  CHAR_SPACE: ' ', /*   */\n  CHAR_TAB: '\\t', /* \\t */\n  CHAR_UNDERSCORE: '_', /* _ */\n  CHAR_VERTICAL_LINE: '|', /* | */\n  CHAR_ZERO_WIDTH_NOBREAK_SPACE: '\\uFEFF' /* \\uFEFF */\n};\n","'use strict';\n\nconst stringify = require('./stringify');\n\n/**\n * Constants\n */\n\nconst {\n  MAX_LENGTH,\n  CHAR_BACKSLASH, /* \\ */\n  CHAR_BACKTICK, /* ` */\n  CHAR_COMMA, /* , */\n  CHAR_DOT, /* . */\n  CHAR_LEFT_PARENTHESES, /* ( */\n  CHAR_RIGHT_PARENTHESES, /* ) */\n  CHAR_LEFT_CURLY_BRACE, /* { */\n  CHAR_RIGHT_CURLY_BRACE, /* } */\n  CHAR_LEFT_SQUARE_BRACKET, /* [ */\n  CHAR_RIGHT_SQUARE_BRACKET, /* ] */\n  CHAR_DOUBLE_QUOTE, /* \" */\n  CHAR_SINGLE_QUOTE, /* ' */\n  CHAR_NO_BREAK_SPACE,\n  CHAR_ZERO_WIDTH_NOBREAK_SPACE\n} = require('./constants');\n\n/**\n * parse\n */\n\nconst parse = (input, options = {}) => {\n  if (typeof input !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n\n  const opts = options || {};\n  const max = typeof opts.maxLength === 'number' ? Math.min(MAX_LENGTH, opts.maxLength) : MAX_LENGTH;\n  if (input.length > max) {\n    throw new SyntaxError(`Input length (${input.length}), exceeds max characters (${max})`);\n  }\n\n  const ast = { type: 'root', input, nodes: [] };\n  const stack = [ast];\n  let block = ast;\n  let prev = ast;\n  let brackets = 0;\n  const length = input.length;\n  let index = 0;\n  let depth = 0;\n  let value;\n\n  /**\n   * Helpers\n   */\n\n  const advance = () => input[index++];\n  const push = node => {\n    if (node.type === 'text' && prev.type === 'dot') {\n      prev.type = 'text';\n    }\n\n    if (prev && prev.type === 'text' && node.type === 'text') {\n      prev.value += node.value;\n      return;\n    }\n\n    block.nodes.push(node);\n    node.parent = block;\n    node.prev = prev;\n    prev = node;\n    return node;\n  };\n\n  push({ type: 'bos' });\n\n  while (index < length) {\n    block = stack[stack.length - 1];\n    value = advance();\n\n    /**\n     * Invalid chars\n     */\n\n    if (value === CHAR_ZERO_WIDTH_NOBREAK_SPACE || value === CHAR_NO_BREAK_SPACE) {\n      continue;\n    }\n\n    /**\n     * Escaped chars\n     */\n\n    if (value === CHAR_BACKSLASH) {\n      push({ type: 'text', value: (options.keepEscaping ? value : '') + advance() });\n      continue;\n    }\n\n    /**\n     * Right square bracket (literal): ']'\n     */\n\n    if (value === CHAR_RIGHT_SQUARE_BRACKET) {\n      push({ type: 'text', value: '\\\\' + value });\n      continue;\n    }\n\n    /**\n     * Left square bracket: '['\n     */\n\n    if (value === CHAR_LEFT_SQUARE_BRACKET) {\n      brackets++;\n\n      let next;\n\n      while (index < length && (next = advance())) {\n        value += next;\n\n        if (next === CHAR_LEFT_SQUARE_BRACKET) {\n          brackets++;\n          continue;\n        }\n\n        if (next === CHAR_BACKSLASH) {\n          value += advance();\n          continue;\n        }\n\n        if (next === CHAR_RIGHT_SQUARE_BRACKET) {\n          brackets--;\n\n          if (brackets === 0) {\n            break;\n          }\n        }\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Parentheses\n     */\n\n    if (value === CHAR_LEFT_PARENTHESES) {\n      block = push({ type: 'paren', nodes: [] });\n      stack.push(block);\n      push({ type: 'text', value });\n      continue;\n    }\n\n    if (value === CHAR_RIGHT_PARENTHESES) {\n      if (block.type !== 'paren') {\n        push({ type: 'text', value });\n        continue;\n      }\n      block = stack.pop();\n      push({ type: 'text', value });\n      block = stack[stack.length - 1];\n      continue;\n    }\n\n    /**\n     * Quotes: '|\"|`\n     */\n\n    if (value === CHAR_DOUBLE_QUOTE || value === CHAR_SINGLE_QUOTE || value === CHAR_BACKTICK) {\n      const open = value;\n      let next;\n\n      if (options.keepQuotes !== true) {\n        value = '';\n      }\n\n      while (index < length && (next = advance())) {\n        if (next === CHAR_BACKSLASH) {\n          value += next + advance();\n          continue;\n        }\n\n        if (next === open) {\n          if (options.keepQuotes === true) value += next;\n          break;\n        }\n\n        value += next;\n      }\n\n      push({ type: 'text', value });\n      continue;\n    }\n\n    /**\n     * Left curly brace: '{'\n     */\n\n    if (value === CHAR_LEFT_CURLY_BRACE) {\n      depth++;\n\n      const dollar = prev.value && prev.value.slice(-1) === '$' || block.dollar === true;\n      const brace = {\n        type: 'brace',\n        open: true,\n        close: false,\n        dollar,\n        depth,\n        commas: 0,\n        ranges: 0,\n        nodes: []\n      };\n\n      block = push(brace);\n      stack.push(block);\n      push({ type: 'open', value });\n      continue;\n    }\n\n    /**\n     * Right curly brace: '}'\n     */\n\n    if (value === CHAR_RIGHT_CURLY_BRACE) {\n      if (block.type !== 'brace') {\n        push({ type: 'text', value });\n        continue;\n      }\n\n      const type = 'close';\n      block = stack.pop();\n      block.close = true;\n\n      push({ type, value });\n      depth--;\n\n      block = stack[stack.length - 1];\n      continue;\n    }\n\n    /**\n     * Comma: ','\n     */\n\n    if (value === CHAR_COMMA && depth > 0) {\n      if (block.ranges > 0) {\n        block.ranges = 0;\n        const open = block.nodes.shift();\n        block.nodes = [open, { type: 'text', value: stringify(block) }];\n      }\n\n      push({ type: 'comma', value });\n      block.commas++;\n      continue;\n    }\n\n    /**\n     * Dot: '.'\n     */\n\n    if (value === CHAR_DOT && depth > 0 && block.commas === 0) {\n      const siblings = block.nodes;\n\n      if (depth === 0 || siblings.length === 0) {\n        push({ type: 'text', value });\n        continue;\n      }\n\n      if (prev.type === 'dot') {\n        block.range = [];\n        prev.value += value;\n        prev.type = 'range';\n\n        if (block.nodes.length !== 3 && block.nodes.length !== 5) {\n          block.invalid = true;\n          block.ranges = 0;\n          prev.type = 'text';\n          continue;\n        }\n\n        block.ranges++;\n        block.args = [];\n        continue;\n      }\n\n      if (prev.type === 'range') {\n        siblings.pop();\n\n        const before = siblings[siblings.length - 1];\n        before.value += prev.value + value;\n        prev = before;\n        block.ranges--;\n        continue;\n      }\n\n      push({ type: 'dot', value });\n      continue;\n    }\n\n    /**\n     * Text\n     */\n\n    push({ type: 'text', value });\n  }\n\n  // Mark imbalanced braces and brackets as invalid\n  do {\n    block = stack.pop();\n\n    if (block.type !== 'root') {\n      block.nodes.forEach(node => {\n        if (!node.nodes) {\n          if (node.type === 'open') node.isOpen = true;\n          if (node.type === 'close') node.isClose = true;\n          if (!node.nodes) node.type = 'text';\n          node.invalid = true;\n        }\n      });\n\n      // get the location of the block on parent.nodes (block's siblings)\n      const parent = stack[stack.length - 1];\n      const index = parent.nodes.indexOf(block);\n      // replace the (invalid) block with it's nodes\n      parent.nodes.splice(index, 1, ...block.nodes);\n    }\n  } while (stack.length > 0);\n\n  push({ type: 'eos' });\n  return ast;\n};\n\nmodule.exports = parse;\n","'use strict';\n\nconst stringify = require('./lib/stringify');\nconst compile = require('./lib/compile');\nconst expand = require('./lib/expand');\nconst parse = require('./lib/parse');\n\n/**\n * Expand the given pattern or create a regex-compatible string.\n *\n * ```js\n * const braces = require('braces');\n * console.log(braces('{a,b,c}', { compile: true })); //=> ['(a|b|c)']\n * console.log(braces('{a,b,c}')); //=> ['a', 'b', 'c']\n * ```\n * @param {String} `str`\n * @param {Object} `options`\n * @return {String}\n * @api public\n */\n\nconst braces = (input, options = {}) => {\n  let output = [];\n\n  if (Array.isArray(input)) {\n    for (const pattern of input) {\n      const result = braces.create(pattern, options);\n      if (Array.isArray(result)) {\n        output.push(...result);\n      } else {\n        output.push(result);\n      }\n    }\n  } else {\n    output = [].concat(braces.create(input, options));\n  }\n\n  if (options && options.expand === true && options.nodupes === true) {\n    output = [...new Set(output)];\n  }\n  return output;\n};\n\n/**\n * Parse the given `str` with the given `options`.\n *\n * ```js\n * // braces.parse(pattern, [, options]);\n * const ast = braces.parse('a/{b,c}/d');\n * console.log(ast);\n * ```\n * @param {String} pattern Brace pattern to parse\n * @param {Object} options\n * @return {Object} Returns an AST\n * @api public\n */\n\nbraces.parse = (input, options = {}) => parse(input, options);\n\n/**\n * Creates a braces string from an AST, or an AST node.\n *\n * ```js\n * const braces = require('braces');\n * let ast = braces.parse('foo/{a,b}/bar');\n * console.log(stringify(ast.nodes[2])); //=> '{a,b}'\n * ```\n * @param {String} `input` Brace pattern or AST.\n * @param {Object} `options`\n * @return {Array} Returns an array of expanded values.\n * @api public\n */\n\nbraces.stringify = (input, options = {}) => {\n  if (typeof input === 'string') {\n    return stringify(braces.parse(input, options), options);\n  }\n  return stringify(input, options);\n};\n\n/**\n * Compiles a brace pattern into a regex-compatible, optimized string.\n * This method is called by the main [braces](#braces) function by default.\n *\n * ```js\n * const braces = require('braces');\n * console.log(braces.compile('a/{b,c}/d'));\n * //=> ['a/(b|c)/d']\n * ```\n * @param {String} `input` Brace pattern or AST.\n * @param {Object} `options`\n * @return {Array} Returns an array of expanded values.\n * @api public\n */\n\nbraces.compile = (input, options = {}) => {\n  if (typeof input === 'string') {\n    input = braces.parse(input, options);\n  }\n  return compile(input, options);\n};\n\n/**\n * Expands a brace pattern into an array. This method is called by the\n * main [braces](#braces) function when `options.expand` is true. Before\n * using this method it's recommended that you read the [performance notes](#performance))\n * and advantages of using [.compile](#compile) instead.\n *\n * ```js\n * const braces = require('braces');\n * console.log(braces.expand('a/{b,c}/d'));\n * //=> ['a/b/d', 'a/c/d'];\n * ```\n * @param {String} `pattern` Brace pattern\n * @param {Object} `options`\n * @return {Array} Returns an array of expanded values.\n * @api public\n */\n\nbraces.expand = (input, options = {}) => {\n  if (typeof input === 'string') {\n    input = braces.parse(input, options);\n  }\n\n  let result = expand(input, options);\n\n  // filter out empty strings if specified\n  if (options.noempty === true) {\n    result = result.filter(Boolean);\n  }\n\n  // filter out duplicates if specified\n  if (options.nodupes === true) {\n    result = [...new Set(result)];\n  }\n\n  return result;\n};\n\n/**\n * Processes a brace pattern and returns either an expanded array\n * (if `options.expand` is true), a highly optimized regex-compatible string.\n * This method is called by the main [braces](#braces) function.\n *\n * ```js\n * const braces = require('braces');\n * console.log(braces.create('user-{200..300}/project-{a,b,c}-{1..10}'))\n * //=> 'user-(20[0-9]|2[1-9][0-9]|300)/project-(a|b|c)-([1-9]|10)'\n * ```\n * @param {String} `pattern` Brace pattern\n * @param {Object} `options`\n * @return {Array} Returns an array of expanded values.\n * @api public\n */\n\nbraces.create = (input, options = {}) => {\n  if (input === '' || input.length < 3) {\n    return [input];\n  }\n\n  return options.expand !== true\n    ? braces.compile(input, options)\n    : braces.expand(input, options);\n};\n\n/**\n * Expose \"braces\"\n */\n\nmodule.exports = braces;\n","module.exports = require('./binary-extensions.json');\n","'use strict';\nconst path = require('path');\nconst binaryExtensions = require('binary-extensions');\n\nconst extensions = new Set(binaryExtensions);\n\nmodule.exports = filePath => extensions.has(path.extname(filePath).slice(1).toLowerCase());\n","'use strict';\n\nconst {sep} = require('path');\nconst {platform} = process;\nconst os = require('os');\n\nexports.EV_ALL = 'all';\nexports.EV_READY = 'ready';\nexports.EV_ADD = 'add';\nexports.EV_CHANGE = 'change';\nexports.EV_ADD_DIR = 'addDir';\nexports.EV_UNLINK = 'unlink';\nexports.EV_UNLINK_DIR = 'unlinkDir';\nexports.EV_RAW = 'raw';\nexports.EV_ERROR = 'error';\n\nexports.STR_DATA = 'data';\nexports.STR_END = 'end';\nexports.STR_CLOSE = 'close';\n\nexports.FSEVENT_CREATED = 'created';\nexports.FSEVENT_MODIFIED = 'modified';\nexports.FSEVENT_DELETED = 'deleted';\nexports.FSEVENT_MOVED = 'moved';\nexports.FSEVENT_CLONED = 'cloned';\nexports.FSEVENT_UNKNOWN = 'unknown';\nexports.FSEVENT_FLAG_MUST_SCAN_SUBDIRS = 1;\nexports.FSEVENT_TYPE_FILE = 'file';\nexports.FSEVENT_TYPE_DIRECTORY = 'directory';\nexports.FSEVENT_TYPE_SYMLINK = 'symlink';\n\nexports.KEY_LISTENERS = 'listeners';\nexports.KEY_ERR = 'errHandlers';\nexports.KEY_RAW = 'rawEmitters';\nexports.HANDLER_KEYS = [exports.KEY_LISTENERS, exports.KEY_ERR, exports.KEY_RAW];\n\nexports.DOT_SLASH = `.${sep}`;\n\nexports.BACK_SLASH_RE = /\\\\/g;\nexports.DOUBLE_SLASH_RE = /\\/\\//;\nexports.SLASH_OR_BACK_SLASH_RE = /[/\\\\]/;\nexports.DOT_RE = /\\..*\\.(sw[px])$|~$|\\.subl.*\\.tmp/;\nexports.REPLACER_RE = /^\\.[/\\\\]/;\n\nexports.SLASH = '/';\nexports.SLASH_SLASH = '//';\nexports.BRACE_START = '{';\nexports.BANG = '!';\nexports.ONE_DOT = '.';\nexports.TWO_DOTS = '..';\nexports.STAR = '*';\nexports.GLOBSTAR = '**';\nexports.ROOT_GLOBSTAR = '/**/*';\nexports.SLASH_GLOBSTAR = '/**';\nexports.DIR_SUFFIX = 'Dir';\nexports.ANYMATCH_OPTS = {dot: true};\nexports.STRING_TYPE = 'string';\nexports.FUNCTION_TYPE = 'function';\nexports.EMPTY_STR = '';\nexports.EMPTY_FN = () => {};\nexports.IDENTITY_FN = val => val;\n\nexports.isWindows = platform === 'win32';\nexports.isMacos = platform === 'darwin';\nexports.isLinux = platform === 'linux';\nexports.isIBMi = os.type() === 'OS400';\n","'use strict';\n\nconst fs = require('fs');\nconst sysPath = require('path');\nconst { promisify } = require('util');\nconst isBinaryPath = require('is-binary-path');\nconst {\n  isWindows,\n  isLinux,\n  EMPTY_FN,\n  EMPTY_STR,\n  KEY_LISTENERS,\n  KEY_ERR,\n  KEY_RAW,\n  HANDLER_KEYS,\n  EV_CHANGE,\n  EV_ADD,\n  EV_ADD_DIR,\n  EV_ERROR,\n  STR_DATA,\n  STR_END,\n  BRACE_START,\n  STAR\n} = require('./constants');\n\nconst THROTTLE_MODE_WATCH = 'watch';\n\nconst open = promisify(fs.open);\nconst stat = promisify(fs.stat);\nconst lstat = promisify(fs.lstat);\nconst close = promisify(fs.close);\nconst fsrealpath = promisify(fs.realpath);\n\nconst statMethods = { lstat, stat };\n\n// TODO: emit errors properly. Example: EMFILE on Macos.\nconst foreach = (val, fn) => {\n  if (val instanceof Set) {\n    val.forEach(fn);\n  } else {\n    fn(val);\n  }\n};\n\nconst addAndConvert = (main, prop, item) => {\n  let container = main[prop];\n  if (!(container instanceof Set)) {\n    main[prop] = container = new Set([container]);\n  }\n  container.add(item);\n};\n\nconst clearItem = cont => key => {\n  const set = cont[key];\n  if (set instanceof Set) {\n    set.clear();\n  } else {\n    delete cont[key];\n  }\n};\n\nconst delFromSet = (main, prop, item) => {\n  const container = main[prop];\n  if (container instanceof Set) {\n    container.delete(item);\n  } else if (container === item) {\n    delete main[prop];\n  }\n};\n\nconst isEmptySet = (val) => val instanceof Set ? val.size === 0 : !val;\n\n/**\n * @typedef {String} Path\n */\n\n// fs_watch helpers\n\n// object to hold per-process fs_watch instances\n// (may be shared across chokidar FSWatcher instances)\n\n/**\n * @typedef {Object} FsWatchContainer\n * @property {Set} listeners\n * @property {Set} errHandlers\n * @property {Set} rawEmitters\n * @property {fs.FSWatcher=} watcher\n * @property {Boolean=} watcherUnusable\n */\n\n/**\n * @type {Map<String,FsWatchContainer>}\n */\nconst FsWatchInstances = new Map();\n\n/**\n * Instantiates the fs_watch interface\n * @param {String} path to be watched\n * @param {Object} options to be passed to fs_watch\n * @param {Function} listener main event handler\n * @param {Function} errHandler emits info about errors\n * @param {Function} emitRaw emits raw event data\n * @returns {fs.FSWatcher} new fsevents instance\n */\nfunction createFsWatchInstance(path, options, listener, errHandler, emitRaw) {\n  const handleEvent = (rawEvent, evPath) => {\n    listener(path);\n    emitRaw(rawEvent, evPath, {watchedPath: path});\n\n    // emit based on events occurring for files from a directory's watcher in\n    // case the file's watcher misses it (and rely on throttling to de-dupe)\n    if (evPath && path !== evPath) {\n      fsWatchBroadcast(\n        sysPath.resolve(path, evPath), KEY_LISTENERS, sysPath.join(path, evPath)\n      );\n    }\n  };\n  try {\n    return fs.watch(path, options, handleEvent);\n  } catch (error) {\n    errHandler(error);\n  }\n}\n\n/**\n * Helper for passing fs_watch event data to a collection of listeners\n * @param {Path} fullPath absolute path bound to fs_watch instance\n * @param {String} type listener type\n * @param {*=} val1 arguments to be passed to listeners\n * @param {*=} val2\n * @param {*=} val3\n */\nconst fsWatchBroadcast = (fullPath, type, val1, val2, val3) => {\n  const cont = FsWatchInstances.get(fullPath);\n  if (!cont) return;\n  foreach(cont[type], (listener) => {\n    listener(val1, val2, val3);\n  });\n};\n\n/**\n * Instantiates the fs_watch interface or binds listeners\n * to an existing one covering the same file system entry\n * @param {String} path\n * @param {String} fullPath absolute path\n * @param {Object} options to be passed to fs_watch\n * @param {Object} handlers container for event listener functions\n */\nconst setFsWatchListener = (path, fullPath, options, handlers) => {\n  const {listener, errHandler, rawEmitter} = handlers;\n  let cont = FsWatchInstances.get(fullPath);\n\n  /** @type {fs.FSWatcher=} */\n  let watcher;\n  if (!options.persistent) {\n    watcher = createFsWatchInstance(\n      path, options, listener, errHandler, rawEmitter\n    );\n    return watcher.close.bind(watcher);\n  }\n  if (cont) {\n    addAndConvert(cont, KEY_LISTENERS, listener);\n    addAndConvert(cont, KEY_ERR, errHandler);\n    addAndConvert(cont, KEY_RAW, rawEmitter);\n  } else {\n    watcher = createFsWatchInstance(\n      path,\n      options,\n      fsWatchBroadcast.bind(null, fullPath, KEY_LISTENERS),\n      errHandler, // no need to use broadcast here\n      fsWatchBroadcast.bind(null, fullPath, KEY_RAW)\n    );\n    if (!watcher) return;\n    watcher.on(EV_ERROR, async (error) => {\n      const broadcastErr = fsWatchBroadcast.bind(null, fullPath, KEY_ERR);\n      cont.watcherUnusable = true; // documented since Node 10.4.1\n      // Workaround for https://github.com/joyent/node/issues/4337\n      if (isWindows && error.code === 'EPERM') {\n        try {\n          const fd = await open(path, 'r');\n          await close(fd);\n          broadcastErr(error);\n        } catch (err) {}\n      } else {\n        broadcastErr(error);\n      }\n    });\n    cont = {\n      listeners: listener,\n      errHandlers: errHandler,\n      rawEmitters: rawEmitter,\n      watcher\n    };\n    FsWatchInstances.set(fullPath, cont);\n  }\n  // const index = cont.listeners.indexOf(listener);\n\n  // removes this instance's listeners and closes the underlying fs_watch\n  // instance if there are no more listeners left\n  return () => {\n    delFromSet(cont, KEY_LISTENERS, listener);\n    delFromSet(cont, KEY_ERR, errHandler);\n    delFromSet(cont, KEY_RAW, rawEmitter);\n    if (isEmptySet(cont.listeners)) {\n      // Check to protect against issue gh-730.\n      // if (cont.watcherUnusable) {\n      cont.watcher.close();\n      // }\n      FsWatchInstances.delete(fullPath);\n      HANDLER_KEYS.forEach(clearItem(cont));\n      cont.watcher = undefined;\n      Object.freeze(cont);\n    }\n  };\n};\n\n// fs_watchFile helpers\n\n// object to hold per-process fs_watchFile instances\n// (may be shared across chokidar FSWatcher instances)\nconst FsWatchFileInstances = new Map();\n\n/**\n * Instantiates the fs_watchFile interface or binds listeners\n * to an existing one covering the same file system entry\n * @param {String} path to be watched\n * @param {String} fullPath absolute path\n * @param {Object} options options to be passed to fs_watchFile\n * @param {Object} handlers container for event listener functions\n * @returns {Function} closer\n */\nconst setFsWatchFileListener = (path, fullPath, options, handlers) => {\n  const {listener, rawEmitter} = handlers;\n  let cont = FsWatchFileInstances.get(fullPath);\n\n  /* eslint-disable no-unused-vars, prefer-destructuring */\n  let listeners = new Set();\n  let rawEmitters = new Set();\n\n  const copts = cont && cont.options;\n  if (copts && (copts.persistent < options.persistent || copts.interval > options.interval)) {\n    // \"Upgrade\" the watcher to persistence or a quicker interval.\n    // This creates some unlikely edge case issues if the user mixes\n    // settings in a very weird way, but solving for those cases\n    // doesn't seem worthwhile for the added complexity.\n    listeners = cont.listeners;\n    rawEmitters = cont.rawEmitters;\n    fs.unwatchFile(fullPath);\n    cont = undefined;\n  }\n\n  /* eslint-enable no-unused-vars, prefer-destructuring */\n\n  if (cont) {\n    addAndConvert(cont, KEY_LISTENERS, listener);\n    addAndConvert(cont, KEY_RAW, rawEmitter);\n  } else {\n    // TODO\n    // listeners.add(listener);\n    // rawEmitters.add(rawEmitter);\n    cont = {\n      listeners: listener,\n      rawEmitters: rawEmitter,\n      options,\n      watcher: fs.watchFile(fullPath, options, (curr, prev) => {\n        foreach(cont.rawEmitters, (rawEmitter) => {\n          rawEmitter(EV_CHANGE, fullPath, {curr, prev});\n        });\n        const currmtime = curr.mtimeMs;\n        if (curr.size !== prev.size || currmtime > prev.mtimeMs || currmtime === 0) {\n          foreach(cont.listeners, (listener) => listener(path, curr));\n        }\n      })\n    };\n    FsWatchFileInstances.set(fullPath, cont);\n  }\n  // const index = cont.listeners.indexOf(listener);\n\n  // Removes this instance's listeners and closes the underlying fs_watchFile\n  // instance if there are no more listeners left.\n  return () => {\n    delFromSet(cont, KEY_LISTENERS, listener);\n    delFromSet(cont, KEY_RAW, rawEmitter);\n    if (isEmptySet(cont.listeners)) {\n      FsWatchFileInstances.delete(fullPath);\n      fs.unwatchFile(fullPath);\n      cont.options = cont.watcher = undefined;\n      Object.freeze(cont);\n    }\n  };\n};\n\n/**\n * @mixin\n */\nclass NodeFsHandler {\n\n/**\n * @param {import(\"../index\").FSWatcher} fsW\n */\nconstructor(fsW) {\n  this.fsw = fsW;\n  this._boundHandleError = (error) => fsW._handleError(error);\n}\n\n/**\n * Watch file for changes with fs_watchFile or fs_watch.\n * @param {String} path to file or dir\n * @param {Function} listener on fs change\n * @returns {Function} closer for the watcher instance\n */\n_watchWithNodeFs(path, listener) {\n  const opts = this.fsw.options;\n  const directory = sysPath.dirname(path);\n  const basename = sysPath.basename(path);\n  const parent = this.fsw._getWatchedDir(directory);\n  parent.add(basename);\n  const absolutePath = sysPath.resolve(path);\n  const options = {persistent: opts.persistent};\n  if (!listener) listener = EMPTY_FN;\n\n  let closer;\n  if (opts.usePolling) {\n    options.interval = opts.enableBinaryInterval && isBinaryPath(basename) ?\n      opts.binaryInterval : opts.interval;\n    closer = setFsWatchFileListener(path, absolutePath, options, {\n      listener,\n      rawEmitter: this.fsw._emitRaw\n    });\n  } else {\n    closer = setFsWatchListener(path, absolutePath, options, {\n      listener,\n      errHandler: this._boundHandleError,\n      rawEmitter: this.fsw._emitRaw\n    });\n  }\n  return closer;\n}\n\n/**\n * Watch a file and emit add event if warranted.\n * @param {Path} file Path\n * @param {fs.Stats} stats result of fs_stat\n * @param {Boolean} initialAdd was the file added at watch instantiation?\n * @returns {Function} closer for the watcher instance\n */\n_handleFile(file, stats, initialAdd) {\n  if (this.fsw.closed) {\n    return;\n  }\n  const dirname = sysPath.dirname(file);\n  const basename = sysPath.basename(file);\n  const parent = this.fsw._getWatchedDir(dirname);\n  // stats is always present\n  let prevStats = stats;\n\n  // if the file is already being watched, do nothing\n  if (parent.has(basename)) return;\n\n  const listener = async (path, newStats) => {\n    if (!this.fsw._throttle(THROTTLE_MODE_WATCH, file, 5)) return;\n    if (!newStats || newStats.mtimeMs === 0) {\n      try {\n        const newStats = await stat(file);\n        if (this.fsw.closed) return;\n        // Check that change event was not fired because of changed only accessTime.\n        const at = newStats.atimeMs;\n        const mt = newStats.mtimeMs;\n        if (!at || at <= mt || mt !== prevStats.mtimeMs) {\n          this.fsw._emit(EV_CHANGE, file, newStats);\n        }\n        if (isLinux && prevStats.ino !== newStats.ino) {\n          this.fsw._closeFile(path)\n          prevStats = newStats;\n          this.fsw._addPathCloser(path, this._watchWithNodeFs(file, listener));\n        } else {\n          prevStats = newStats;\n        }\n      } catch (error) {\n        // Fix issues where mtime is null but file is still present\n        this.fsw._remove(dirname, basename);\n      }\n      // add is about to be emitted if file not already tracked in parent\n    } else if (parent.has(basename)) {\n      // Check that change event was not fired because of changed only accessTime.\n      const at = newStats.atimeMs;\n      const mt = newStats.mtimeMs;\n      if (!at || at <= mt || mt !== prevStats.mtimeMs) {\n        this.fsw._emit(EV_CHANGE, file, newStats);\n      }\n      prevStats = newStats;\n    }\n  }\n  // kick off the watcher\n  const closer = this._watchWithNodeFs(file, listener);\n\n  // emit an add event if we're supposed to\n  if (!(initialAdd && this.fsw.options.ignoreInitial) && this.fsw._isntIgnored(file)) {\n    if (!this.fsw._throttle(EV_ADD, file, 0)) return;\n    this.fsw._emit(EV_ADD, file, stats);\n  }\n\n  return closer;\n}\n\n/**\n * Handle symlinks encountered while reading a dir.\n * @param {Object} entry returned by readdirp\n * @param {String} directory path of dir being read\n * @param {String} path of this item\n * @param {String} item basename of this item\n * @returns {Promise<Boolean>} true if no more processing is needed for this entry.\n */\nasync _handleSymlink(entry, directory, path, item) {\n  if (this.fsw.closed) {\n    return;\n  }\n  const full = entry.fullPath;\n  const dir = this.fsw._getWatchedDir(directory);\n\n  if (!this.fsw.options.followSymlinks) {\n    // watch symlink directly (don't follow) and detect changes\n    this.fsw._incrReadyCount();\n\n    let linkPath;\n    try {\n      linkPath = await fsrealpath(path);\n    } catch (e) {\n      this.fsw._emitReady();\n      return true;\n    }\n\n    if (this.fsw.closed) return;\n    if (dir.has(item)) {\n      if (this.fsw._symlinkPaths.get(full) !== linkPath) {\n        this.fsw._symlinkPaths.set(full, linkPath);\n        this.fsw._emit(EV_CHANGE, path, entry.stats);\n      }\n    } else {\n      dir.add(item);\n      this.fsw._symlinkPaths.set(full, linkPath);\n      this.fsw._emit(EV_ADD, path, entry.stats);\n    }\n    this.fsw._emitReady();\n    return true;\n  }\n\n  // don't follow the same symlink more than once\n  if (this.fsw._symlinkPaths.has(full)) {\n    return true;\n  }\n\n  this.fsw._symlinkPaths.set(full, true);\n}\n\n_handleRead(directory, initialAdd, wh, target, dir, depth, throttler) {\n  // Normalize the directory name on Windows\n  directory = sysPath.join(directory, EMPTY_STR);\n\n  if (!wh.hasGlob) {\n    throttler = this.fsw._throttle('readdir', directory, 1000);\n    if (!throttler) return;\n  }\n\n  const previous = this.fsw._getWatchedDir(wh.path);\n  const current = new Set();\n\n  let stream = this.fsw._readdirp(directory, {\n    fileFilter: entry => wh.filterPath(entry),\n    directoryFilter: entry => wh.filterDir(entry),\n    depth: 0\n  }).on(STR_DATA, async (entry) => {\n    if (this.fsw.closed) {\n      stream = undefined;\n      return;\n    }\n    const item = entry.path;\n    let path = sysPath.join(directory, item);\n    current.add(item);\n\n    if (entry.stats.isSymbolicLink() && await this._handleSymlink(entry, directory, path, item)) {\n      return;\n    }\n\n    if (this.fsw.closed) {\n      stream = undefined;\n      return;\n    }\n    // Files that present in current directory snapshot\n    // but absent in previous are added to watch list and\n    // emit `add` event.\n    if (item === target || !target && !previous.has(item)) {\n      this.fsw._incrReadyCount();\n\n      // ensure relativeness of path is preserved in case of watcher reuse\n      path = sysPath.join(dir, sysPath.relative(dir, path));\n\n      this._addToNodeFs(path, initialAdd, wh, depth + 1);\n    }\n  }).on(EV_ERROR, this._boundHandleError);\n\n  return new Promise(resolve =>\n    stream.once(STR_END, () => {\n      if (this.fsw.closed) {\n        stream = undefined;\n        return;\n      }\n      const wasThrottled = throttler ? throttler.clear() : false;\n\n      resolve();\n\n      // Files that absent in current directory snapshot\n      // but present in previous emit `remove` event\n      // and are removed from @watched[directory].\n      previous.getChildren().filter((item) => {\n        return item !== directory &&\n          !current.has(item) &&\n          // in case of intersecting globs;\n          // a path may have been filtered out of this readdir, but\n          // shouldn't be removed because it matches a different glob\n          (!wh.hasGlob || wh.filterPath({\n            fullPath: sysPath.resolve(directory, item)\n          }));\n      }).forEach((item) => {\n        this.fsw._remove(directory, item);\n      });\n\n      stream = undefined;\n\n      // one more time for any missed in case changes came in extremely quickly\n      if (wasThrottled) this._handleRead(directory, false, wh, target, dir, depth, throttler);\n    })\n  );\n}\n\n/**\n * Read directory to add / remove files from `@watched` list and re-read it on change.\n * @param {String} dir fs path\n * @param {fs.Stats} stats\n * @param {Boolean} initialAdd\n * @param {Number} depth relative to user-supplied path\n * @param {String} target child path targeted for watch\n * @param {Object} wh Common watch helpers for this path\n * @param {String} realpath\n * @returns {Promise<Function>} closer for the watcher instance.\n */\nasync _handleDir(dir, stats, initialAdd, depth, target, wh, realpath) {\n  const parentDir = this.fsw._getWatchedDir(sysPath.dirname(dir));\n  const tracked = parentDir.has(sysPath.basename(dir));\n  if (!(initialAdd && this.fsw.options.ignoreInitial) && !target && !tracked) {\n    if (!wh.hasGlob || wh.globFilter(dir)) this.fsw._emit(EV_ADD_DIR, dir, stats);\n  }\n\n  // ensure dir is tracked (harmless if redundant)\n  parentDir.add(sysPath.basename(dir));\n  this.fsw._getWatchedDir(dir);\n  let throttler;\n  let closer;\n\n  const oDepth = this.fsw.options.depth;\n  if ((oDepth == null || depth <= oDepth) && !this.fsw._symlinkPaths.has(realpath)) {\n    if (!target) {\n      await this._handleRead(dir, initialAdd, wh, target, dir, depth, throttler);\n      if (this.fsw.closed) return;\n    }\n\n    closer = this._watchWithNodeFs(dir, (dirPath, stats) => {\n      // if current directory is removed, do nothing\n      if (stats && stats.mtimeMs === 0) return;\n\n      this._handleRead(dirPath, false, wh, target, dir, depth, throttler);\n    });\n  }\n  return closer;\n}\n\n/**\n * Handle added file, directory, or glob pattern.\n * Delegates call to _handleFile / _handleDir after checks.\n * @param {String} path to file or ir\n * @param {Boolean} initialAdd was the file added at watch instantiation?\n * @param {Object} priorWh depth relative to user-supplied path\n * @param {Number} depth Child path actually targeted for watch\n * @param {String=} target Child path actually targeted for watch\n * @returns {Promise}\n */\nasync _addToNodeFs(path, initialAdd, priorWh, depth, target) {\n  const ready = this.fsw._emitReady;\n  if (this.fsw._isIgnored(path) || this.fsw.closed) {\n    ready();\n    return false;\n  }\n\n  const wh = this.fsw._getWatchHelpers(path, depth);\n  if (!wh.hasGlob && priorWh) {\n    wh.hasGlob = priorWh.hasGlob;\n    wh.globFilter = priorWh.globFilter;\n    wh.filterPath = entry => priorWh.filterPath(entry);\n    wh.filterDir = entry => priorWh.filterDir(entry);\n  }\n\n  // evaluate what is at the path we're being asked to watch\n  try {\n    const stats = await statMethods[wh.statMethod](wh.watchPath);\n    if (this.fsw.closed) return;\n    if (this.fsw._isIgnored(wh.watchPath, stats)) {\n      ready();\n      return false;\n    }\n\n    const follow = this.fsw.options.followSymlinks && !path.includes(STAR) && !path.includes(BRACE_START);\n    let closer;\n    if (stats.isDirectory()) {\n      const absPath = sysPath.resolve(path);\n      const targetPath = follow ? await fsrealpath(path) : path;\n      if (this.fsw.closed) return;\n      closer = await this._handleDir(wh.watchPath, stats, initialAdd, depth, target, wh, targetPath);\n      if (this.fsw.closed) return;\n      // preserve this symlink's target path\n      if (absPath !== targetPath && targetPath !== undefined) {\n        this.fsw._symlinkPaths.set(absPath, targetPath);\n      }\n    } else if (stats.isSymbolicLink()) {\n      const targetPath = follow ? await fsrealpath(path) : path;\n      if (this.fsw.closed) return;\n      const parent = sysPath.dirname(wh.watchPath);\n      this.fsw._getWatchedDir(parent).add(wh.watchPath);\n      this.fsw._emit(EV_ADD, wh.watchPath, stats);\n      closer = await this._handleDir(parent, stats, initialAdd, depth, path, wh, targetPath);\n      if (this.fsw.closed) return;\n\n      // preserve this symlink's target path\n      if (targetPath !== undefined) {\n        this.fsw._symlinkPaths.set(sysPath.resolve(path), targetPath);\n      }\n    } else {\n      closer = this._handleFile(wh.watchPath, stats, initialAdd);\n    }\n    ready();\n\n    this.fsw._addPathCloser(path, closer);\n    return false;\n\n  } catch (error) {\n    if (this.fsw._handleError(error)) {\n      ready();\n      return path;\n    }\n  }\n}\n\n}\n\nmodule.exports = NodeFsHandler;\n","'use strict';\n\nconst fs = require('fs');\nconst sysPath = require('path');\nconst { promisify } = require('util');\n\nlet fsevents;\ntry {\n  fsevents = require('fsevents');\n} catch (error) {\n  if (process.env.CHOKIDAR_PRINT_FSEVENTS_REQUIRE_ERROR) console.error(error);\n}\n\nif (fsevents) {\n  // TODO: real check\n  const mtch = process.version.match(/v(\\d+)\\.(\\d+)/);\n  if (mtch && mtch[1] && mtch[2]) {\n    const maj = Number.parseInt(mtch[1], 10);\n    const min = Number.parseInt(mtch[2], 10);\n    if (maj === 8 && min < 16) {\n      fsevents = undefined;\n    }\n  }\n}\n\nconst {\n  EV_ADD,\n  EV_CHANGE,\n  EV_ADD_DIR,\n  EV_UNLINK,\n  EV_ERROR,\n  STR_DATA,\n  STR_END,\n  FSEVENT_CREATED,\n  FSEVENT_MODIFIED,\n  FSEVENT_DELETED,\n  FSEVENT_MOVED,\n  // FSEVENT_CLONED,\n  FSEVENT_UNKNOWN,\n  FSEVENT_FLAG_MUST_SCAN_SUBDIRS,\n  FSEVENT_TYPE_FILE,\n  FSEVENT_TYPE_DIRECTORY,\n  FSEVENT_TYPE_SYMLINK,\n\n  ROOT_GLOBSTAR,\n  DIR_SUFFIX,\n  DOT_SLASH,\n  FUNCTION_TYPE,\n  EMPTY_FN,\n  IDENTITY_FN\n} = require('./constants');\n\nconst Depth = (value) => isNaN(value) ? {} : {depth: value};\n\nconst stat = promisify(fs.stat);\nconst lstat = promisify(fs.lstat);\nconst realpath = promisify(fs.realpath);\n\nconst statMethods = { stat, lstat };\n\n/**\n * @typedef {String} Path\n */\n\n/**\n * @typedef {Object} FsEventsWatchContainer\n * @property {Set<Function>} listeners\n * @property {Function} rawEmitter\n * @property {{stop: Function}} watcher\n */\n\n// fsevents instance helper functions\n/**\n * Object to hold per-process fsevents instances (may be shared across chokidar FSWatcher instances)\n * @type {Map<Path,FsEventsWatchContainer>}\n */\nconst FSEventsWatchers = new Map();\n\n// Threshold of duplicate path prefixes at which to start\n// consolidating going forward\nconst consolidateThreshhold = 10;\n\nconst wrongEventFlags = new Set([\n  69888, 70400, 71424, 72704, 73472, 131328, 131840, 262912\n]);\n\n/**\n * Instantiates the fsevents interface\n * @param {Path} path path to be watched\n * @param {Function} callback called when fsevents is bound and ready\n * @returns {{stop: Function}} new fsevents instance\n */\nconst createFSEventsInstance = (path, callback) => {\n  const stop = fsevents.watch(path, callback);\n  return {stop};\n};\n\n/**\n * Instantiates the fsevents interface or binds listeners to an existing one covering\n * the same file tree.\n * @param {Path} path           - to be watched\n * @param {Path} realPath       - real path for symlinks\n * @param {Function} listener   - called when fsevents emits events\n * @param {Function} rawEmitter - passes data to listeners of the 'raw' event\n * @returns {Function} closer\n */\nfunction setFSEventsListener(path, realPath, listener, rawEmitter) {\n  let watchPath = sysPath.extname(realPath) ? sysPath.dirname(realPath) : realPath;\n\n  const parentPath = sysPath.dirname(watchPath);\n  let cont = FSEventsWatchers.get(watchPath);\n\n  // If we've accumulated a substantial number of paths that\n  // could have been consolidated by watching one directory\n  // above the current one, create a watcher on the parent\n  // path instead, so that we do consolidate going forward.\n  if (couldConsolidate(parentPath)) {\n    watchPath = parentPath;\n  }\n\n  const resolvedPath = sysPath.resolve(path);\n  const hasSymlink = resolvedPath !== realPath;\n\n  const filteredListener = (fullPath, flags, info) => {\n    if (hasSymlink) fullPath = fullPath.replace(realPath, resolvedPath);\n    if (\n      fullPath === resolvedPath ||\n      !fullPath.indexOf(resolvedPath + sysPath.sep)\n    ) listener(fullPath, flags, info);\n  };\n\n  // check if there is already a watcher on a parent path\n  // modifies `watchPath` to the parent path when it finds a match\n  let watchedParent = false;\n  for (const watchedPath of FSEventsWatchers.keys()) {\n    if (realPath.indexOf(sysPath.resolve(watchedPath) + sysPath.sep) === 0) {\n      watchPath = watchedPath;\n      cont = FSEventsWatchers.get(watchPath);\n      watchedParent = true;\n      break;\n    }\n  }\n\n  if (cont || watchedParent) {\n    cont.listeners.add(filteredListener);\n  } else {\n    cont = {\n      listeners: new Set([filteredListener]),\n      rawEmitter,\n      watcher: createFSEventsInstance(watchPath, (fullPath, flags) => {\n        if (!cont.listeners.size) return;\n        if (flags & FSEVENT_FLAG_MUST_SCAN_SUBDIRS) return;\n        const info = fsevents.getInfo(fullPath, flags);\n        cont.listeners.forEach(list => {\n          list(fullPath, flags, info);\n        });\n\n        cont.rawEmitter(info.event, fullPath, info);\n      })\n    };\n    FSEventsWatchers.set(watchPath, cont);\n  }\n\n  // removes this instance's listeners and closes the underlying fsevents\n  // instance if there are no more listeners left\n  return () => {\n    const lst = cont.listeners;\n\n    lst.delete(filteredListener);\n    if (!lst.size) {\n      FSEventsWatchers.delete(watchPath);\n      if (cont.watcher) return cont.watcher.stop().then(() => {\n        cont.rawEmitter = cont.watcher = undefined;\n        Object.freeze(cont);\n      });\n    }\n  };\n}\n\n// Decide whether or not we should start a new higher-level\n// parent watcher\nconst couldConsolidate = (path) => {\n  let count = 0;\n  for (const watchPath of FSEventsWatchers.keys()) {\n    if (watchPath.indexOf(path) === 0) {\n      count++;\n      if (count >= consolidateThreshhold) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\n// returns boolean indicating whether fsevents can be used\nconst canUse = () => fsevents && FSEventsWatchers.size < 128;\n\n// determines subdirectory traversal levels from root to path\nconst calcDepth = (path, root) => {\n  let i = 0;\n  while (!path.indexOf(root) && (path = sysPath.dirname(path)) !== root) i++;\n  return i;\n};\n\n// returns boolean indicating whether the fsevents' event info has the same type\n// as the one returned by fs.stat\nconst sameTypes = (info, stats) => (\n  info.type === FSEVENT_TYPE_DIRECTORY && stats.isDirectory() ||\n  info.type === FSEVENT_TYPE_SYMLINK && stats.isSymbolicLink() ||\n  info.type === FSEVENT_TYPE_FILE && stats.isFile()\n)\n\n/**\n * @mixin\n */\nclass FsEventsHandler {\n\n/**\n * @param {import('../index').FSWatcher} fsw\n */\nconstructor(fsw) {\n  this.fsw = fsw;\n}\ncheckIgnored(path, stats) {\n  const ipaths = this.fsw._ignoredPaths;\n  if (this.fsw._isIgnored(path, stats)) {\n    ipaths.add(path);\n    if (stats && stats.isDirectory()) {\n      ipaths.add(path + ROOT_GLOBSTAR);\n    }\n    return true;\n  }\n\n  ipaths.delete(path);\n  ipaths.delete(path + ROOT_GLOBSTAR);\n}\n\naddOrChange(path, fullPath, realPath, parent, watchedDir, item, info, opts) {\n  const event = watchedDir.has(item) ? EV_CHANGE : EV_ADD;\n  this.handleEvent(event, path, fullPath, realPath, parent, watchedDir, item, info, opts);\n}\n\nasync checkExists(path, fullPath, realPath, parent, watchedDir, item, info, opts) {\n  try {\n    const stats = await stat(path)\n    if (this.fsw.closed) return;\n    if (sameTypes(info, stats)) {\n      this.addOrChange(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n    } else {\n      this.handleEvent(EV_UNLINK, path, fullPath, realPath, parent, watchedDir, item, info, opts);\n    }\n  } catch (error) {\n    if (error.code === 'EACCES') {\n      this.addOrChange(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n    } else {\n      this.handleEvent(EV_UNLINK, path, fullPath, realPath, parent, watchedDir, item, info, opts);\n    }\n  }\n}\n\nhandleEvent(event, path, fullPath, realPath, parent, watchedDir, item, info, opts) {\n  if (this.fsw.closed || this.checkIgnored(path)) return;\n\n  if (event === EV_UNLINK) {\n    const isDirectory = info.type === FSEVENT_TYPE_DIRECTORY\n    // suppress unlink events on never before seen files\n    if (isDirectory || watchedDir.has(item)) {\n      this.fsw._remove(parent, item, isDirectory);\n    }\n  } else {\n    if (event === EV_ADD) {\n      // track new directories\n      if (info.type === FSEVENT_TYPE_DIRECTORY) this.fsw._getWatchedDir(path);\n\n      if (info.type === FSEVENT_TYPE_SYMLINK && opts.followSymlinks) {\n        // push symlinks back to the top of the stack to get handled\n        const curDepth = opts.depth === undefined ?\n          undefined : calcDepth(fullPath, realPath) + 1;\n        return this._addToFsEvents(path, false, true, curDepth);\n      }\n\n      // track new paths\n      // (other than symlinks being followed, which will be tracked soon)\n      this.fsw._getWatchedDir(parent).add(item);\n    }\n    /**\n     * @type {'add'|'addDir'|'unlink'|'unlinkDir'}\n     */\n    const eventName = info.type === FSEVENT_TYPE_DIRECTORY ? event + DIR_SUFFIX : event;\n    this.fsw._emit(eventName, path);\n    if (eventName === EV_ADD_DIR) this._addToFsEvents(path, false, true);\n  }\n}\n\n/**\n * Handle symlinks encountered during directory scan\n * @param {String} watchPath  - file/dir path to be watched with fsevents\n * @param {String} realPath   - real path (in case of symlinks)\n * @param {Function} transform  - path transformer\n * @param {Function} globFilter - path filter in case a glob pattern was provided\n * @returns {Function} closer for the watcher instance\n*/\n_watchWithFsEvents(watchPath, realPath, transform, globFilter) {\n  if (this.fsw.closed || this.fsw._isIgnored(watchPath)) return;\n  const opts = this.fsw.options;\n  const watchCallback = async (fullPath, flags, info) => {\n    if (this.fsw.closed) return;\n    if (\n      opts.depth !== undefined &&\n      calcDepth(fullPath, realPath) > opts.depth\n    ) return;\n    const path = transform(sysPath.join(\n      watchPath, sysPath.relative(watchPath, fullPath)\n    ));\n    if (globFilter && !globFilter(path)) return;\n    // ensure directories are tracked\n    const parent = sysPath.dirname(path);\n    const item = sysPath.basename(path);\n    const watchedDir = this.fsw._getWatchedDir(\n      info.type === FSEVENT_TYPE_DIRECTORY ? path : parent\n    );\n\n    // correct for wrong events emitted\n    if (wrongEventFlags.has(flags) || info.event === FSEVENT_UNKNOWN) {\n      if (typeof opts.ignored === FUNCTION_TYPE) {\n        let stats;\n        try {\n          stats = await stat(path);\n        } catch (error) {}\n        if (this.fsw.closed) return;\n        if (this.checkIgnored(path, stats)) return;\n        if (sameTypes(info, stats)) {\n          this.addOrChange(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n        } else {\n          this.handleEvent(EV_UNLINK, path, fullPath, realPath, parent, watchedDir, item, info, opts);\n        }\n      } else {\n        this.checkExists(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n      }\n    } else {\n      switch (info.event) {\n      case FSEVENT_CREATED:\n      case FSEVENT_MODIFIED:\n        return this.addOrChange(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n      case FSEVENT_DELETED:\n      case FSEVENT_MOVED:\n        return this.checkExists(path, fullPath, realPath, parent, watchedDir, item, info, opts);\n      }\n    }\n  };\n\n  const closer = setFSEventsListener(\n    watchPath,\n    realPath,\n    watchCallback,\n    this.fsw._emitRaw\n  );\n\n  this.fsw._emitReady();\n  return closer;\n}\n\n/**\n * Handle symlinks encountered during directory scan\n * @param {String} linkPath path to symlink\n * @param {String} fullPath absolute path to the symlink\n * @param {Function} transform pre-existing path transformer\n * @param {Number} curDepth level of subdirectories traversed to where symlink is\n * @returns {Promise<void>}\n */\nasync _handleFsEventsSymlink(linkPath, fullPath, transform, curDepth) {\n  // don't follow the same symlink more than once\n  if (this.fsw.closed || this.fsw._symlinkPaths.has(fullPath)) return;\n\n  this.fsw._symlinkPaths.set(fullPath, true);\n  this.fsw._incrReadyCount();\n\n  try {\n    const linkTarget = await realpath(linkPath);\n    if (this.fsw.closed) return;\n    if (this.fsw._isIgnored(linkTarget)) {\n      return this.fsw._emitReady();\n    }\n\n    this.fsw._incrReadyCount();\n\n    // add the linkTarget for watching with a wrapper for transform\n    // that causes emitted paths to incorporate the link's path\n    this._addToFsEvents(linkTarget || linkPath, (path) => {\n      let aliasedPath = linkPath;\n      if (linkTarget && linkTarget !== DOT_SLASH) {\n        aliasedPath = path.replace(linkTarget, linkPath);\n      } else if (path !== DOT_SLASH) {\n        aliasedPath = sysPath.join(linkPath, path);\n      }\n      return transform(aliasedPath);\n    }, false, curDepth);\n  } catch(error) {\n    if (this.fsw._handleError(error)) {\n      return this.fsw._emitReady();\n    }\n  }\n}\n\n/**\n *\n * @param {Path} newPath\n * @param {fs.Stats} stats\n */\nemitAdd(newPath, stats, processPath, opts, forceAdd) {\n  const pp = processPath(newPath);\n  const isDir = stats.isDirectory();\n  const dirObj = this.fsw._getWatchedDir(sysPath.dirname(pp));\n  const base = sysPath.basename(pp);\n\n  // ensure empty dirs get tracked\n  if (isDir) this.fsw._getWatchedDir(pp);\n  if (dirObj.has(base)) return;\n  dirObj.add(base);\n\n  if (!opts.ignoreInitial || forceAdd === true) {\n    this.fsw._emit(isDir ? EV_ADD_DIR : EV_ADD, pp, stats);\n  }\n}\n\ninitWatch(realPath, path, wh, processPath) {\n  if (this.fsw.closed) return;\n  const closer = this._watchWithFsEvents(\n    wh.watchPath,\n    sysPath.resolve(realPath || wh.watchPath),\n    processPath,\n    wh.globFilter\n  );\n  this.fsw._addPathCloser(path, closer);\n}\n\n/**\n * Handle added path with fsevents\n * @param {String} path file/dir path or glob pattern\n * @param {Function|Boolean=} transform converts working path to what the user expects\n * @param {Boolean=} forceAdd ensure add is emitted\n * @param {Number=} priorDepth Level of subdirectories already traversed.\n * @returns {Promise<void>}\n */\nasync _addToFsEvents(path, transform, forceAdd, priorDepth) {\n  if (this.fsw.closed) {\n    return;\n  }\n  const opts = this.fsw.options;\n  const processPath = typeof transform === FUNCTION_TYPE ? transform : IDENTITY_FN;\n\n  const wh = this.fsw._getWatchHelpers(path);\n\n  // evaluate what is at the path we're being asked to watch\n  try {\n    const stats = await statMethods[wh.statMethod](wh.watchPath);\n    if (this.fsw.closed) return;\n    if (this.fsw._isIgnored(wh.watchPath, stats)) {\n      throw null;\n    }\n    if (stats.isDirectory()) {\n      // emit addDir unless this is a glob parent\n      if (!wh.globFilter) this.emitAdd(processPath(path), stats, processPath, opts, forceAdd);\n\n      // don't recurse further if it would exceed depth setting\n      if (priorDepth && priorDepth > opts.depth) return;\n\n      // scan the contents of the dir\n      this.fsw._readdirp(wh.watchPath, {\n        fileFilter: entry => wh.filterPath(entry),\n        directoryFilter: entry => wh.filterDir(entry),\n        ...Depth(opts.depth - (priorDepth || 0))\n      }).on(STR_DATA, (entry) => {\n        // need to check filterPath on dirs b/c filterDir is less restrictive\n        if (this.fsw.closed) {\n          return;\n        }\n        if (entry.stats.isDirectory() && !wh.filterPath(entry)) return;\n\n        const joinedPath = sysPath.join(wh.watchPath, entry.path);\n        const {fullPath} = entry;\n\n        if (wh.followSymlinks && entry.stats.isSymbolicLink()) {\n          // preserve the current depth here since it can't be derived from\n          // real paths past the symlink\n          const curDepth = opts.depth === undefined ?\n            undefined : calcDepth(joinedPath, sysPath.resolve(wh.watchPath)) + 1;\n\n          this._handleFsEventsSymlink(joinedPath, fullPath, processPath, curDepth);\n        } else {\n          this.emitAdd(joinedPath, entry.stats, processPath, opts, forceAdd);\n        }\n      }).on(EV_ERROR, EMPTY_FN).on(STR_END, () => {\n        this.fsw._emitReady();\n      });\n    } else {\n      this.emitAdd(wh.watchPath, stats, processPath, opts, forceAdd);\n      this.fsw._emitReady();\n    }\n  } catch (error) {\n    if (!error || this.fsw._handleError(error)) {\n      // TODO: Strange thing: \"should not choke on an ignored watch path\" will be failed without 2 ready calls -__-\n      this.fsw._emitReady();\n      this.fsw._emitReady();\n    }\n  }\n\n  if (opts.persistent && forceAdd !== true) {\n    if (typeof transform === FUNCTION_TYPE) {\n      // realpath has already been resolved\n      this.initWatch(undefined, path, wh, processPath);\n    } else {\n      let realPath;\n      try {\n        realPath = await realpath(wh.watchPath);\n      } catch (e) {}\n      this.initWatch(realPath, path, wh, processPath);\n    }\n  }\n}\n\n}\n\nmodule.exports = FsEventsHandler;\nmodule.exports.canUse = canUse;\n","'use strict';\n\nconst { EventEmitter } = require('events');\nconst fs = require('fs');\nconst sysPath = require('path');\nconst { promisify } = require('util');\nconst readdirp = require('readdirp');\nconst anymatch = require('anymatch').default;\nconst globParent = require('glob-parent');\nconst isGlob = require('is-glob');\nconst braces = require('braces');\nconst normalizePath = require('normalize-path');\n\nconst NodeFsHandler = require('./lib/nodefs-handler');\nconst FsEventsHandler = require('./lib/fsevents-handler');\nconst {\n  EV_ALL,\n  EV_READY,\n  EV_ADD,\n  EV_CHANGE,\n  EV_UNLINK,\n  EV_ADD_DIR,\n  EV_UNLINK_DIR,\n  EV_RAW,\n  EV_ERROR,\n\n  STR_CLOSE,\n  STR_END,\n\n  BACK_SLASH_RE,\n  DOUBLE_SLASH_RE,\n  SLASH_OR_BACK_SLASH_RE,\n  DOT_RE,\n  REPLACER_RE,\n\n  SLASH,\n  SLASH_SLASH,\n  BRACE_START,\n  BANG,\n  ONE_DOT,\n  TWO_DOTS,\n  GLOBSTAR,\n  SLASH_GLOBSTAR,\n  ANYMATCH_OPTS,\n  STRING_TYPE,\n  FUNCTION_TYPE,\n  EMPTY_STR,\n  EMPTY_FN,\n\n  isWindows,\n  isMacos,\n  isIBMi\n} = require('./lib/constants');\n\nconst stat = promisify(fs.stat);\nconst readdir = promisify(fs.readdir);\n\n/**\n * @typedef {String} Path\n * @typedef {'all'|'add'|'addDir'|'change'|'unlink'|'unlinkDir'|'raw'|'error'|'ready'} EventName\n * @typedef {'readdir'|'watch'|'add'|'remove'|'change'} ThrottleType\n */\n\n/**\n *\n * @typedef {Object} WatchHelpers\n * @property {Boolean} followSymlinks\n * @property {'stat'|'lstat'} statMethod\n * @property {Path} path\n * @property {Path} watchPath\n * @property {Function} entryPath\n * @property {Boolean} hasGlob\n * @property {Object} globFilter\n * @property {Function} filterPath\n * @property {Function} filterDir\n */\n\nconst arrify = (value = []) => Array.isArray(value) ? value : [value];\nconst flatten = (list, result = []) => {\n  list.forEach(item => {\n    if (Array.isArray(item)) {\n      flatten(item, result);\n    } else {\n      result.push(item);\n    }\n  });\n  return result;\n};\n\nconst unifyPaths = (paths_) => {\n  /**\n   * @type {Array<String>}\n   */\n  const paths = flatten(arrify(paths_));\n  if (!paths.every(p => typeof p === STRING_TYPE)) {\n    throw new TypeError(`Non-string provided as watch path: ${paths}`);\n  }\n  return paths.map(normalizePathToUnix);\n};\n\n// If SLASH_SLASH occurs at the beginning of path, it is not replaced\n//     because \"//StoragePC/DrivePool/Movies\" is a valid network path\nconst toUnix = (string) => {\n  let str = string.replace(BACK_SLASH_RE, SLASH);\n  let prepend = false;\n  if (str.startsWith(SLASH_SLASH)) {\n    prepend = true;\n  }\n  while (str.match(DOUBLE_SLASH_RE)) {\n    str = str.replace(DOUBLE_SLASH_RE, SLASH);\n  }\n  if (prepend) {\n    str = SLASH + str;\n  }\n  return str;\n};\n\n// Our version of upath.normalize\n// TODO: this is not equal to path-normalize module - investigate why\nconst normalizePathToUnix = (path) => toUnix(sysPath.normalize(toUnix(path)));\n\nconst normalizeIgnored = (cwd = EMPTY_STR) => (path) => {\n  if (typeof path !== STRING_TYPE) return path;\n  return normalizePathToUnix(sysPath.isAbsolute(path) ? path : sysPath.join(cwd, path));\n};\n\nconst getAbsolutePath = (path, cwd) => {\n  if (sysPath.isAbsolute(path)) {\n    return path;\n  }\n  if (path.startsWith(BANG)) {\n    return BANG + sysPath.join(cwd, path.slice(1));\n  }\n  return sysPath.join(cwd, path);\n};\n\nconst undef = (opts, key) => opts[key] === undefined;\n\n/**\n * Directory entry.\n * @property {Path} path\n * @property {Set<Path>} items\n */\nclass DirEntry {\n  /**\n   * @param {Path} dir\n   * @param {Function} removeWatcher\n   */\n  constructor(dir, removeWatcher) {\n    this.path = dir;\n    this._removeWatcher = removeWatcher;\n    /** @type {Set<Path>} */\n    this.items = new Set();\n  }\n\n  add(item) {\n    const {items} = this;\n    if (!items) return;\n    if (item !== ONE_DOT && item !== TWO_DOTS) items.add(item);\n  }\n\n  async remove(item) {\n    const {items} = this;\n    if (!items) return;\n    items.delete(item);\n    if (items.size > 0) return;\n\n    const dir = this.path;\n    try {\n      await readdir(dir);\n    } catch (err) {\n      if (this._removeWatcher) {\n        this._removeWatcher(sysPath.dirname(dir), sysPath.basename(dir));\n      }\n    }\n  }\n\n  has(item) {\n    const {items} = this;\n    if (!items) return;\n    return items.has(item);\n  }\n\n  /**\n   * @returns {Array<String>}\n   */\n  getChildren() {\n    const {items} = this;\n    if (!items) return;\n    return [...items.values()];\n  }\n\n  dispose() {\n    this.items.clear();\n    delete this.path;\n    delete this._removeWatcher;\n    delete this.items;\n    Object.freeze(this);\n  }\n}\n\nconst STAT_METHOD_F = 'stat';\nconst STAT_METHOD_L = 'lstat';\nclass WatchHelper {\n  constructor(path, watchPath, follow, fsw) {\n    this.fsw = fsw;\n    this.path = path = path.replace(REPLACER_RE, EMPTY_STR);\n    this.watchPath = watchPath;\n    this.fullWatchPath = sysPath.resolve(watchPath);\n    this.hasGlob = watchPath !== path;\n    /** @type {object|boolean} */\n    if (path === EMPTY_STR) this.hasGlob = false;\n    this.globSymlink = this.hasGlob && follow ? undefined : false;\n    this.globFilter = this.hasGlob ? anymatch(path, undefined, ANYMATCH_OPTS) : false;\n    this.dirParts = this.getDirParts(path);\n    this.dirParts.forEach((parts) => {\n      if (parts.length > 1) parts.pop();\n    });\n    this.followSymlinks = follow;\n    this.statMethod = follow ? STAT_METHOD_F : STAT_METHOD_L;\n  }\n\n  checkGlobSymlink(entry) {\n    // only need to resolve once\n    // first entry should always have entry.parentDir === EMPTY_STR\n    if (this.globSymlink === undefined) {\n      this.globSymlink = entry.fullParentDir === this.fullWatchPath ?\n        false : {realPath: entry.fullParentDir, linkPath: this.fullWatchPath};\n    }\n\n    if (this.globSymlink) {\n      return entry.fullPath.replace(this.globSymlink.realPath, this.globSymlink.linkPath);\n    }\n\n    return entry.fullPath;\n  }\n\n  entryPath(entry) {\n    return sysPath.join(this.watchPath,\n      sysPath.relative(this.watchPath, this.checkGlobSymlink(entry))\n    );\n  }\n\n  filterPath(entry) {\n    const {stats} = entry;\n    if (stats && stats.isSymbolicLink()) return this.filterDir(entry);\n    const resolvedPath = this.entryPath(entry);\n    const matchesGlob = this.hasGlob && typeof this.globFilter === FUNCTION_TYPE ?\n      this.globFilter(resolvedPath) : true;\n    return matchesGlob &&\n      this.fsw._isntIgnored(resolvedPath, stats) &&\n      this.fsw._hasReadPermissions(stats);\n  }\n\n  getDirParts(path) {\n    if (!this.hasGlob) return [];\n    const parts = [];\n    const expandedPath = path.includes(BRACE_START) ? braces.expand(path) : [path];\n    expandedPath.forEach((path) => {\n      parts.push(sysPath.relative(this.watchPath, path).split(SLASH_OR_BACK_SLASH_RE));\n    });\n    return parts;\n  }\n\n  filterDir(entry) {\n    if (this.hasGlob) {\n      const entryParts = this.getDirParts(this.checkGlobSymlink(entry));\n      let globstar = false;\n      this.unmatchedGlob = !this.dirParts.some((parts) => {\n        return parts.every((part, i) => {\n          if (part === GLOBSTAR) globstar = true;\n          return globstar || !entryParts[0][i] || anymatch(part, entryParts[0][i], ANYMATCH_OPTS);\n        });\n      });\n    }\n    return !this.unmatchedGlob && this.fsw._isntIgnored(this.entryPath(entry), entry.stats);\n  }\n}\n\n/**\n * Watches files & directories for changes. Emitted events:\n * `add`, `addDir`, `change`, `unlink`, `unlinkDir`, `all`, `error`\n *\n *     new FSWatcher()\n *       .add(directories)\n *       .on('add', path => log('File', path, 'was added'))\n */\nclass FSWatcher extends EventEmitter {\n// Not indenting methods for history sake; for now.\nconstructor(_opts) {\n  super();\n\n  const opts = {};\n  if (_opts) Object.assign(opts, _opts); // for frozen objects\n\n  /** @type {Map<String, DirEntry>} */\n  this._watched = new Map();\n  /** @type {Map<String, Array>} */\n  this._closers = new Map();\n  /** @type {Set<String>} */\n  this._ignoredPaths = new Set();\n\n  /** @type {Map<ThrottleType, Map>} */\n  this._throttled = new Map();\n\n  /** @type {Map<Path, String|Boolean>} */\n  this._symlinkPaths = new Map();\n\n  this._streams = new Set();\n  this.closed = false;\n\n  // Set up default options.\n  if (undef(opts, 'persistent')) opts.persistent = true;\n  if (undef(opts, 'ignoreInitial')) opts.ignoreInitial = false;\n  if (undef(opts, 'ignorePermissionErrors')) opts.ignorePermissionErrors = false;\n  if (undef(opts, 'interval')) opts.interval = 100;\n  if (undef(opts, 'binaryInterval')) opts.binaryInterval = 300;\n  if (undef(opts, 'disableGlobbing')) opts.disableGlobbing = false;\n  opts.enableBinaryInterval = opts.binaryInterval !== opts.interval;\n\n  // Enable fsevents on OS X when polling isn't explicitly enabled.\n  if (undef(opts, 'useFsEvents')) opts.useFsEvents = !opts.usePolling;\n\n  // If we can't use fsevents, ensure the options reflect it's disabled.\n  const canUseFsEvents = FsEventsHandler.canUse();\n  if (!canUseFsEvents) opts.useFsEvents = false;\n\n  // Use polling on Mac if not using fsevents.\n  // Other platforms use non-polling fs_watch.\n  if (undef(opts, 'usePolling') && !opts.useFsEvents) {\n    opts.usePolling = isMacos;\n  }\n\n  // Always default to polling on IBM i because fs.watch() is not available on IBM i.\n  if(isIBMi) {\n    opts.usePolling = true;\n  }\n\n  // Global override (useful for end-developers that need to force polling for all\n  // instances of chokidar, regardless of usage/dependency depth)\n  const envPoll = process.env.CHOKIDAR_USEPOLLING;\n  if (envPoll !== undefined) {\n    const envLower = envPoll.toLowerCase();\n\n    if (envLower === 'false' || envLower === '0') {\n      opts.usePolling = false;\n    } else if (envLower === 'true' || envLower === '1') {\n      opts.usePolling = true;\n    } else {\n      opts.usePolling = !!envLower;\n    }\n  }\n  const envInterval = process.env.CHOKIDAR_INTERVAL;\n  if (envInterval) {\n    opts.interval = Number.parseInt(envInterval, 10);\n  }\n\n  // Editor atomic write normalization enabled by default with fs.watch\n  if (undef(opts, 'atomic')) opts.atomic = !opts.usePolling && !opts.useFsEvents;\n  if (opts.atomic) this._pendingUnlinks = new Map();\n\n  if (undef(opts, 'followSymlinks')) opts.followSymlinks = true;\n\n  if (undef(opts, 'awaitWriteFinish')) opts.awaitWriteFinish = false;\n  if (opts.awaitWriteFinish === true) opts.awaitWriteFinish = {};\n  const awf = opts.awaitWriteFinish;\n  if (awf) {\n    if (!awf.stabilityThreshold) awf.stabilityThreshold = 2000;\n    if (!awf.pollInterval) awf.pollInterval = 100;\n    this._pendingWrites = new Map();\n  }\n  if (opts.ignored) opts.ignored = arrify(opts.ignored);\n\n  let readyCalls = 0;\n  this._emitReady = () => {\n    readyCalls++;\n    if (readyCalls >= this._readyCount) {\n      this._emitReady = EMPTY_FN;\n      this._readyEmitted = true;\n      // use process.nextTick to allow time for listener to be bound\n      process.nextTick(() => this.emit(EV_READY));\n    }\n  };\n  this._emitRaw = (...args) => this.emit(EV_RAW, ...args);\n  this._readyEmitted = false;\n  this.options = opts;\n\n  // Initialize with proper watcher.\n  if (opts.useFsEvents) {\n    this._fsEventsHandler = new FsEventsHandler(this);\n  } else {\n    this._nodeFsHandler = new NodeFsHandler(this);\n  }\n\n  // Youre frozen when your hearts not open.\n  Object.freeze(opts);\n}\n\n// Public methods\n\n/**\n * Adds paths to be watched on an existing FSWatcher instance\n * @param {Path|Array<Path>} paths_\n * @param {String=} _origAdd private; for handling non-existent paths to be watched\n * @param {Boolean=} _internal private; indicates a non-user add\n * @returns {FSWatcher} for chaining\n */\nadd(paths_, _origAdd, _internal) {\n  const {cwd, disableGlobbing} = this.options;\n  this.closed = false;\n  let paths = unifyPaths(paths_);\n  if (cwd) {\n    paths = paths.map((path) => {\n      const absPath = getAbsolutePath(path, cwd);\n\n      // Check `path` instead of `absPath` because the cwd portion can't be a glob\n      if (disableGlobbing || !isGlob(path)) {\n        return absPath;\n      }\n      return normalizePath(absPath);\n    });\n  }\n\n  // set aside negated glob strings\n  paths = paths.filter((path) => {\n    if (path.startsWith(BANG)) {\n      this._ignoredPaths.add(path.slice(1));\n      return false;\n    }\n\n    // if a path is being added that was previously ignored, stop ignoring it\n    this._ignoredPaths.delete(path);\n    this._ignoredPaths.delete(path + SLASH_GLOBSTAR);\n\n    // reset the cached userIgnored anymatch fn\n    // to make ignoredPaths changes effective\n    this._userIgnored = undefined;\n\n    return true;\n  });\n\n  if (this.options.useFsEvents && this._fsEventsHandler) {\n    if (!this._readyCount) this._readyCount = paths.length;\n    if (this.options.persistent) this._readyCount += paths.length;\n    paths.forEach((path) => this._fsEventsHandler._addToFsEvents(path));\n  } else {\n    if (!this._readyCount) this._readyCount = 0;\n    this._readyCount += paths.length;\n    Promise.all(\n      paths.map(async path => {\n        const res = await this._nodeFsHandler._addToNodeFs(path, !_internal, 0, 0, _origAdd);\n        if (res) this._emitReady();\n        return res;\n      })\n    ).then(results => {\n      if (this.closed) return;\n      results.filter(item => item).forEach(item => {\n        this.add(sysPath.dirname(item), sysPath.basename(_origAdd || item));\n      });\n    });\n  }\n\n  return this;\n}\n\n/**\n * Close watchers or start ignoring events from specified paths.\n * @param {Path|Array<Path>} paths_ - string or array of strings, file/directory paths and/or globs\n * @returns {FSWatcher} for chaining\n*/\nunwatch(paths_) {\n  if (this.closed) return this;\n  const paths = unifyPaths(paths_);\n  const {cwd} = this.options;\n\n  paths.forEach((path) => {\n    // convert to absolute path unless relative path already matches\n    if (!sysPath.isAbsolute(path) && !this._closers.has(path)) {\n      if (cwd) path = sysPath.join(cwd, path);\n      path = sysPath.resolve(path);\n    }\n\n    this._closePath(path);\n\n    this._ignoredPaths.add(path);\n    if (this._watched.has(path)) {\n      this._ignoredPaths.add(path + SLASH_GLOBSTAR);\n    }\n\n    // reset the cached userIgnored anymatch fn\n    // to make ignoredPaths changes effective\n    this._userIgnored = undefined;\n  });\n\n  return this;\n}\n\n/**\n * Close watchers and remove all listeners from watched paths.\n * @returns {Promise<void>}.\n*/\nclose() {\n  if (this.closed) return this._closePromise;\n  this.closed = true;\n\n  // Memory management.\n  this.removeAllListeners();\n  const closers = [];\n  this._closers.forEach(closerList => closerList.forEach(closer => {\n    const promise = closer();\n    if (promise instanceof Promise) closers.push(promise);\n  }));\n  this._streams.forEach(stream => stream.destroy());\n  this._userIgnored = undefined;\n  this._readyCount = 0;\n  this._readyEmitted = false;\n  this._watched.forEach(dirent => dirent.dispose());\n  ['closers', 'watched', 'streams', 'symlinkPaths', 'throttled'].forEach(key => {\n    this[`_${key}`].clear();\n  });\n\n  this._closePromise = closers.length ? Promise.all(closers).then(() => undefined) : Promise.resolve();\n  return this._closePromise;\n}\n\n/**\n * Expose list of watched paths\n * @returns {Object} for chaining\n*/\ngetWatched() {\n  const watchList = {};\n  this._watched.forEach((entry, dir) => {\n    const key = this.options.cwd ? sysPath.relative(this.options.cwd, dir) : dir;\n    watchList[key || ONE_DOT] = entry.getChildren().sort();\n  });\n  return watchList;\n}\n\nemitWithAll(event, args) {\n  this.emit(...args);\n  if (event !== EV_ERROR) this.emit(EV_ALL, ...args);\n}\n\n// Common helpers\n// --------------\n\n/**\n * Normalize and emit events.\n * Calling _emit DOES NOT MEAN emit() would be called!\n * @param {EventName} event Type of event\n * @param {Path} path File or directory path\n * @param {*=} val1 arguments to be passed with event\n * @param {*=} val2\n * @param {*=} val3\n * @returns the error if defined, otherwise the value of the FSWatcher instance's `closed` flag\n */\nasync _emit(event, path, val1, val2, val3) {\n  if (this.closed) return;\n\n  const opts = this.options;\n  if (isWindows) path = sysPath.normalize(path);\n  if (opts.cwd) path = sysPath.relative(opts.cwd, path);\n  /** @type Array<any> */\n  const args = [event, path];\n  if (val3 !== undefined) args.push(val1, val2, val3);\n  else if (val2 !== undefined) args.push(val1, val2);\n  else if (val1 !== undefined) args.push(val1);\n\n  const awf = opts.awaitWriteFinish;\n  let pw;\n  if (awf && (pw = this._pendingWrites.get(path))) {\n    pw.lastChange = new Date();\n    return this;\n  }\n\n  if (opts.atomic) {\n    if (event === EV_UNLINK) {\n      this._pendingUnlinks.set(path, args);\n      setTimeout(() => {\n        this._pendingUnlinks.forEach((entry, path) => {\n          this.emit(...entry);\n          this.emit(EV_ALL, ...entry);\n          this._pendingUnlinks.delete(path);\n        });\n      }, typeof opts.atomic === 'number' ? opts.atomic : 100);\n      return this;\n    }\n    if (event === EV_ADD && this._pendingUnlinks.has(path)) {\n      event = args[0] = EV_CHANGE;\n      this._pendingUnlinks.delete(path);\n    }\n  }\n\n  if (awf && (event === EV_ADD || event === EV_CHANGE) && this._readyEmitted) {\n    const awfEmit = (err, stats) => {\n      if (err) {\n        event = args[0] = EV_ERROR;\n        args[1] = err;\n        this.emitWithAll(event, args);\n      } else if (stats) {\n        // if stats doesn't exist the file must have been deleted\n        if (args.length > 2) {\n          args[2] = stats;\n        } else {\n          args.push(stats);\n        }\n        this.emitWithAll(event, args);\n      }\n    };\n\n    this._awaitWriteFinish(path, awf.stabilityThreshold, event, awfEmit);\n    return this;\n  }\n\n  if (event === EV_CHANGE) {\n    const isThrottled = !this._throttle(EV_CHANGE, path, 50);\n    if (isThrottled) return this;\n  }\n\n  if (opts.alwaysStat && val1 === undefined &&\n    (event === EV_ADD || event === EV_ADD_DIR || event === EV_CHANGE)\n  ) {\n    const fullPath = opts.cwd ? sysPath.join(opts.cwd, path) : path;\n    let stats;\n    try {\n      stats = await stat(fullPath);\n    } catch (err) {}\n    // Suppress event when fs_stat fails, to avoid sending undefined 'stat'\n    if (!stats || this.closed) return;\n    args.push(stats);\n  }\n  this.emitWithAll(event, args);\n\n  return this;\n}\n\n/**\n * Common handler for errors\n * @param {Error} error\n * @returns {Error|Boolean} The error if defined, otherwise the value of the FSWatcher instance's `closed` flag\n */\n_handleError(error) {\n  const code = error && error.code;\n  if (error && code !== 'ENOENT' && code !== 'ENOTDIR' &&\n    (!this.options.ignorePermissionErrors || (code !== 'EPERM' && code !== 'EACCES'))\n  ) {\n    this.emit(EV_ERROR, error);\n  }\n  return error || this.closed;\n}\n\n/**\n * Helper utility for throttling\n * @param {ThrottleType} actionType type being throttled\n * @param {Path} path being acted upon\n * @param {Number} timeout duration of time to suppress duplicate actions\n * @returns {Object|false} tracking object or false if action should be suppressed\n */\n_throttle(actionType, path, timeout) {\n  if (!this._throttled.has(actionType)) {\n    this._throttled.set(actionType, new Map());\n  }\n\n  /** @type {Map<Path, Object>} */\n  const action = this._throttled.get(actionType);\n  /** @type {Object} */\n  const actionPath = action.get(path);\n\n  if (actionPath) {\n    actionPath.count++;\n    return false;\n  }\n\n  let timeoutObject;\n  const clear = () => {\n    const item = action.get(path);\n    const count = item ? item.count : 0;\n    action.delete(path);\n    clearTimeout(timeoutObject);\n    if (item) clearTimeout(item.timeoutObject);\n    return count;\n  };\n  timeoutObject = setTimeout(clear, timeout);\n  const thr = {timeoutObject, clear, count: 0};\n  action.set(path, thr);\n  return thr;\n}\n\n_incrReadyCount() {\n  return this._readyCount++;\n}\n\n/**\n * Awaits write operation to finish.\n * Polls a newly created file for size variations. When files size does not change for 'threshold' milliseconds calls callback.\n * @param {Path} path being acted upon\n * @param {Number} threshold Time in milliseconds a file size must be fixed before acknowledging write OP is finished\n * @param {EventName} event\n * @param {Function} awfEmit Callback to be called when ready for event to be emitted.\n */\n_awaitWriteFinish(path, threshold, event, awfEmit) {\n  let timeoutHandler;\n\n  let fullPath = path;\n  if (this.options.cwd && !sysPath.isAbsolute(path)) {\n    fullPath = sysPath.join(this.options.cwd, path);\n  }\n\n  const now = new Date();\n\n  const awaitWriteFinish = (prevStat) => {\n    fs.stat(fullPath, (err, curStat) => {\n      if (err || !this._pendingWrites.has(path)) {\n        if (err && err.code !== 'ENOENT') awfEmit(err);\n        return;\n      }\n\n      const now = Number(new Date());\n\n      if (prevStat && curStat.size !== prevStat.size) {\n        this._pendingWrites.get(path).lastChange = now;\n      }\n      const pw = this._pendingWrites.get(path);\n      const df = now - pw.lastChange;\n\n      if (df >= threshold) {\n        this._pendingWrites.delete(path);\n        awfEmit(undefined, curStat);\n      } else {\n        timeoutHandler = setTimeout(\n          awaitWriteFinish,\n          this.options.awaitWriteFinish.pollInterval,\n          curStat\n        );\n      }\n    });\n  };\n\n  if (!this._pendingWrites.has(path)) {\n    this._pendingWrites.set(path, {\n      lastChange: now,\n      cancelWait: () => {\n        this._pendingWrites.delete(path);\n        clearTimeout(timeoutHandler);\n        return event;\n      }\n    });\n    timeoutHandler = setTimeout(\n      awaitWriteFinish,\n      this.options.awaitWriteFinish.pollInterval\n    );\n  }\n}\n\n_getGlobIgnored() {\n  return [...this._ignoredPaths.values()];\n}\n\n/**\n * Determines whether user has asked to ignore this path.\n * @param {Path} path filepath or dir\n * @param {fs.Stats=} stats result of fs.stat\n * @returns {Boolean}\n */\n_isIgnored(path, stats) {\n  if (this.options.atomic && DOT_RE.test(path)) return true;\n  if (!this._userIgnored) {\n    const {cwd} = this.options;\n    const ign = this.options.ignored;\n\n    const ignored = ign && ign.map(normalizeIgnored(cwd));\n    const paths = arrify(ignored)\n      .filter((path) => typeof path === STRING_TYPE && !isGlob(path))\n      .map((path) => path + SLASH_GLOBSTAR);\n    const list = this._getGlobIgnored().map(normalizeIgnored(cwd)).concat(ignored, paths);\n    this._userIgnored = anymatch(list, undefined, ANYMATCH_OPTS);\n  }\n\n  return this._userIgnored([path, stats]);\n}\n\n_isntIgnored(path, stat) {\n  return !this._isIgnored(path, stat);\n}\n\n/**\n * Provides a set of common helpers and properties relating to symlink and glob handling.\n * @param {Path} path file, directory, or glob pattern being watched\n * @param {Number=} depth at any depth > 0, this isn't a glob\n * @returns {WatchHelper} object containing helpers for this path\n */\n_getWatchHelpers(path, depth) {\n  const watchPath = depth || this.options.disableGlobbing || !isGlob(path) ? path : globParent(path);\n  const follow = this.options.followSymlinks;\n\n  return new WatchHelper(path, watchPath, follow, this);\n}\n\n// Directory helpers\n// -----------------\n\n/**\n * Provides directory tracking objects\n * @param {String} directory path of the directory\n * @returns {DirEntry} the directory's tracking object\n */\n_getWatchedDir(directory) {\n  if (!this._boundRemove) this._boundRemove = this._remove.bind(this);\n  const dir = sysPath.resolve(directory);\n  if (!this._watched.has(dir)) this._watched.set(dir, new DirEntry(dir, this._boundRemove));\n  return this._watched.get(dir);\n}\n\n// File helpers\n// ------------\n\n/**\n * Check for read permissions.\n * Based on this answer on SO: https://stackoverflow.com/a/11781404/1358405\n * @param {fs.Stats} stats - object, result of fs_stat\n * @returns {Boolean} indicates whether the file can be read\n*/\n_hasReadPermissions(stats) {\n  if (this.options.ignorePermissionErrors) return true;\n\n  // stats.mode may be bigint\n  const md = stats && Number.parseInt(stats.mode, 10);\n  const st = md & 0o777;\n  const it = Number.parseInt(st.toString(8)[0], 10);\n  return Boolean(4 & it);\n}\n\n/**\n * Handles emitting unlink events for\n * files and directories, and via recursion, for\n * files and directories within directories that are unlinked\n * @param {String} directory within which the following item is located\n * @param {String} item      base path of item/directory\n * @returns {void}\n*/\n_remove(directory, item, isDirectory) {\n  // if what is being deleted is a directory, get that directory's paths\n  // for recursive deleting and cleaning of watched object\n  // if it is not a directory, nestedDirectoryChildren will be empty array\n  const path = sysPath.join(directory, item);\n  const fullPath = sysPath.resolve(path);\n  isDirectory = isDirectory != null\n    ? isDirectory\n    : this._watched.has(path) || this._watched.has(fullPath);\n\n  // prevent duplicate handling in case of arriving here nearly simultaneously\n  // via multiple paths (such as _handleFile and _handleDir)\n  if (!this._throttle('remove', path, 100)) return;\n\n  // if the only watched file is removed, watch for its return\n  if (!isDirectory && !this.options.useFsEvents && this._watched.size === 1) {\n    this.add(directory, item, true);\n  }\n\n  // This will create a new entry in the watched object in either case\n  // so we got to do the directory check beforehand\n  const wp = this._getWatchedDir(path);\n  const nestedDirectoryChildren = wp.getChildren();\n\n  // Recursively remove children directories / files.\n  nestedDirectoryChildren.forEach(nested => this._remove(path, nested));\n\n  // Check if item was on the watched list and remove it\n  const parent = this._getWatchedDir(directory);\n  const wasTracked = parent.has(item);\n  parent.remove(item);\n\n  // Fixes issue #1042 -> Relative paths were detected and added as symlinks\n  // (https://github.com/paulmillr/chokidar/blob/e1753ddbc9571bdc33b4a4af172d52cb6e611c10/lib/nodefs-handler.js#L612),\n  // but never removed from the map in case the path was deleted.\n  // This leads to an incorrect state if the path was recreated:\n  // https://github.com/paulmillr/chokidar/blob/e1753ddbc9571bdc33b4a4af172d52cb6e611c10/lib/nodefs-handler.js#L553\n  if (this._symlinkPaths.has(fullPath)) {\n    this._symlinkPaths.delete(fullPath);\n  }\n\n  // If we wait for this file to be fully written, cancel the wait.\n  let relPath = path;\n  if (this.options.cwd) relPath = sysPath.relative(this.options.cwd, path);\n  if (this.options.awaitWriteFinish && this._pendingWrites.has(relPath)) {\n    const event = this._pendingWrites.get(relPath).cancelWait();\n    if (event === EV_ADD) return;\n  }\n\n  // The Entry will either be a directory that just got removed\n  // or a bogus entry to a file, in either case we have to remove it\n  this._watched.delete(path);\n  this._watched.delete(fullPath);\n  const eventName = isDirectory ? EV_UNLINK_DIR : EV_UNLINK;\n  if (wasTracked && !this._isIgnored(path)) this._emit(eventName, path);\n\n  // Avoid conflicts if we later create another file with the same name\n  if (!this.options.useFsEvents) {\n    this._closePath(path);\n  }\n}\n\n/**\n * Closes all watchers for a path\n * @param {Path} path\n */\n_closePath(path) {\n  this._closeFile(path)\n  const dir = sysPath.dirname(path);\n  this._getWatchedDir(dir).remove(sysPath.basename(path));\n}\n\n/**\n * Closes only file-specific watchers\n * @param {Path} path\n */\n_closeFile(path) {\n  const closers = this._closers.get(path);\n  if (!closers) return;\n  closers.forEach(closer => closer());\n  this._closers.delete(path);\n}\n\n/**\n *\n * @param {Path} path\n * @param {Function} closer\n */\n_addPathCloser(path, closer) {\n  if (!closer) return;\n  let list = this._closers.get(path);\n  if (!list) {\n    list = [];\n    this._closers.set(path, list);\n  }\n  list.push(closer);\n}\n\n_readdirp(root, opts) {\n  if (this.closed) return;\n  const options = {type: EV_ALL, alwaysStat: true, lstat: true, ...opts};\n  let stream = readdirp(root, options);\n  this._streams.add(stream);\n  stream.once(STR_CLOSE, () => {\n    stream = undefined;\n  });\n  stream.once(STR_END, () => {\n    if (stream) {\n      this._streams.delete(stream);\n      stream = undefined;\n    }\n  });\n  return stream;\n}\n\n}\n\n// Export FSWatcher class\nexports.FSWatcher = FSWatcher;\n\n/**\n * Instantiates watcher with paths to be tracked.\n * @param {String|Array<String>} paths file/directory paths and/or globs\n * @param {Object=} options chokidar opts\n * @returns an instance of FSWatcher for chaining.\n */\nconst watch = (paths, options) => {\n  const watcher = new FSWatcher(options);\n  watcher.add(paths);\n  return watcher;\n};\n\nexports.watch = watch;\n","import { app, BrowserWindow, ipcMain, dialog, shell, protocol, Menu, nativeImage, Tray, Rectangle, screen } from 'electron'\nimport { dirname, join, basename } from 'path'\nimport { readFile, writeFile, readdir, stat, mkdir } from 'fs/promises'\nimport { existsSync, createReadStream, readFileSync } from 'fs'\nimport ffmpeg from 'fluent-ffmpeg'\nimport { spawn, execSync } from 'child_process'\nimport { cleanupOrphanedCache, getCacheStats, formatBytes } from './cleanup'\nimport chokidar from 'chokidar'\n\n// Get the directory containing the main script\nconst appPath = process.argv[1] || process.cwd()\nconst appDir = dirname(appPath)\n\n// Path to drag icon for file drag operations (64x64 PNG)\n// Try multiple locations for dev vs production\nconst dragIconPaths = [\n  join(appDir, '..', '..', '..', '64x64.png'), // Dev mode\n  join(process.resourcesPath, '64x64.png'),    // Production - resources folder\n  join(process.resourcesPath, 'app.asar', '64x64.png'), // Production - inside asar\n  join(app.getAppPath(), '64x64.png'),         // Alternative production path\n]\n\nconst dragIconPath = dragIconPaths.find(p => existsSync(p)) || dragIconPaths[0]\n\n// Disable hardware acceleration to prevent GPU crashes\napp.disableHardwareAcceleration()\n\n// Handle uncaught errors to prevent crashes\nprocess.on('uncaughtException', (error) => {\n  console.error('Uncaught Exception:', error)\n})\n\nprocess.on('unhandledRejection', (reason, promise) => {\n  console.error('Unhandled Rejection at:', promise, 'reason:', reason)\n})\n\n// Disable hardware acceleration BEFORE app is ready (must be called before app is ready)\napp.disableHardwareAcceleration()\n\n// Keep references to prevent garbage collection\nlet mainWindow: BrowserWindow | null = null\nlet tray: Tray | null = null\nlet isQuitting = false\nlet backendProcess: ReturnType<typeof spawn> | null = null\n\n// Backend paths\nconst getBackendPaths = () => {\n  const inProduction = !isDev\n  return {\n    backendPath: inProduction\n      ? join(process.resourcesPath, 'bin', 'ClipVault.exe')\n      : join(appDir, '..', '..', '..', 'bin', 'ClipVault.exe'),\n    backendLogPath: inProduction\n      ? join(process.resourcesPath, 'bin', 'clipvault.log')\n      : join(appDir, '..', '..', '..', 'bin', 'clipvault.log'),\n  }\n}\n\n// Start backend process\nfunction startBackend(): boolean {\n  const { backendPath } = getBackendPaths()\n  \n  if (!existsSync(backendPath)) {\n    console.warn('Backend executable not found:', backendPath)\n    return false\n  }\n\n  try {\n    console.log('Spawning backend from:', backendPath)\n    const backendProc = spawn(backendPath, [], {\n      detached: true,\n      stdio: ['ignore', 'ignore', 'ignore'],\n    })\n\n    backendProc.on('error', (error) => {\n      console.error('Backend spawn error:', error)\n    })\n\n    backendProc.on('exit', (code, signal) => {\n      console.log(`Backend exited with code ${code} and signal ${signal}`)\n      if (backendProcess === backendProc) {\n        backendProcess = null\n      }\n    })\n\n    console.log('Backend spawned with PID:', backendProc.pid)\n    backendProcess = backendProc\n\n    // Properly detach the process so it continues running after parent exits\n    backendProc.unref()\n    return true\n  } catch (error) {\n    console.error('Failed to start backend:', error)\n    return false\n  }\n}\n\n// Kill backend process\nfunction killBackend(): boolean {\n  if (!backendProcess) {\n    // Try to find and kill any existing ClipVault.exe processes (backend only)\n    try {\n      execSync('taskkill /F /IM ClipVault.exe /FI \"WINDOWTITLE eq ClipVault\"', { \n        stdio: 'ignore' \n      })\n      console.log('Killed existing backend processes')\n      return true\n    } catch {\n      // No processes found or already killed\n      return false\n    }\n  }\n\n  try {\n    console.log('Killing backend process with PID:', backendProcess.pid)\n    backendProcess.kill()\n    backendProcess = null\n    return true\n  } catch (error) {\n    console.error('Failed to kill backend:', error)\n    return false\n  }\n}\n\n// Restart backend process\nasync function restartBackend(): Promise<boolean> {\n  console.log('Restarting backend...')\n  killBackend()\n  \n  // Wait a moment for the process to fully terminate\n  await new Promise(resolve => setTimeout(resolve, 1000))\n  \n  return startBackend()\n}\n\n// App configuration\nconst isDev = process.env.NODE_ENV === 'development'\nconst thumbnailsPath = join(app.getPath('userData'), 'thumbnails')\n\n// Default clips path (fallback if not in settings)\nconst DEFAULT_CLIPS_PATH = 'D:\\\\Clips\\\\ClipVault'\n\n// Get clips path from settings file\nfunction getClipsPath(): string {\n  try {\n    const settingsPath = getSettingsPath()\n    if (existsSync(settingsPath)) {\n      const content = readFileSync(settingsPath, 'utf-8')\n      const settings = JSON.parse(content)\n      if (settings.output_path && typeof settings.output_path === 'string') {\n        return settings.output_path\n      }\n    }\n  } catch (error) {\n    console.error('Failed to read clips path from settings:', error)\n  }\n  return DEFAULT_CLIPS_PATH\n}\n\n\n\n// Configure FFmpeg path for bundled version\nconst ffmpegPath = join(process.resourcesPath, 'ffmpeg', 'ffmpeg.exe')\nconst ffprobePath = join(process.resourcesPath, 'ffmpeg', 'ffprobe.exe')\nif (existsSync(ffmpegPath)) {\n  process.env.PATH = `${dirname(ffmpegPath)}:${process.env.PATH}`\n  console.log('Using bundled FFmpeg:', ffmpegPath)\n}\nif (existsSync(ffprobePath)) {\n  console.log('Using bundled FFprobe:', ffprobePath)\n}\n\nconsole.log('Config:', { clipsPath: getClipsPath(), thumbnailsPath, userData: app.getPath('userData') })\n\n// Single instance lock - prevent multiple app instances\nconst gotTheLock = app.requestSingleInstanceLock()\n\nif (!gotTheLock) {\n  console.log('Another instance is already running. Quitting.')\n  app.quit()\n} else {\n  // When a second instance tries to run, focus the existing window AND ensure backend is running\n  app.on('second-instance', () => {\n    console.log('Second instance detected, focusing existing window and checking backend')\n    if (mainWindow) {\n      if (mainWindow.isMinimized()) {\n        mainWindow.restore()\n      }\n      mainWindow.show()\n      mainWindow.focus()\n    }\n    \n    // Try to start backend again (in case it was stopped)\n    const inProduction = !isDev\n    const backendPath = inProduction\n      ? join(process.resourcesPath, 'bin', 'ClipVault.exe')\n      : join(appDir, '..', '..', '..', 'bin', 'ClipVault.exe')\n    \n    if (existsSync(backendPath)) {\n      try {\n        console.log('Second instance: Spawning backend from:', backendPath)\n        const backendProc = spawn(backendPath, [], {\n          detached: true,\n          stdio: ['ignore', 'ignore', 'ignore'],\n        })\n        backendProc.unref()\n        console.log('Second instance: Backend spawn attempted with PID:', backendProc.pid)\n      } catch (error) {\n        console.error('Second instance: Failed to start backend:', error)\n      }\n    }\n  })\n}\n\n// Register custom protocol before app is ready\nprotocol.registerSchemesAsPrivileged([\n  {\n    scheme: 'clipvault',\n    privileges: {\n      secure: true,\n      supportFetchAPI: true,\n      bypassCSP: true,\n      corsEnabled: true,\n    },\n  },\n])\n\n// Backend configuration loader\n// Create system tray icon\nfunction createTray(): void {\n  console.log('Creating tray icon...')\n\n  // Try to load an icon\n  let icon: Electron.NativeImage | undefined\n  if (existsSync(dragIconPath)) {\n    icon = nativeImage.createFromPath(dragIconPath)\n    if (icon.isEmpty()) {\n      icon = undefined\n    }\n  }\n\n  // Use default icon if custom one not found\n  if (!icon) {\n    icon = nativeImage.createFromPath(join(appDir, '..', 'renderer', 'favicon.ico'))\n    if (icon?.isEmpty()) {\n      icon = undefined\n    }\n  }\n\n  tray = new Tray(icon || nativeImage.createEmpty())\n  tray.setToolTip('ClipVault Editor')\n  tray.setContextMenu(Menu.buildFromTemplate([\n    {\n      label: 'Open ClipVault',\n      click: () => {\n        if (mainWindow) {\n          mainWindow.show()\n          mainWindow.focus()\n        }\n      }\n    },\n    {\n      label: 'Open Clips Folder',\n      click: async () => {\n        const clipsFolder = getClipsPath()\n        if (!existsSync(clipsFolder)) {\n          await mkdir(clipsFolder, { recursive: true })\n        }\n        await shell.openPath(clipsFolder)\n      }\n    },\n    { type: 'separator' },\n    {\n      label: 'Exit',\n      click: () => {\n        app.quit()\n      }\n    }\n  ]))\n\n  tray.on('click', () => {\n    if (mainWindow) {\n      if (mainWindow.isVisible()) {\n        mainWindow.hide()\n      } else {\n        mainWindow.show()\n        mainWindow.focus()\n      }\n    }\n  })\n\n  tray.on('double-click', () => {\n    if (mainWindow) {\n      mainWindow.show()\n      mainWindow.focus()\n    }\n  })\n\n  console.log('Tray icon created')\n}\n\nasync function createWindow() {\n  console.log('Creating main window...')\n  mainWindow = new BrowserWindow({\n    width: 1400,\n    height: 900,\n    minWidth: 1000,\n    minHeight: 600,\n    title: 'ClipVault Editor',\n    backgroundColor: '#0f0f0f',\n    show: true, // Show immediately with background color\n    webPreferences: {\n      preload: isDev\n        ? join(appDir, '..', 'preload', 'index.js')\n        : join(process.resourcesPath, 'app.asar', 'dist', 'preload', 'index.js'),\n      contextIsolation: true,\n      nodeIntegration: false,\n      sandbox: false,\n      webSecurity: false,\n    },\n    titleBarStyle: 'hiddenInset', // Modern look on macOS\n    ...(process.platform === 'win32'\n      ? {\n          titleBarOverlay: {\n            color: '#0f0f0f',\n            symbolColor: '#ffffff',\n          },\n        }\n      : {}),\n  })\n  console.log('Main window created, loading content...')\n\n  // Load the app\n  try {\n    if (isDev) {\n      await mainWindow.loadURL('http://localhost:5173')\n      console.log('Loaded dev URL, opening devtools...')\n      mainWindow.webContents.openDevTools()\n    } else {\n      await mainWindow.loadFile(isDev\n        ? join(appDir, '..', 'renderer', 'index.html')\n        : join(process.resourcesPath, 'app.asar', 'dist', 'renderer', 'index.html'))\n      console.log('Loaded production HTML file')\n    }\n  } catch (error) {\n    console.error('Error loading window content:', error)\n  }\n\n  // Remove default menu bar\n  Menu.setApplicationMenu(null)\n\n  // Handle renderer crashes gracefully\n  mainWindow.webContents.on('crashed', (event, killed) => {\n    console.error('Window crashed!', { killed })\n    if (!killed) {\n      mainWindow?.reload()\n    }\n  })\n\n  // Handle GPU process crashes\n  app.on('gpu-process-crashed', (event, killed) => {\n    console.error('GPU process crashed!', { killed })\n  })\n\n  mainWindow.once('ready-to-show', () => {\n    console.log('Window ready to show, showing now...')\n    mainWindow?.show()\n    mainWindow?.focus()\n  })\n  \n  // Fallback: Show window after 2 seconds even if ready-to-show doesn't fire\n  setTimeout(() => {\n    if (mainWindow && !mainWindow.isVisible()) {\n      console.log('Fallback: forcing window to show after timeout')\n      mainWindow.show()\n      mainWindow.focus()\n    }\n  }, 2000)\n\n  // Minimize to tray instead of closing\n  mainWindow.on('close', (event) => {\n    if (!isQuitting) {\n      event.preventDefault()\n      console.log('Minimizing to tray instead of closing')\n      mainWindow?.hide()\n    }\n  })\n\n  mainWindow.on('page-title-updated', (event) => {\n    event.preventDefault()\n  })\n\n  mainWindow.on('closed', () => {\n    mainWindow = null\n  })\n\n  // F12 to toggle devtools\n  mainWindow.webContents.on('before-input-event', (event, input) => {\n    if (input.key === 'F12') {\n      mainWindow?.webContents.toggleDevTools()\n      event.preventDefault()\n    }\n  })\n}\n\n// IPC Handlers\n\n// Settings file path - use standard AppData location (same as C++ backend)\nconst getSettingsPath = () => {\n  // Use process.env.APPDATA to match C++ backend's CSIDL_APPDATA\n  // This ensures both backend and UI use exact same path\n  const appDataPath = process.env.APPDATA || app.getPath('appData')\n  return join(appDataPath, 'ClipVault', 'settings.json')\n}\n\n// Default settings object\nconst defaultSettings = {\n  output_path: 'D:\\\\Clips\\\\ClipVault',\n  buffer_seconds: 120,\n  video: {\n    width: 1920,\n    height: 1080,\n    fps: 60,\n    encoder: 'auto',\n    quality: 20,\n  },\n  audio: {\n    sample_rate: 48000,\n    bitrate: 160,\n    system_audio_enabled: true,\n    microphone_enabled: true,\n  },\n  hotkey: {\n    save_clip: 'F9',\n  },\n}\n\n// Get settings\nipcMain.handle('settings:get', async () => {\n  try {\n    const settingsPath = getSettingsPath()\n    console.log('Settings path:', settingsPath)\n    \n    if (!existsSync(settingsPath)) {\n      console.log('Settings file not found, returning defaults')\n      return defaultSettings\n    }\n    \n    console.log('Reading settings from:', settingsPath)\n    const content = await readFile(settingsPath, 'utf-8')\n    \n    try {\n      return JSON.parse(content)\n    } catch (parseError) {\n      console.error('JSON parse error, returning defaults:', parseError)\n      return defaultSettings\n    }\n  } catch (error) {\n    console.error('Failed to read settings:', error)\n    return defaultSettings\n  }\n})\n\n// Save settings and restart backend\nipcMain.handle('settings:save', async (_, settings: unknown) => {\n  try {\n    const settingsPath = getSettingsPath()\n    const configDir = join(app.getPath('appData'), 'ClipVault')\n    \n    // Ensure config directory exists\n    if (!existsSync(configDir)) {\n      await mkdir(configDir, { recursive: true })\n    }\n    \n    await writeFile(settingsPath, JSON.stringify(settings, null, 2), 'utf-8')\n    console.log('Settings saved to:', settingsPath)\n    \n    // Restart backend to apply new settings\n    console.log('Settings saved, restarting backend...')\n    const restarted = await restartBackend()\n    \n    return { success: true, restarted }\n  } catch (error) {\n    console.error('Failed to save settings:', error)\n    throw error\n  }\n})\n\n// Restart backend manually\nipcMain.handle('backend:restart', async () => {\n  try {\n    const restarted = await restartBackend()\n    return { success: true, restarted }\n  } catch (error) {\n    console.error('Failed to restart backend:', error)\n    throw error\n  }\n})\n\n// Get monitor information\nipcMain.handle('system:getMonitors', async () => {\n  try {\n    const displays = screen.getAllDisplays()\n    return displays.map((display, index) => ({\n      id: index,\n      name: `Monitor ${index + 1}`,\n      width: display.bounds.width,\n      height: display.bounds.height,\n      x: display.bounds.x,\n      y: display.bounds.y,\n      primary: display.bounds.x === 0 && display.bounds.y === 0,\n    }))\n  } catch (error) {\n    console.error('Failed to get monitors:', error)\n    throw error\n  }\n})\n\n// Get list of clips\nipcMain.handle('clips:getList', async () => {\n  try {\n    if (!existsSync(getClipsPath())) {\n      await mkdir(getClipsPath(), { recursive: true })\n      return []\n    }\n\n    const files = await readdir(getClipsPath())\n    const clips = await Promise.all(\n      files\n        .filter(file => file.endsWith('.mp4'))\n        .map(async filename => {\n          const filePath = join(getClipsPath(), filename)\n          const stats = await stat(filePath)\n          const metadataPath = filePath.replace('.mp4', '.clipvault.json')\n\n          let metadata = null\n          try {\n            if (existsSync(metadataPath)) {\n              const content = await readFile(metadataPath, 'utf-8')\n              metadata = JSON.parse(content)\n            }\n          } catch (e) {\n            console.error('Failed to read metadata:', e)\n          }\n\n          return {\n            id: filename.replace('.mp4', ''),\n            filename,\n            path: filePath,\n            size: stats.size,\n            createdAt: stats.birthtime.toISOString(),\n            modifiedAt: stats.mtime.toISOString(),\n            metadata,\n          }\n        })\n    )\n\n    return clips.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n  } catch (error) {\n    console.error('Failed to get clips list:', error)\n    throw error\n  }\n})\n\n// Save clip metadata\nipcMain.handle('clips:saveMetadata', async (_, clipId: string, metadata: unknown) => {\n  try {\n    const metadataPath = join(getClipsPath(), `${clipId}.clipvault.json`)\n    await writeFile(metadataPath, JSON.stringify(metadata, null, 2), 'utf-8')\n    return true\n  } catch (error) {\n    console.error('Failed to save metadata:', error)\n    throw error\n  }\n})\n\n// Get clip metadata\nipcMain.handle('clips:getMetadata', async (_, clipId: string) => {\n  try {\n    const metadataPath = join(getClipsPath(), `${clipId}.clipvault.json`)\n    if (!existsSync(metadataPath)) {\n      return null\n    }\n    const content = await readFile(metadataPath, 'utf-8')\n    return JSON.parse(content)\n  } catch (error) {\n    console.error('Failed to get metadata:', error)\n    return null\n  }\n})\n\n// Save editor state (trim markers, playhead, audio settings)\nipcMain.handle('editor:saveState', async (_, clipId: string, state: unknown) => {\n  try {\n    const metadataDir = join(getClipsPath(), 'clips-metadata')\n    \n    // Ensure metadata directory exists\n    if (!existsSync(metadataDir)) {\n      await mkdir(metadataDir, { recursive: true })\n    }\n    \n    const statePath = join(metadataDir, `${clipId}.editor.json`)\n    await writeFile(statePath, JSON.stringify(state, null, 2), 'utf-8')\n    console.log(`[Editor] Saved state for clip ${clipId}`)\n    return true\n  } catch (error) {\n    console.error('Failed to save editor state:', error)\n    throw error\n  }\n})\n\n// Load editor state\nipcMain.handle('editor:loadState', async (_, clipId: string) => {\n  try {\n    const metadataDir = join(getClipsPath(), 'clips-metadata')\n    const statePath = join(metadataDir, `${clipId}.editor.json`)\n    \n    if (!existsSync(statePath)) {\n      return null\n    }\n    \n    const content = await readFile(statePath, 'utf-8')\n    console.log(`[Editor] Loaded state for clip ${clipId}`)\n    return JSON.parse(content)\n  } catch (error) {\n    console.error('Failed to load editor state:', error)\n    return null\n  }\n})\n\n// Open clips folder in file explorer\nipcMain.handle('system:openFolder', async () => {\n  await shell.openPath(getClipsPath())\n})\n\n// Show save dialog\nipcMain.handle('dialog:save', async (_, options) => {\n  if (!mainWindow) return null\n  const result = await dialog.showSaveDialog(mainWindow, options)\n  return result\n})\n\n// Generate thumbnail for a clip\nipcMain.handle('clips:generateThumbnail', async (_, clipId: string, videoPath: string) => {\n  try {\n    // Ensure thumbnails directory exists\n    if (!existsSync(thumbnailsPath)) {\n      await mkdir(thumbnailsPath, { recursive: true })\n    }\n\n    const thumbnailFilename = `${clipId}.jpg`\n    const thumbnailPath = join(thumbnailsPath, thumbnailFilename)\n\n    // Check if thumbnail already exists\n    if (existsSync(thumbnailPath)) {\n      return `clipvault://thumb/${encodeURIComponent(thumbnailFilename)}`\n    }\n\n    // Generate thumbnail using FFmpeg\n    return new Promise((resolve, reject) => {\n      ffmpeg(videoPath)\n        .screenshots({\n          timestamps: ['10%'], // Take screenshot at 10% into the video\n          filename: thumbnailFilename,\n          folder: thumbnailsPath,\n          size: '480x270', // 16:9 aspect ratio thumbnail\n        })\n        .on('end', () => {\n          resolve(`clipvault://thumb/${encodeURIComponent(thumbnailFilename)}`)\n        })\n        .on('error', err => {\n          console.error('FFmpeg error:', err)\n          reject(err)\n        })\n    })\n  } catch (error) {\n    console.error('Failed to generate thumbnail:', error)\n    throw error\n  }\n})\n\n// Get video file URL for loading in video element\nipcMain.handle('video:getFileUrl', async (_, filename: string) => {\n  try {\n    const filePath = join(getClipsPath(), filename)\n    \n    if (!existsSync(filePath)) {\n      console.error('Video file not found:', filePath)\n      return { success: false, error: 'File not found' }\n    }\n    \n    // Return the file:// URL which the renderer can use directly\n    // Note: webSecurity is disabled in the window, so file:// URLs work\n    const fileUrl = `file:///${filePath.replace(/\\\\/g, '/')}`\n    console.log('Returning video file URL:', fileUrl)\n    \n    return { success: true, url: fileUrl, path: filePath }\n  } catch (error) {\n    console.error('Error getting video file URL:', error)\n    return { success: false, error: String(error) }\n  }\n})\n\n// Get video metadata (duration, resolution, etc.)\nipcMain.handle('clips:getVideoMetadata', async (_, videoPath: string) => {\n  try {\n    return new Promise((resolve, reject) => {\n      ffmpeg.ffprobe(videoPath, (err, metadata) => {\n        if (err) {\n          reject(err)\n          return\n        }\n\n        const videoStream = metadata.streams.find(s => s.codec_type === 'video')\n        const audioStreams = metadata.streams.filter(s => s.codec_type === 'audio')\n\n        resolve({\n          duration: metadata.format.duration || 0,\n          width: videoStream?.width || 0,\n          height: videoStream?.height || 0,\n          fps: videoStream ? eval(videoStream.r_frame_rate || '0') : 0,\n          bitrate: metadata.format.bit_rate || 0,\n          size: metadata.format.size || 0,\n          format: metadata.format.format_name || '',\n          videoCodec: videoStream?.codec_name || '',\n          audioTracks: audioStreams.length,\n        })\n      })\n    })\n  } catch (error) {\n    console.error('Failed to get video metadata:', error)\n    throw error\n  }\n})\n\n // Keep reference to export preview window\nlet exportPreviewWindow: BrowserWindow | null = null\n\n// Create export preview window\nfunction createExportPreviewWindow(filePath: string) {\n  // Close existing preview window if open\n  if (exportPreviewWindow && !exportPreviewWindow.isDestroyed()) {\n    exportPreviewWindow.close()\n  }\n\n  exportPreviewWindow = new BrowserWindow({\n    width: 600,\n    height: 500,\n    alwaysOnTop: true,\n    modal: false,\n    resizable: false,\n    title: 'Export Complete',\n    backgroundColor: '#1a1a1a',\n    webPreferences: {\n      contextIsolation: false,\n      nodeIntegration: true,\n      webSecurity: false,\n    },\n  })\n\n  // Remove menu bar from popup\n  exportPreviewWindow.setMenu(null)\n\n  // Handle preview window crashes\n  exportPreviewWindow.webContents.on('crashed', () => {\n    console.error('Preview window crashed')\n    exportPreviewWindow?.close()\n    exportPreviewWindow = null\n  })\n\n  // Convert file path to clipvault protocol URL\n  const filename = filePath.split('\\\\').pop() || ''\n  // Use 'exported' protocol for files in exported-clips directory\n  const isExported = filePath.includes('exported-clips')\n  const videoUrl = `clipvault://${isExported ? 'exported' : 'clip'}/${encodeURIComponent(filename)}`\n\n  const htmlContent = `<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <style>\n    * { box-sizing: border-box; }\n    body { margin: 0; padding: 20px; background: #1a1a1a; color: white; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; overflow: hidden; }\n    video { width: 100%; border-radius: 8px; max-height: 320px; object-fit: contain; background: #000; }\n    .drag-hint { text-align: center; padding: 15px; background: #2a2a2a; border-radius: 8px; margin-top: 10px; cursor: grab; user-select: none; }\n    .drag-hint:active { cursor: grabbing; }\n    .drag-hint h3 { margin: 0 0 8px 0; font-size: 16px; color: #4ade80; }\n    .drag-hint p { margin: 0; font-size: 13px; color: #aaa; }\n    .timer { position: absolute; top: 10px; right: 10px; font-size: 12px; color: #666; }\n    .file-icon { font-size: 24px; margin-bottom: 8px; }\n    .actions { display: flex; gap: 10px; margin-top: 10px; }\n    .btn { flex: 1; padding: 10px; background: #3a3a3a; border: none; border-radius: 6px; color: white; cursor: pointer; font-size: 13px; }\n    .btn:hover { background: #4a4a4a; }\n    .btn-primary { background: #4ade80; color: #0f0f0f; }\n    .btn-primary:hover { background: #22c55e; }\n  </style>\n</head>\n<body>\n  <div class=\"timer\" id=\"timer\">Closing in 30s</div>\n  <video src=\"${videoUrl}\" controls autoplay></video>\n  <div class=\"drag-hint\" id=\"dragHint\" draggable=\"true\">\n    <div class=\"file-icon\"></div>\n    <h3>Export Complete!</h3>\n    <p>Drag from here to share the file anywhere</p>\n  </div>\n  <div class=\"actions\">\n    <button class=\"btn\" onclick=\"copyPath()\">Copy Path</button>\n    <button class=\"btn btn-primary\" onclick=\"openFolder()\">Open Folder</button>\n  </div>\n  <script>\n    const { ipcRenderer } = require('electron');\n    const filePath = '${filePath.replace(/\\\\/g, '\\\\\\\\')}';\n    let timeLeft = 30;\n    const timerEl = document.getElementById('timer');\n    const interval = setInterval(() => {\n      timeLeft--;\n      timerEl.textContent = 'Closing in ' + timeLeft + 's';\n      if (timeLeft <= 0) {\n        clearInterval(interval);\n        window.close();\n      }\n    }, 1000);\n    \n    // Handle drag start - send IPC to main process for native drag\n    const dragHint = document.getElementById('dragHint');\n    dragHint.addEventListener('dragstart', (e) => {\n      e.preventDefault();\n      // Send IPC to main process to initiate native drag\n      ipcRenderer.send('export:startDrag', filePath);\n    });\n    \n    function copyPath() {\n      navigator.clipboard.writeText(filePath);\n      const btn = event.target;\n      const originalText = btn.textContent;\n      btn.textContent = 'Copied!';\n      setTimeout(() => btn.textContent = originalText, 1500);\n    }\n    \n    function openFolder() {\n      ipcRenderer.send('export:openFolder', filePath);\n    }\n  </script>\n</body>\n</html>`\n\n  exportPreviewWindow.loadURL('data:text/html;charset=utf-8,' + encodeURIComponent(htmlContent))\n\n  // Auto-close after 30 seconds\n  const autoCloseTimeout = setTimeout(() => {\n    if (exportPreviewWindow && !exportPreviewWindow.isDestroyed()) {\n      exportPreviewWindow.close()\n    }\n  }, 30000)\n\n  exportPreviewWindow.on('closed', () => {\n    clearTimeout(autoCloseTimeout)\n    exportPreviewWindow = null\n  })\n\n  // Handle drag start - use native startDrag API for external file drops\n  exportPreviewWindow.webContents.on('ipc-message', (event, channel, data) => {\n    if (channel === 'export:startDrag') {\n      console.log('Starting native drag for:', data)\n      try {\n        // Create nativeImage from the icon file\n        let dragIcon: Electron.NativeImage | undefined\n        if (existsSync(dragIconPath)) {\n          dragIcon = nativeImage.createFromPath(dragIconPath)\n          console.log('Drag icon loaded from:', dragIconPath)\n        } else {\n          console.warn('Drag icon not found at:', dragIconPath)\n        }\n        \n        // Use webContents.startDrag for native file drag (required for external apps like Discord)\n        exportPreviewWindow?.webContents.startDrag({\n          file: data as string,\n          icon: dragIcon || nativeImage.createEmpty()\n        })\n      } catch (error) {\n        console.error('Error starting drag:', error)\n      }\n    } else if (channel === 'export:openFolder') {\n      // Open the folder containing the exported file\n      const folderPath = dirname(data as string)\n      shell.openPath(folderPath)\n    }\n  })\n}\n\n// IPC handler to show export preview\nipcMain.handle('export:showPreview', async (_, filePath: string) => {\n  createExportPreviewWindow(filePath)\n  return { success: true }\n})\n\n  // Extract audio tracks from video file\n   ipcMain.handle('audio:extractTracks', async (_, clipId: string, videoPath: string) => {\n     try {\n       // Ensure audio cache directory exists\n       const audioCachePath = join(thumbnailsPath, 'audio')\n       if (!existsSync(audioCachePath)) {\n         await mkdir(audioCachePath, { recursive: true })\n       }\n\n       const track1Path = join(audioCachePath, `${clipId}_track1.m4a`)\n       const track2Path = join(audioCachePath, `${clipId}_track2.m4a`)\n\n       const results: { track1?: string; track2?: string; error?: string } = {}\n\n       // Check if already cached\n       const track1Exists = existsSync(track1Path)\n       const track2Exists = existsSync(track2Path)\n\n       if (track1Exists) {\n         results.track1 = `clipvault://audio/${encodeURIComponent(`${clipId}_track1.m4a`)}`\n       }\n       if (track2Exists) {\n         results.track2 = `clipvault://audio/${encodeURIComponent(`${clipId}_track2.m4a`)}`\n       }\n\n       if (track1Exists && track2Exists) {\n         return results\n       }\n\n       // Get video metadata to check audio tracks\n       const metadata = await new Promise<ffmpeg.FfprobeData>((resolve, reject) => {\n         ffmpeg.ffprobe(videoPath, (err, data) => {\n           if (err) reject(err)\n           else resolve(data)\n         })\n       })\n\n       const audioStreams = metadata.streams.filter(s => s.codec_type === 'audio')\n\n       // Extract track 1 if not cached and exists\n       if (!track1Exists && audioStreams.length >= 1) {\n         await new Promise<void>((resolve, reject) => {\n           ffmpeg(videoPath)\n             .outputOptions(['-map 0:a:0', '-c:a aac', '-b:a 128k'])\n             .save(track1Path)\n             .on('end', () => resolve())\n             .on('error', err => reject(err))\n         })\n         results.track1 = `clipvault://audio/${encodeURIComponent(`${clipId}_track1.m4a`)}`\n       }\n\n       // Extract track 2 if not cached and exists\n       if (!track2Exists && audioStreams.length >= 2) {\n         await new Promise<void>((resolve, reject) => {\n           ffmpeg(videoPath)\n             .outputOptions(['-map 0:a:1', '-c:a aac', '-b:a 128k'])\n             .save(track2Path)\n             .on('end', () => resolve())\n             .on('error', err => reject(err))\n         })\n         results.track2 = `clipvault://audio/${encodeURIComponent(`${clipId}_track2.m4a`)}`\n       }\n\n       return results\n     } catch (error) {\n       console.error('Failed to extract audio tracks:', error)\n       return { error: String(error) }\n     }\n   })\n\n   // Export clip with trim and audio track selection\n   ipcMain.handle(\n      'editor:exportClip',\n      async (\n        _,\n        params: {\n          clipPath: string\n          exportFilename: string\n          trimStart: number\n          trimEnd: number\n          audioTrack1: boolean\n          audioTrack2: boolean\n          audioTrack1Volume?: number\n          audioTrack2Volume?: number\n          targetSizeMB?: number | 'original'\n        }\n      ) => {\n        try {\n          const { clipPath, exportFilename, trimStart, trimEnd, audioTrack1, audioTrack2, audioTrack1Volume, audioTrack2Volume, targetSizeMB = 'original' } = params\n          const duration = trimEnd - trimStart\n          const vol1 = audioTrack1Volume ?? 1.0\n          const vol2 = audioTrack2Volume ?? 1.0\n\n          // Create exported-clips directory if it doesn't exist\n          const exportedClipsPath = join(getClipsPath(), 'exported-clips')\n          if (!existsSync(exportedClipsPath)) {\n            await mkdir(exportedClipsPath, { recursive: true })\n          }\n\n          // Build full output path\n          const outputPath = join(exportedClipsPath, exportFilename)\n\n          // Calculate video bitrate if target size is specified\n          let videoBitrate: number | null = null\n          let useTargetSize = false\n          if (typeof targetSizeMB === 'number' && targetSizeMB > 0 && duration > 0) {\n            // Formula: target_size_mb * 8192 kb / duration_sec - audio_overhead\n            // Leave ~15% overhead for container and audio\n            const targetSizeKB = targetSizeMB * 8192 * 0.85\n            const totalBitrate = Math.floor(targetSizeKB / duration)\n            const audioBitrate = 128 // AAC audio bitrate\n            videoBitrate = Math.max(totalBitrate - audioBitrate, 500) // Minimum 500kbps\n            useTargetSize = true\n            console.log(`Target size: ${targetSizeMB}MB, Duration: ${duration}s, Video bitrate: ${videoBitrate}kbps`)\n          }\n\n          return new Promise((resolve, reject) => {\n            const command = ffmpeg(clipPath)\n              .seekInput(trimStart)\n              .duration(duration)\n\n            // Configure video encoding based on target size\n            if (useTargetSize && videoBitrate) {\n              // Use H.264 with target bitrate for size-constrained export\n              // Note: Don't use -crf with -b:v - they conflict (CRF overrides bitrate)\n              command.videoCodec('libx264')\n              command.outputOptions([\n                '-b:v', `${videoBitrate}k`,\n                '-maxrate', `${Math.floor(videoBitrate * 1.5)}k`,\n                '-bufsize', `${videoBitrate * 2}k`,\n                '-preset', 'fast',\n                '-pix_fmt', 'yuv420p'\n              ])\n            } else {\n              // Original quality - just copy video stream\n              command.videoCodec('copy')\n            }\n\n            // Map audio tracks based on options\n            if (audioTrack1 && audioTrack2) {\n              // Mix both tracks with volume adjustment\n              const filter = `[0:a:0]volume=${vol1}[a0];[0:a:1]volume=${vol2}[a1];[a0][a1]amix=inputs=2:duration=first:dropout_transition=3[aout]`\n              command.outputOptions([\n                '-map 0:v:0',\n                '-filter_complex', filter,\n                '-map', '[aout]',\n                '-c:a aac',\n                '-b:a 128k',\n                '-ac 2'\n              ])\n            } else if (audioTrack1) {\n              // Only track 1 with volume\n              if (vol1 < 1.0) {\n                command.outputOptions([\n                  '-map 0:v:0',\n                  '-map 0:a:0',\n                  '-filter:a:0', `volume=${vol1}`\n                ])\n              } else {\n                command.outputOptions(['-map 0:v:0', '-map 0:a:0'])\n              }\n            } else if (audioTrack2) {\n              // Only track 2 with volume\n              if (vol2 < 1.0) {\n                command.outputOptions([\n                  '-map 0:v:0',\n                  '-map 0:a:1',\n                  '-filter:a:0', `volume=${vol2}`\n                ])\n              } else {\n                command.outputOptions(['-map 0:v:0', '-map 0:a:1'])\n              }\n            } else {\n              // No audio - video only\n              command.noAudio()\n            }\n\n            command\n              .on('progress', progress => {\n                if (mainWindow && progress.percent) {\n                  mainWindow.webContents.send('export:progress', { percent: progress.percent })\n                }\n              })\n              .on('end', () => {\n                resolve({ success: true, filePath: outputPath })\n              })\n              .on('error', err => {\n                console.error('Export error:', err)\n                reject(err)\n              })\n              .save(outputPath)\n          })\n        } catch (error) {\n          console.error('Failed to export clip:', error)\n          throw error\n        }\n      }\n    )\n\n    // Clean up orphaned cache files (thumbnails/audio for clips that no longer exist)\n    ipcMain.handle('cleanup:orphans', async () => {\n      try {\n        console.log('[Main] Cleaning up orphaned cache files...')\n        const result = await cleanupOrphanedCache(getClipsPath(), thumbnailsPath)\n        return result\n      } catch (error) {\n        console.error('Failed to cleanup orphans:', error)\n        return { deletedCount: 0, errors: [String(error)] }\n      }\n    })\n\n    // Get cache storage statistics\n    ipcMain.handle('cleanup:stats', async () => {\n      try {\n        const stats = await getCacheStats(thumbnailsPath)\n        return {\n          ...stats,\n          thumbnailSizeFormatted: formatBytes(stats.thumbnailSize),\n          audioSizeFormatted: formatBytes(stats.audioSize),\n          totalSizeFormatted: formatBytes(stats.totalSize)\n        }\n      } catch (error) {\n        console.error('Failed to get cache stats:', error)\n        return null\n      }\n    })\n\n// App lifecycle\napp.whenReady().then(async () => {\n  console.log('App is ready, creating window...')\n\n  // Register protocol handler FIRST, before creating window\n  // This ensures clipvault:// URLs can be loaded immediately when the window opens\n  protocol.registerFileProtocol('clipvault', (request, callback) => {\n    try {\n      console.log('Protocol handler called:', request.url)\n      const url = new URL(request.url)\n      const host = url.host // \"clip\" or \"thumb\"\n      const pathname = url.pathname // \"/filename.mp4\"\n\n      console.log('Parsed URL:', { host, pathname })\n\n      // The URL format is: clipvault://clip/filename.mp4\n      // where host = type (clip/thumb), pathname = /filename\n      if (!host || !pathname) {\n        console.error('Invalid URL format:', { host, pathname })\n        callback({ error: -2 }) // net::FAILED\n        return\n      }\n\n      const type = host\n      const encodedFilename = pathname.substring(1) // Remove leading /\n      const filename = decodeURIComponent(encodedFilename)\n\n      console.log('Processing file:', { type, filename })\n\n      // Determine the base path based on the type\n      let basePath: string\n      if (type === 'clip') {\n        basePath = getClipsPath()\n      } else if (type === 'thumb') {\n        basePath = thumbnailsPath\n      } else if (type === 'audio') {\n        basePath = join(thumbnailsPath, 'audio')\n      } else if (type === 'exported') {\n        basePath = join(getClipsPath(), 'exported-clips')\n      } else {\n        console.error('Unknown resource type:', type)\n        callback({ error: -2 })\n        return\n      }\n\n      // Build the full file path\n      const filePath = join(basePath, filename)\n      console.log('Full file path:', filePath)\n\n      // Check if file exists\n      if (!existsSync(filePath)) {\n        console.error('File not found:', filePath)\n        callback({ error: -6 }) // net::ERR_FILE_NOT_FOUND\n        return\n      }\n\n      // registerFileProtocol automatically handles byte-range requests for video seeking\n      callback({ path: filePath })\n    } catch (error) {\n      console.error('Protocol handler error:', error)\n      callback({ error: -2 })\n    }\n  })\n\n  // Create tray icon\n  createTray()\n\n  // Create the main window\n  await createWindow().catch(err => {\n    console.error('Failed to create window:', err)\n  })\n\n  // Start the backend\n  console.log('Attempting to start backend...')\n  startBackend()\n\n  // Clean up orphaned cache files on startup\n  setTimeout(async () => {\n    try {\n      console.log('[Main] Running orphaned cache cleanup on startup...')\n      const result = await cleanupOrphanedCache(getClipsPath(), thumbnailsPath)\n      if (result.deletedCount > 0) {\n        console.log(`[Main] Cleaned up ${result.deletedCount} orphaned cache files`)\n      }\n      if (result.errors.length > 0) {\n        console.warn('[Main] Cleanup errors:', result.errors)\n      }\n    } catch (error) {\n      console.error('[Main] Failed to run startup cleanup:', error)\n    }\n  }, 5000) // Wait 5 seconds after startup to let backend initialize\n\n  // Verify backend started after a short delay\n  setTimeout(() => {\n    try {\n      const { backendLogPath } = getBackendPaths()\n      const checkOutput = execSync(\n        'tasklist /NH /FO CSV /FI \"IMAGENAME eq ClipVault.exe\"',\n        { encoding: 'utf-8', stdio: ['pipe', 'pipe', 'ignore'] }\n      )\n      const isRunning = checkOutput.includes('ClipVault.exe')\n      console.log('Backend verification after spawn:', isRunning ? 'running' : 'not running')\n      \n      // Check if log file was created\n      if (existsSync(backendLogPath)) {\n        console.log('Backend log file exists:', backendLogPath)\n      } else {\n        console.warn('Backend log file not found - spawn may have failed silently')\n      }\n    } catch (e) {\n      console.log('Could not verify backend status:', e)\n    }\n  }, 2000)\n\n  // Set up file watching for clips folder to auto-refresh UI\n  const clipsWatcher = chokidar.watch(getClipsPath(), {\n    ignored: /(^|[\\/\\\\])\\../, // ignore dotfiles\n    persistent: true,\n    depth: 0, // Only watch immediate directory, not subdirectories\n    awaitWriteFinish: {\n      stabilityThreshold: 500, // Wait 500ms after file size stops changing\n      pollInterval: 100\n    }\n  })\n\n  clipsWatcher.on('add', (filePath) => {\n    // Only notify for .mp4 files\n    if (filePath.endsWith('.mp4')) {\n      console.log('[Watcher] New clip detected:', filePath)\n      // Notify all windows that a new clip is available\n      BrowserWindow.getAllWindows().forEach(window => {\n        window.webContents.send('clips:new', { filename: basename(filePath) })\n      })\n    }\n  })\n\n  clipsWatcher.on('unlink', (filePath) => {\n    // Notify when a clip is deleted\n    if (filePath.endsWith('.mp4')) {\n      console.log('[Watcher] Clip deleted:', filePath)\n      BrowserWindow.getAllWindows().forEach(window => {\n        window.webContents.send('clips:removed', { filename: basename(filePath) })\n      })\n    }\n  })\n\n  clipsWatcher.on('error', (error) => {\n    console.error('[Watcher] Error watching clips folder:', error)\n  })\n\n  console.log('[Watcher] Started watching clips folder:', getClipsPath())\n\n  app.on('activate', () => {\n    if (BrowserWindow.getAllWindows().length === 0) {\n      createWindow()\n    }\n  })\n})\n\napp.on('window-all-closed', () => {\n  // Don't quit on macOS when all windows are closed\n  if (process.platform !== 'darwin') {\n    // Only quit if there's no tray\n    if (!tray) {\n      app.quit()\n    }\n  }\n})\n\n// Handle app quit\napp.on('before-quit', (event) => {\n  console.log('App is quitting...')\n  isQuitting = true\n  if (tray) {\n    tray.destroy()\n    tray = null\n  }\n})\n\n// Set app as quitting when user chooses Exit from tray\napp.on('will-quit', () => {\n  isQuitting = true\n})\n"],"names":["isexe","sync","fs","require$$0","checkPathExt","path","options","pathext","i","p","checkStat","stat","cb","er","checkMode","mod","uid","gid","myUid","myGid","u","g","o","ug","ret","global","require$$1","require$$2","resolve","reject","is","which","isWindows","cmd","opt","colon","pathEnv","pathExt","pathExtExe","info","found","F","l","pathPart","E","ii","ll","ext","j","cur","line","progress","progressParts","progressSplit","key","value","utils","utilsModule","source","dest","list","argfunc","arg","count","index","cloned","filters","filterSpec","filterString","streamSpec","option","name","callback","err","result","timemark","parts","secs","command","stderrLine","codecsObject","inputPattern","durPattern","audioPattern","videoPattern","inputStack","inputIndex","inInput","format","dur","audio","video","duration","stderr","messages","message","maxLines","cbs","lines","current","closed","max","emit","str","newLines","proto","isFile","isStream","hasInputStream","input","protocol","fps","seek","codec","bitrate","channels","freq","quality","constant","frames","getScalePadFilters","width","height","aspect","color","createSizeFilters","output","data","fixedSize","fixedWidth","fixedHeight","percentRatio","ratio","size","a","match","pad","target","pipeopts","hasOutputStream","self","spec","doSplit","split","map","preset","modulePath","module","require","async","root","previous_async","only_once","fn","called","_each","arr","iterator","_map","results","x","_reduce","memo","_keys","obj","keys","k","completed","iterate","limit","_eachLimit","started","running","replenish","doParallel","args","doParallelLimit","doSeries","_asyncMap","eachfn","v","_mapLimit","reversed","_filter","b","_reject","_detect","main_callback","criteria","left","right","tasks","listeners","addListener","removeListener","taskComplete","task","taskCallback","safeResults","rkey","requires","ready","listener","wrapIterator","next","_parallel","makeCallback","_concat","r","y","test","worker","concurrency","_insert","q","pos","item","workers","payload","working","cargo","process","ts","ds","_console_fn","hasher","queues","memoized","counter","fns","that","newargs","nextargs","_applyEach","go","spawn","require$$3","require$$4","runFfprobe","processCB","endCB","stdoutRing","stdoutClosed","stderrRing","stderrClosed","ffmpegProc","exitError","handleExit","processExited","code","signal","complexFilters","fileOutput","sizeFilters","audioFilters","videoFilters","outputArg","readMetadata","flvmeta","e","encoders","event","outputPresent","outputStream","inputStream","ended","emitEnd","stdout","reportingErr","msg","codecDataSent","codecObject","flvtool","niceness","logger","pid","renice","avCodecRegexp","ffCodecRegexp","ffEncodersRegexp","ffDecodersRegexp","encodersRegexp","formatRegexp","lineBreakRegexp","filterRegexp","cache","ffmpegPath","ffprobePath","exists","ffmpeg","ffprobe","flvtool2","types","codecData","decoders","coderData","formats","unavailable","fmts","cdcs","acodec","vcodec","legacyTag","legacyDisposition","parseFfprobeOutput","out","parseBlock","kv","stream","chapter","handleCallback","src","legacyTagKeys","tagKey","legacyDispositionKeys","dispositionKey","PassThrough","config","folder","interval","percentSize","metadata","getMetadata","meta","t","vstream","biggest","mark","pattern","filenames","padding","idx","f","first","fileInput","hasAudioStreams","hasVideoStreams","util","EventEmitter","prop","fluentFfmpeg","clone","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","file","instance","require$$14","filePath","existsSync","unlink","error","clipsPath","thumbnailsPath","clipFiles","readdir","validClipIds","basename","extname","thumbFiles","thumbFile","clipId","thumbPath","join","audioCachePath","audioFiles","audioFile","audioPath","errorMsg","stats","fileStat","bytes","sizes","STAR","POSIX_REGEX_SOURCE","constants","chars","win32","REGEX_BACKSLASH","REGEX_REMOVE_BACKSLASH","REGEX_SPECIAL_CHARS","REGEX_SPECIAL_CHARS_GLOBAL","exports","val","segs","char","lastIdx","state","prepend","append","CHAR_COMMA","CHAR_DOT","CHAR_LEFT_CURLY_BRACE","CHAR_LEFT_PARENTHESES","CHAR_LEFT_SQUARE_BRACKET","CHAR_RIGHT_CURLY_BRACE","CHAR_RIGHT_PARENTHESES","CHAR_RIGHT_SQUARE_BRACKET","token","scan","opts","length","scanToEnd","slashes","tokens","start","lastIndex","isBrace","isBracket","isGlob","isExtglob","isGlobstar","braceEscaped","backslashes","negated","negatedExtglob","finished","braces","prev","eos","peek","advance","base","prefix","glob","prevIndex","n","MAX_LENGTH","type","parse","len","bos","capture","PLATFORM_CHARS","EXTGLOB_CHARS","DOT_LITERAL","PLUS_LITERAL","SLASH_LITERAL","ONE_CHAR","DOTS_SLASH","NO_DOT","NO_DOT_SLASH","NO_DOTS_SLASH","QMARK","QMARK_NO_DOT","START_ANCHOR","globstar","nodot","qmarkNoDot","star","extglobs","stack","remaining","consume","num","negate","increment","decrement","push","tok","extglobOpen","extglobClose","rest","extglobStar","expression","m","esc","inner","pre","posix","extglob","prevValue","escaped","open","brace","range","toks","prior","before","isStart","afterStar","after","end","NO_DOTS","slashDot","create","parse_1","isObject","picomatch","returnState","isMatch","isState","regex","isIgnored","ignoreOpts","matcher","returnObject","patterns","returnOutput","parsed","sysPath","promisify","lstat","realpath","BANG","filter","entry","positive","negative","trimmed","statMethod","batch","depth","files","slice","dirent","entryType","parent","fullPath","full","entryRealPath","entryRealPathStats","recursiveError","readdirp","normalizePath","stripTrailing","ch","arrify","string","negPatterns","returnIndex","isList","_path","nglob","applied","anymatch","matchers","testString","mtchers","negatedGlobs","ri","anymatchModule","pipeIndex","closeSquareIndex","closeCurlyIndex","closeParenIndex","backSlashIndex","close","check","globParent","node","min","step","block","nodes","acc","flat","ele","stringify","ast","invalidBlock","invalidNode","child","isNumber","toRegexRange","relax","shorthand","wrap","cacheKey","isPadded","positives","negatives","newMin","neg","onlyNegative","onlyPositive","intersected","nines","zeros","stop","stops","zipped","digits","startDigit","stopDigit","ranges","comparison","intersection","integer","diff","toNumber","maxLength","dash","maxLen","isNumbers","descending","startString","endString","stepString","padded","fill","compile","walk","invalid","queue","stash","enclose","expand","rangeLimit","brackets","siblings","binaryExtensions","isBinaryPath","sep","platform","os","EMPTY_FN","EMPTY_STR","EV_CHANGE","EV_ADD","EV_ADD_DIR","EV_ERROR","STR_DATA","STR_END","BRACE_START","statMethods","main","container","cont","set","errHandler","emitRaw","handleEvent","rawEvent","evPath","val1","val2","val3","handlers","rawEmitter","watcher","broadcastErr","fd","copts","curr","currmtime","fsW","directory","absolutePath","closer","initialAdd","dirname","prevStats","newStats","at","mt","dir","linkPath","wh","throttler","previous","wasThrottled","parentDir","tracked","oDepth","dirPath","priorWh","follow","absPath","targetPath","NodeFsHandler","mtch","maj","EV_UNLINK","FUNCTION_TYPE","realPath","watchPath","parentPath","resolvedPath","hasSymlink","filteredListener","flags","watchedParent","watchedPath","lst","fsw","ipaths","watchedDir","isDirectory","curDepth","eventName","transform","globFilter","linkTarget","aliasedPath","newPath","processPath","forceAdd","pp","isDir","dirObj","priorDepth","joinedPath","fseventsHandlerModule","FsEventsHandler","paths_","paths","cwd","removeWatcher","items","entryParts","part","_opts","envPoll","envLower","envInterval","awf","readyCalls","_origAdd","_internal","disableGlobbing","res","closers","closerList","promise","watchList","pw","awfEmit","actionType","timeout","action","actionPath","timeoutObject","clear","thr","threshold","timeoutHandler","now","awaitWriteFinish","prevStat","curStat","ign","ignored","st","nested","wasTracked","relPath","app","reason","inProduction","backendPath","backendProc","execSync","settingsPath","content","readFileSync","settings","icon","nativeImage","Tray","Menu","clipsFolder","mkdir","shell","BrowserWindow","killed","appDataPath","ipcMain","readFile","parseError","_","configDir","writeFile","screen","display","filename","metadataPath","metadataDir","statePath","dialog","videoPath","thumbnailFilename","thumbnailPath","fileUrl","s","htmlContent","autoCloseTimeout","channel","dragIcon","folderPath","track1Path","track2Path","track1Exists","track2Exists","audioStreams","params","clipPath","exportFilename","trimStart","trimEnd","audioTrack1","audioTrack2","audioTrack1Volume","audioTrack2Volume","targetSizeMB","vol1","vol2","exportedClipsPath","outputPath","videoBitrate","useTargetSize","targetSizeKB","totalBitrate","request","url","host","pathname","encodedFilename","basePath","backendLogPath","isRunning","clipsWatcher","window"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]}